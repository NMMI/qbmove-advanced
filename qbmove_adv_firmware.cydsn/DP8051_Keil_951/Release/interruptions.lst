C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 1   


C51 COMPILER V9.51, COMPILATION OF MODULE INTERRUPTIONS
OBJECT MODULE PLACED IN .\DP8051_Keil_951\Release\interruptions.obj
COMPILER INVOKED BY: C:\Program Files (x86)\Cypress\PSoC Creator\3.3\PSoC Creator\import\keil\pk51\9.51\C51\BIN\c51.exe 
                    -.\interruptions.c NOIV LARGE MODDP2 OMF2 VB(1) NOIP INCDIR(.,Generated_Source\PSoC3) FF(3) DB DF(NDEBUG) WL(2) PR(.\DP80
                    -51_Keil_951\Release/interruptions.lst) CD OT(8,SPEED) OJ(.\DP8051_Keil_951\Release\interruptions.obj)

line level    source

*** MESSAGE C286 IN LINE 0 OF (null): license limits optimization to level 5
   1          // ----------------------------------------------------------------------------
   2          // Copyright (C)  qbrobotics. All rights reserved.
   3          // www.qbrobotics.com
   4          // ----------------------------------------------------------------------------
   5          
   6          /**
   7          * \file         interruptions.c
   8          *
   9          * \brief        Interruption functions are in this file.
  10          * \date         May 13, 2015
  11          * \author       qbrobotics
  12          * \copyright    (C)  qbrobotics. All rights reserved.
  13          */
  14          
  15          
  16          //=================================================================     includes
  17          #include <interruptions.h>
  18          #include <command_processing.h>
  19          
  20          #include "globals.h"
  21          #include "utils.h"
  22          
  23          //==============================================================================
  24          //                                                            WATCHDOG INTERRUPT
  25          //==============================================================================
  26          
  27          CY_ISR(ISR_WATCHDOG_Handler){
  28   1      
  29   1          // Set WDT flag
  30   1          
  31   1          watchdog_flag = TRUE;
  32   1      
  33   1      }
  34          
  35          //==============================================================================
  36          //                                                            RS485 RX INTERRUPT
  37          //==============================================================================
  38          
  39          CY_ISR(ISR_RS485_RX_ExInterrupt) {
  40   1      
  41   1          // Set RS485 flag
  42   1          
  43   1          interrupt_flag = TRUE;
  44   1           
  45   1      }
  46          
  47          //==============================================================================
  48          //                                                             INTERRUPT MANAGER
  49          //==============================================================================
  50          // Manage interrupt from RS485 
  51          //==============================================================================
  52          // Processing RS-485 data frame:
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 2   

  53          //
  54          // - WAIT_START:    Waits for beginning characters;
  55          // - WAIT_ID:       Waits for ID;
  56          // - WAIT_LENGTH:   Data length;
  57          // - RECEIVE:       Receive all bytes;
  58          // - UNLOAD:        Wait for another device end of transmission;
  59          //
  60          //==============================================================================
  61          
  62          void interrupt_manager(){
  63   1          
  64   1          //===========================================     local variables definition
  65   1      
  66   1          static uint8 CYDATA state = WAIT_START;                      // state
  67   1          
  68   1          //------------------------------------------------- local data packet
  69   1          static uint8 CYDATA data_packet_index;
  70   1          static uint8 CYDATA data_packet_length;
  71   1          static uint8 data_packet_buffer[128];                     
  72   1          static uint8 CYDATA rx_queue[3];                    // last 2 bytes received
  73   1          //-------------------------------------------------
  74   1      
  75   1          uint8 CYDATA    rx_data;                            // RS485 UART rx data
  76   1          CYBIT           rx_data_type;                       // my id?
  77   1          uint8 CYDATA    package_count = 0;                     
  78   1      
  79   1          //======================================================     receive routine
  80   1          
  81   1          // Get data until buffer is not empty 
  82   1          
  83   1          while(UART_RS485_GetRxBufferSize() && (package_count < 6)){  
  84   2              // 6 stima di numero massimo di pacchetti che riesco a leggere senza bloccare l'esecuzione del fir
             -mware
  85   2              
  86   2              // Get next char
  87   2              rx_data = UART_RS485_GetChar();
  88   2              
  89   2              switch (state) {
  90   3                  //-----     wait for frame start     -------------------------------
  91   3                  case WAIT_START:
  92   3                  
  93   3                      rx_queue[0] = rx_queue[1];
  94   3                      rx_queue[1] = rx_queue[2];
  95   3                      rx_queue[2] = rx_data;
  96   3                      
  97   3                      // Check for header configuration package
  98   3                      if ((rx_queue[1] == 58) && (rx_queue[2] == 58)) {
  99   4                          rx_queue[0] = 0;
 100   4                          rx_queue[1] = 0;
 101   4                          rx_queue[2] = 0;
 102   4                          state       = WAIT_ID;                    
 103   4                      }else
 104   3                          if ((rx_queue[0] == 63) &&      //ASCII - ?
 105   3                              (rx_queue[1] == 13) &&      //ASCII - CR
 106   3                              (rx_queue[2] == 10))        //ASCII - LF)
 107   3                              infoGet(INFO_ALL);
 108   3                      break;
 109   3      
 110   3                  //-----     wait for id     ----------------------------------------
 111   3                  case  WAIT_ID:
 112   3      
 113   3                      // packet is for my ID or is broadcast
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 3   

 114   3                      if (rx_data == c_mem.id || rx_data == 0)
 115   3                          rx_data_type = FALSE;
 116   3                      else                //packet is for others
 117   3                          rx_data_type = TRUE;
 118   3                      
 119   3                      data_packet_length = 0;
 120   3                      state = WAIT_LENGTH;
 121   3                      break;
 122   3      
 123   3                  //-----     wait for length     ------------------------------------
 124   3                  case  WAIT_LENGTH:
 125   3      
 126   3       
 127   3                      data_packet_length = rx_data;
 128   3                      // check validity of pack length
 129   3                      if (data_packet_length <= 1) {
 130   4                          data_packet_length = 0;
 131   4                          state = WAIT_START;
 132   4                      } else if (data_packet_length > 128) {
 133   4                          data_packet_length = 0;
 134   4                          state = WAIT_START;
 135   4                      } else {
 136   4                          data_packet_index = 0;
 137   4                          
 138   4                          if(rx_data_type == FALSE)
 139   4                              state = RECEIVE;          // packet for me or broadcast
 140   4                          else
 141   4                              state = UNLOAD;           // packet for others
 142   4                      }
 143   3                      break;
 144   3      
 145   3                  //-----     receiving     -------------------------------------------
 146   3                  case RECEIVE:
 147   3      
 148   3                      data_packet_buffer[data_packet_index] = rx_data;
 149   3                      data_packet_index++;
 150   3                      
 151   3                      // check end of transmission
 152   3                      if (data_packet_index >= data_packet_length) {
 153   4                          // verify if frame ID corresponded to the device ID
 154   4                          if (rx_data_type == FALSE) {
 155   5                              // copying data from buffer to global packet
 156   5                              memcpy(g_rx.buffer, data_packet_buffer, data_packet_length);
 157   5                              g_rx.length = data_packet_length;
 158   5                              g_rx.ready  = 1;
 159   5                              commProcess();
 160   5                          }
 161   4                          
 162   4                          data_packet_index  = 0;
 163   4                          data_packet_length = 0;
 164   4                          state              = WAIT_START;
 165   4                          package_count++;
 166   4                      
 167   4                      }
 168   3                      break;
 169   3      
 170   3                  //-----     other device is receving     ---------------------------
 171   3                  case UNLOAD:
 172   3                      if (!(--data_packet_length)) {
 173   4                          data_packet_index  = 0;
 174   4                          data_packet_length = 0;
 175   4                          RS485_CTS_Write(1);
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 4   

 176   4                          RS485_CTS_Write(0);
 177   4                          state              = WAIT_START;
 178   4                          package_count++;
 179   4                      }
 180   3                      break;
 181   3              }
 182   2          }
 183   1      }
 184          //==============================================================================
 185          //                                                            FUNCTION SCHEDULER
 186          //==============================================================================
 187          // Call all the function with the right frequency
 188          //==============================================================================
 189          // Base frequency 1000 Hz
 190          //==============================================================================
 191          
 192          void function_scheduler(void) {
 193   1      
 194   1          static uint16 counter_calibration = DIV_INIT_VALUE;
 195   1      
 196   1          timer_value0 = (uint32)MY_TIMER_ReadCounter();
 197   1      
 198   1          // Start ADC Conversion, SOC = 1
 199   1      
 200   1          ADC_SOC_Write(0x01); 
 201   1          
 202   1          // Check Interrupt 
 203   1      
 204   1          if (interrupt_flag){
 205   2              interrupt_flag = FALSE;
 206   2              interrupt_manager();
 207   2          }
 208   1        
 209   1          //---------------------------------- Get Encoders
 210   1      
 211   1          encoder_reading(0); 
 212   1          
 213   1          // Check Interrupt     
 214   1          
 215   1          if (interrupt_flag){
 216   2              interrupt_flag = FALSE;
 217   2              interrupt_manager();
 218   2          }   
 219   1          
 220   1          encoder_reading(1);
 221   1          
 222   1          // Check Interrupt 
 223   1          
 224   1          if (interrupt_flag){
 225   2              interrupt_flag = FALSE;
 226   2              interrupt_manager();
 227   2          }
 228   1          
 229   1          encoder_reading(2);
 230   1          
 231   1          // Check Interrupt 
 232   1          
 233   1          if (interrupt_flag){
 234   2              interrupt_flag = FALSE;
 235   2              interrupt_manager();
 236   2          }
 237   1      
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 5   

 238   1          //---------------------------------- Control Motors
 239   1          
 240   1          motor_control(0);
 241   1      
 242   1          // Check Interrupt 
 243   1      
 244   1          if (interrupt_flag){
 245   2              interrupt_flag = FALSE;
 246   2              interrupt_manager();
 247   2          }
 248   1          
 249   1          motor_control(1);
 250   1          
 251   1          // Check Interrupt 
 252   1          
 253   1          if (interrupt_flag){
 254   2              interrupt_flag = FALSE;
 255   2              interrupt_manager();
 256   2          }
 257   1      
 258   1          //---------------------------------- Read conversion buffer - LOCK function
 259   1      
 260   1          analog_read_end();
 261   1      
 262   1          //---------------------------------- Calibration 
 263   1      
 264   1          // Divider 100, freq = 10 Hz
 265   1          if (!(calibration_flag == STOP)) {
 266   2              if (counter_calibration == CALIBRATION_DIV) {
 267   3                  calibration();
 268   3                  counter_calibration = 0;
 269   3              }
 270   2              counter_calibration++;
 271   2          }
 272   1          // Check Interrupt 
 273   1          
 274   1          if (interrupt_flag){
 275   2              interrupt_flag = FALSE;
 276   2              interrupt_manager();
 277   2          }
 278   1         
 279   1          //---------------------------------- Update States
 280   1          
 281   1          // Load k-1 state
 282   1          memcpy( &g_measOld, &g_meas, sizeof(g_meas) );
 283   1          memcpy( &g_refOld, &g_ref, sizeof(g_ref) );
 284   1      
 285   1          // Load k+1 state
 286   1          memcpy( &g_ref, &g_refNew, sizeof(g_ref) );
 287   1      
 288   1          if (interrupt_flag){
 289   2              interrupt_flag = FALSE;
 290   2              interrupt_manager();
 291   2          }
 292   1      
 293   1          timer_value = (uint32)MY_TIMER_ReadCounter();
 294   1          MY_TIMER_WriteCounter(5000000);
 295   1      }
 296          
 297          
 298          //==============================================================================
 299          //                                                                MOTORS CONTROL
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 6   

 300          //==============================================================================
 301          
 302          void motor_control(const uint8 idx) {
 303   1      
 304   1          uint8 CYDATA index = idx;
 305   1      
 306   1          int32 CYDATA curr_ref;
 307   1      
 308   1          int32 CYDATA pwm_input = 0;
 309   1      
 310   1          int32 CYDATA pos_error;
 311   1          int32 CYDATA curr_error;
 312   1          int32 CYDATA defl_input[NUM_OF_MOTORS];
 313   1      
 314   1          int32 CYDATA k_p = c_mem.k_p;  
 315   1          int32 CYDATA k_i = c_mem.k_i; 
 316   1          int32 CYDATA k_d = c_mem.k_d; 
 317   1      
 318   1          int32 CYDATA k_p_c = c_mem.k_p_c;  
 319   1          int32 CYDATA k_i_c = c_mem.k_i_c; 
 320   1          int32 CYDATA k_d_c = c_mem.k_d_c; 
 321   1      
 322   1          int32 CYDATA k_p_dl = c_mem.k_p_dl;  
 323   1          int32 CYDATA k_i_dl = c_mem.k_i_dl; 
 324   1          int32 CYDATA k_d_dl = c_mem.k_d_dl; 
 325   1      
 326   1          int32 CYDATA k_p_c_dl = c_mem.k_p_c_dl;  
 327   1          int32 CYDATA k_i_c_dl = c_mem.k_i_c_dl; 
 328   1          int32 CYDATA k_d_c_dl = c_mem.k_d_c_dl; 
 329   1      
 330   1          static CYBIT dirM0, dirM1;
 331   1      
 332   1          static int32 pos_error_sum[NUM_OF_MOTORS];
 333   1          static int32 curr_error_sum[NUM_OF_MOTORS];
 334   1          static int32 prev_curr_err[NUM_OF_MOTORS];
 335   1      
 336   1          // check index value
 337   1          if (index >= NUM_OF_MOTORS)
 338   1              return;
 339   1          // --------------- USE THIRD ENCODER AS INPUT FOR BOTH MOTORS --------------
 340   1          if (c_mem.input_mode == INPUT_MODE_ENCODER3) {
 341   2      
 342   2              g_ref.pos[index] = g_measOld.pos[2];
 343   2      
 344   2              // position limit
 345   2              if (c_mem.pos_lim_flag) {
 346   3                  if (g_ref.pos[index] < c_mem.pos_lim_inf[index]) 
 347   3                      g_ref.pos[index] = c_mem.pos_lim_inf[index];
 348   3                  if (g_ref.pos[index] > c_mem.pos_lim_sup[index]) 
 349   3                      g_ref.pos[index] = c_mem.pos_lim_sup[index];
 350   3              }
 351   2          }
 352   1      
 353   1          switch(c_mem.control_mode) {
 354   2              case CONTROL_ANGLE:
 355   2              case DEFLECTION_CONTROL:
 356   2              
 357   2                  if(c_mem.control_mode == DEFLECTION_CONTROL){
 358   3                                      //for deflection control the shaft position must be summed to reference
 359   3                                      //but the qbmove_adv has the shaft position with the opposite sign in relation
 360   3                                      //to the motors one.
 361   3                      defl_input[index] = -(g_ref.pos[index] - g_meas.pos[2]);
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 7   

 362   3                      pos_error = defl_input[index] - g_meas.pos[index];
 363   3                  }
 364   2                  else 
 365   2                      // position error
 366   2                      pos_error = g_ref.pos[index] - g_meas.pos[index]; //g_ref.pos[index] 
 367   2         
 368   2                  // error sum for integral
 369   2                  pos_error_sum[index] += pos_error;
 370   2      
 371   2                  if (interrupt_flag){
 372   3                      interrupt_flag = FALSE;
 373   3                      interrupt_manager();
 374   3                  }
 375   2      
 376   2                  //anti wind-up
 377   2                  if (pos_error_sum[index] > POS_INTEGRAL_SAT_LIMIT)
 378   2                      pos_error_sum[index] = POS_INTEGRAL_SAT_LIMIT;
 379   2                  else{
 380   3                      if (pos_error_sum[index] < -POS_INTEGRAL_SAT_LIMIT)
 381   3                          pos_error_sum[index] = -POS_INTEGRAL_SAT_LIMIT;
 382   3                  }
 383   2                    
 384   2                  if (interrupt_flag){
 385   3                      interrupt_flag = FALSE;
 386   3                      interrupt_manager();
 387   3                  }
 388   2                  // pwm_input init
 389   2                  pwm_input = 0;
 390   2                  // Proportional
 391   2                  if (k_p != 0) {
 392   3                          
 393   3                      if ((pos_error > 131072) || (pos_error < -131072))  //if grater than 2^17
 394   3                          pwm_input = (int32)(k_p * (pos_error >> 8)) >> 8;
 395   3                      else
 396   3                          pwm_input = (int32)(k_p * pos_error) >> 16;
 397   3                  }
 398   2                  
 399   2                  if (interrupt_flag){
 400   3                      interrupt_flag = FALSE;
 401   3                      interrupt_manager();
 402   3                  }
 403   2                            
 404   2                  // Integral
 405   2                  if (k_i != 0) 
 406   2                      pwm_input += (int32)((k_i >> 6) * pos_error_sum[index]) >> 10;
 407   2                  
 408   2                  // Derivative
 409   2                  if (k_d != 0)
 410   2                      pwm_input += (int32)(k_d * (g_measOld.pos[index] - g_meas.pos[index])) >> 16;
 411   2               
 412   2          
 413   2                  if (interrupt_flag){
 414   3                      interrupt_flag = FALSE;
 415   3                      interrupt_manager();
 416   3                  }
 417   2      
 418   2                  if (index == 0){
 419   3                      if (pwm_input >= 0)
 420   3                          dirM0 = 1;
 421   3                          //direction |= 0x01;
 422   3                      else
 423   3                          dirM0 = 0;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 8   

 424   3                          //direction &= 0xFE;
 425   3                  }else{ // index == 1
 426   3                      if (pwm_input >= 0)
 427   3                          dirM1 = 1;
 428   3                         // direction |= 0x02;
 429   3                      else
 430   3                          dirM1 = 0;
 431   3                          //direction &= 0xFD;
 432   3                  }
 433   2                  
 434   2                  break;
 435   2      
 436   2              case CURR_AND_POS_CONTROL:
 437   2              case DEFL_CURRENT_CONTROL:
 438   2      
 439   2                  if(c_mem.control_mode == DEFL_CURRENT_CONTROL){
 440   3                      //for deflection control the shaft position must be summed to reference
 441   3                      //but the qbmove_adv has the shaft position with the opposite sign in relation
 442   3                      //to the motors one.
 443   3                      defl_input[index] = -(g_ref.pos[index] - g_meas.pos[2]);
 444   3                      pos_error = defl_input[index] - g_meas.pos[index];
 445   3                  }
 446   2                  else 
 447   2                      pos_error = g_ref.pos[index] - g_meas.pos[index];
 448   2         
 449   2                  if (interrupt_flag){
 450   3                      interrupt_flag = FALSE;
 451   3                      interrupt_manager();
 452   3                  }
 453   2      
 454   2                  pos_error_sum[index] += pos_error;
 455   2      
 456   2                  if (pos_error_sum[index] > POS_INTEGRAL_SAT_LIMIT)
 457   2                      pos_error_sum[index] = POS_INTEGRAL_SAT_LIMIT;
 458   2                  else{
 459   3                      if (pos_error_sum[index] < -POS_INTEGRAL_SAT_LIMIT)
 460   3                          pos_error_sum[index] = -POS_INTEGRAL_SAT_LIMIT;
 461   3                  }
 462   2      
 463   2                  // ------ position PID control -----
 464   2      
 465   2                  curr_ref = 0;
 466   2      
 467   2                  // Proportional
 468   2                  if (k_p_dl != 0) {
 469   3                      if ((pos_error > 131072) || (pos_error < -131072))
 470   3                          curr_ref += (int32)(k_p_dl * (pos_error >> 8)) >> 8;
 471   3                      else
 472   3                          curr_ref += (int32)(k_p_dl * pos_error) >> 16;
 473   3                  }
 474   2      
 475   2                  // Integral
 476   2                  if (k_i_dl != 0)
 477   2                      curr_ref += (int32)(k_i_dl * pos_error_sum[index]) >> 16;
 478   2                  
 479   2                  // Derivative
 480   2                  if (k_d_dl != 0)
 481   2                      curr_ref += (int32)(k_d_dl * (g_measOld.pos[index] - g_meas.pos[index])) >> 16;
 482   2               
 483   2                  if (interrupt_flag){
 484   3                      interrupt_flag = FALSE;
 485   3                      interrupt_manager();
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 9   

 486   3                  }
 487   2      
 488   2                  // saturate max current
 489   2                  if (curr_ref > c_mem.current_limit)
 490   2                      curr_ref = c_mem.current_limit;
 491   2                  else {
 492   3                      if (curr_ref < -c_mem.current_limit)
 493   3                          curr_ref = -c_mem.current_limit;
 494   3                  }
 495   2      
 496   2                  // current error and error sum
 497   2                  curr_error = curr_ref - g_meas.curr[index];
 498   2                  curr_error_sum[index] += curr_error;
 499   2      
 500   2                  if (curr_error_sum[index] > CURR_INTEGRAL_SAT_LIMIT)
 501   2                      curr_error_sum[index] = CURR_INTEGRAL_SAT_LIMIT;
 502   2                  else{
 503   3                      if (curr_error_sum[index] < -CURR_INTEGRAL_SAT_LIMIT)
 504   3                          curr_error_sum[index] = -CURR_INTEGRAL_SAT_LIMIT;
 505   3                  }
 506   2      
 507   2                  if (interrupt_flag){
 508   3                      interrupt_flag = FALSE;
 509   3                      interrupt_manager();
 510   3                  }
 511   2      
 512   2                  // ----- current PID control -----
 513   2      
 514   2                  pwm_input = 0;
 515   2      
 516   2                  // Proportional
 517   2                  if (k_p_c_dl != 0)
 518   2                      pwm_input += (int32)(k_p_c_dl * curr_error) >> 16;
 519   2                  
 520   2                  // Integral
 521   2                  if (k_i_c_dl != 0)
 522   2                      pwm_input += (int32)(k_i_c_dl * curr_error_sum[index]) >> 16;
 523   2                  
 524   2                  // Derivative
 525   2                  if (k_d_c_dl != 0)
 526   2                      pwm_input += (int32)(k_d_c_dl * (g_measOld.curr[index] - g_meas.curr[index])) >> 16;
 527   2      
 528   2                  if (interrupt_flag){
 529   3                      interrupt_flag = FALSE;
 530   3                      interrupt_manager();
 531   3                  }           
 532   2      
 533   2      
 534   2                  if (index == 0) {
 535   3                      if (pwm_input >= 0)
 536   3                          dirM0 = 1;
 537   3                          //direction |= 0x01;
 538   3                      else
 539   3                          dirM0 = 0;
 540   3                          //direction &= 0xFE;
 541   3                  }
 542   2                  else { // index == 1
 543   3                      if (pwm_input >= 0)
 544   3                          dirM1 = 1;
 545   3                         // direction |= 0x02;
 546   3                      else
 547   3                          dirM1 = 0;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 10  

 548   3                          //direction &= 0xFD;
 549   3                  }
 550   2      
 551   2                  if (interrupt_flag){
 552   3                      interrupt_flag = FALSE;
 553   3                      interrupt_manager();
 554   3                  } 
 555   2      
 556   2                  // pwm_input saturation
 557   2                  if (pwm_input < -PWM_MAX_VALUE)
 558   2                      pwm_input = -PWM_MAX_VALUE;
 559   2                  else{
 560   3                      if (pwm_input > PWM_MAX_VALUE)
 561   3                          pwm_input = PWM_MAX_VALUE;
 562   3                  }
 563   2      
 564   2                  break;
 565   2      
 566   2              case CONTROL_CURRENT:
 567   2      
 568   2                  if(g_ref.onoff && tension_valid) {
 569   3      
 570   3                      // Current ref from pos ref
 571   3                      curr_ref = g_ref.curr[index];
 572   3      
 573   3                      // saturate max current
 574   3                      if (curr_ref > c_mem.current_limit) {
 575   4                          curr_ref = c_mem.current_limit;
 576   4                      }
 577   3                      else {
 578   4                          if (curr_ref < -c_mem.current_limit)
 579   4                              curr_ref = -c_mem.current_limit;
 580   4                      }
 581   3      
 582   3                      if (interrupt_flag){
 583   4                          interrupt_flag = FALSE;
 584   4                          interrupt_manager();
 585   4                      }
 586   3      
 587   3                      // Current error
 588   3                      curr_error = (curr_ref) - g_meas.curr[index];
 589   3      
 590   3                      // Error sum for integral
 591   3                      curr_error_sum[index] += curr_error;
 592   3      
 593   3                      //anti wind-up
 594   3                      if (curr_error_sum[index] > CURR_INTEGRAL_SAT_LIMIT) {
 595   4                          curr_error_sum[index] = CURR_INTEGRAL_SAT_LIMIT;
 596   4                      } 
 597   3                      else {
 598   4                          if (curr_error_sum[index] < -CURR_INTEGRAL_SAT_LIMIT) 
 599   4                              curr_error_sum[index] = -CURR_INTEGRAL_SAT_LIMIT;
 600   4                      }
 601   3      
 602   3                      if (interrupt_flag){
 603   4                          interrupt_flag = FALSE;
 604   4                          interrupt_manager();
 605   4                      }
 606   3      
 607   3                      // pwm_input init
 608   3                      pwm_input = 0;
 609   3      
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 11  

 610   3                      // Proportional
 611   3                      if (k_p_c != 0)
 612   3                          pwm_input += (int32)(k_p_c * curr_error) >> 16;
 613   3      
 614   3                      // Integral
 615   3                      if (k_i_c != 0)
 616   3                          pwm_input += (int32)(k_i_c * (curr_error_sum[index] >> 6)) >> 10;
 617   3      
 618   3                      // Derivative
 619   3                      if (k_d_c != 0)
 620   3                          pwm_input += (int32)(k_d_c * (curr_error - prev_curr_err[index])) >> 16;
 621   3                      
 622   3                      if (interrupt_flag){
 623   4                          interrupt_flag = FALSE;
 624   4                          interrupt_manager();
 625   4                      }
 626   3      
 627   3                      // Update measure
 628   3                      prev_curr_err[index] = curr_error;
 629   3      
 630   3                      if (index == 0) {
 631   4                          if (pwm_input >= 0)
 632   4                              dirM0 = 1;
 633   4                              //direction |= 0x01;
 634   4                          else
 635   4                              dirM0 = 0;
 636   4                              //direction &= 0xFE;
 637   4                      }
 638   3                      else { // index == 1
 639   4                          if (pwm_input >= 0)
 640   4                              dirM1 = 1;
 641   4                             // direction |= 0x02;
 642   4                          else
 643   4                              dirM1 = 0;
 644   4                              //direction &= 0xFD;
 645   4                      }
 646   3      
 647   3                      if (interrupt_flag){
 648   4                          interrupt_flag = FALSE;
 649   4                          interrupt_manager();
 650   4                      }
 651   3                  }
 652   2      
 653   2                  break;
 654   2      
 655   2              case CONTROL_PWM:
 656   2                  // Direct PWM value
 657   2                  pwm_input = g_ref.pwm[index];
 658   2      
 659   2      
 660   2                  if (index == 0){
 661   3                      if (pwm_input >= 0)
 662   3                          dirM0 = 1;
 663   3                          //direction |= 0x01;
 664   3                      else
 665   3                          dirM0 = 0;
 666   3                          //direction &= 0xFE;
 667   3                  }
 668   2                  else { // index == 1
 669   3                      if (pwm_input >= 0)
 670   3                          dirM1 = 1;
 671   3                         // direction |= 0x02;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 12  

 672   3                      else
 673   3                          dirM1 = 0;
 674   3                          //direction &= 0xFD;
 675   3                  }
 676   2      
 677   2                  break;
 678   2              default:
 679   2                  break;
 680   2          }
 681   1      
 682   1          if (interrupt_flag){
 683   2              interrupt_flag = FALSE;
 684   2              interrupt_manager();
 685   2          }
 686   1              
 687   1          // abs(pwm_input) must be lower or equal to PWM_MAX_VALUE
 688   1          if(pwm_input >  PWM_MAX_VALUE) 
 689   1              pwm_input =  PWM_MAX_VALUE;
 690   1          if(pwm_input < -PWM_MAX_VALUE) 
 691   1              pwm_input = -PWM_MAX_VALUE;
 692   1          
 693   1          if (interrupt_flag){
 694   2              interrupt_flag = FALSE;
 695   2              interrupt_manager();
 696   2          }   
 697   1      
 698   1          // remap pwm_input on pwm_limit based on input tension to have maximum 8 volts
 699   1          if (c_mem.control_mode != CONTROL_PWM)
 700   1              pwm_input = (((pwm_input << 10) / PWM_MAX_VALUE) * dev_pwm_limit) >> 10;
 701   1      
 702   1          // drive direction and pwm duty cycle
 703   1      
 704   1          if (dirM0){
 705   2              if (dirM1)
 706   2                  MOTOR_DIR_Write(0x03);
 707   2              else
 708   2                  MOTOR_DIR_Write(0x01);
 709   2          }
 710   1          else{
 711   2              if (dirM1)
 712   2                  MOTOR_DIR_Write(0x02);
 713   2              else
 714   2                  MOTOR_DIR_Write(0x00);
 715   2          }
 716   1      
 717   1          if (interrupt_flag){
 718   2              interrupt_flag = FALSE;
 719   2              interrupt_manager();
 720   2          }
 721   1          
 722   1          if (index == 0) {
 723   2              pwm_sign[0] = SIGN(pwm_input);
 724   2              PWM_MOTORS_WriteCompare1(abs(pwm_input));
 725   2          }
 726   1          else { // index == 1
 727   2              pwm_sign[1] = SIGN(pwm_input);
 728   2              PWM_MOTORS_WriteCompare2(abs(pwm_input));
 729   2          }
 730   1      
 731   1          if (interrupt_flag){
 732   2              interrupt_flag = FALSE;
 733   2              interrupt_manager();
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 13  

 734   2          }
 735   1      }
 736          
 737          //==============================================================================
 738          //                                                           ANALOG MEASUREMENTS
 739          //==============================================================================
 740          
 741          void analog_read_end() {
 742   1             
 743   1          /* =========================================================================
 744   1          /   Ideal formulation to calculate tension and current
 745   1          /
 746   1          /   tension = ((read_value_mV - offset) * 101) / gain -> [mV]
 747   1          /   current = ((read_value_mV - offset) * 375) / (gain * resistor) -> [mA]
 748   1          /
 749   1          /   Definition:
 750   1          /   read_value_mV = counts_read / 0.819 -> conversion from counts to mV
 751   1          /   offset = 2000 -> hardware amplifier bias in mV
 752   1          /   gain = 8.086 -> amplifier gain
 753   1          /   resistor = 18 -> resistor of voltage divider in KOhm 
 754   1          /
 755   1          /   Real formulation: tradeoff in good performance and accurancy, ADC_buf[] 
 756   1          /   and offset unit of measurment is counts, instead dev_tension and
 757   1          /   g_meas.curr[] are converted in properly unit.
 758   1          /  =========================================================================
 759   1          */
 760   1          
 761   1          // Wait for conversion end
 762   1          while(!ADC_STATUS_Read()){
 763   2              if (interrupt_flag){
 764   3                  interrupt_flag = FALSE;
 765   3                  interrupt_manager();
 766   3              }
 767   2          }
 768   1          
 769   1          // Convert tension read
 770   1          dev_tension = ((int32)(ADC_buf[0] - 1638) * 1952) >> 7;
 771   1          
 772   1          if (interrupt_flag){
 773   2              interrupt_flag = FALSE;
 774   2              interrupt_manager();
 775   2          }
 776   1      
 777   1          // Until there is no valid input tension repeat this measurement
 778   1          
 779   1          if (dev_tension > 0){
 780   2              
 781   2              POWER_ON_LED_REG_Write(1);
 782   2              
 783   2              // Set PWM depends on tension
 784   2              pwm_limit_search();
 785   2              
 786   2              // Check Interrupt 
 787   2          
 788   2              if (interrupt_flag){
 789   3                  interrupt_flag = FALSE;
 790   3                  interrupt_manager();
 791   3              }
 792   2      
 793   2              // Filter and Set currents
 794   2              g_meas.curr[0] = filter_i1((int16) pwm_sign[0] * (((int32)(ADC_buf[1] - 1638) * 25771) >> 13));
 795   2              
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 14  

 796   2              // Check Interrupt 
 797   2          
 798   2              if (interrupt_flag){
 799   3                  interrupt_flag = FALSE;
 800   3                  interrupt_manager();
 801   3              }
 802   2              g_meas.curr[1] = filter_i2((int16) pwm_sign[1] * (((int32)(ADC_buf[2] - 1638) * 25771) >> 13));
 803   2              
 804   2              // Check Interrupt 
 805   2          
 806   2              if (interrupt_flag){
 807   3                  interrupt_flag = FALSE;
 808   3                  interrupt_manager();
 809   3              }
 810   2              tension_valid = TRUE; 
 811   2          }
 812   1          else {
 813   2              
 814   2              POWER_ON_LED_REG_Write(0);
 815   2              
 816   2              g_meas.curr[0] = 0;
 817   2              g_meas.curr[1] = 0;
 818   2          }
 819   1      }
 820          
 821          //==============================================================================
 822          //                                                               ENCODER READING
 823          //==============================================================================
 824          
 825          
 826          void encoder_reading(const uint8 idx)
 827          {
 828   1          uint8 CYDATA index = idx;
 829   1          
 830   1          uint8 jj;
 831   1          
 832   1          uint32 data_encoder;
 833   1          int32 value_encoder;
 834   1          int32 aux;
 835   1      
 836   1          static int32 last_value_encoder[NUM_OF_SENSORS];
 837   1      
 838   1          static uint8 error[NUM_OF_SENSORS];
 839   1          
 840   1          static CYBIT only_first_time = TRUE;
 841   1      
 842   1          // static int32 l_value[NUM_OF_SENSORS];   //last value for vel
 843   1          // static int32 ll_value[NUM_OF_SENSORS];  //last last value for vel
 844   1          // static int32 lll_value[NUM_OF_SENSORS];  //last last last value for vel
 845   1      
 846   1          if(index >= NUM_OF_SENSORS)
 847   1              return;
 848   1      
 849   1          if(reset_last_value_flag) {
 850   2              for (jj = NUM_OF_SENSORS; jj--;)
 851   2                  last_value_encoder[jj] = 0;
 852   2              reset_last_value_flag = 0;
 853   2          } 
 854   1      
 855   1      
 856   1          //======================================================     reading sensors
 857   1              //Shift right 1 bit to erease dummy bit of chain
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 15  

 858   1          if (index == 0)
 859   1                  data_encoder = (SHIFTREG_ENC_1_ReadData() >> 1) & 0x3FFFF;
 860   1          else {
 861   2              if (index == 2)
 862   2                  data_encoder = (SHIFTREG_ENC_2_ReadData() >> 1) & 0x3FFFF;
 863   2              else // index == 1
 864   2                  data_encoder = (SHIFTREG_ENC_3_ReadData() >> 1) & 0x3FFFF;
 865   2          }    
 866   1          
 867   1          
 868   1      
 869   1          if(check_enc_data(&data_encoder)) {
 870   2      
 871   2              value_encoder = (int32) (((data_encoder & 0x3FFC0) - 0x20000) >> 2);
 872   2      
 873   2              //Add offset and crop to 16bit
 874   2              if(index != 2)
 875   2                  value_encoder = (int16)(value_encoder + g_mem.m_off[index]);
 876   2              else
 877   2                  value_encoder = (int16) -(value_encoder + g_mem.m_off[index]);
 878   2                  
 879   2              // Initialize last_value_encoder
 880   2              if (only_first_time) {
 881   3                  last_value_encoder[index] = value_encoder;
 882   3                  
 883   3                  if (index == (NUM_OF_SENSORS - 1))
 884   3                      only_first_time = 0;
 885   3              }
 886   2      
 887   2              // Take care of rotations
 888   2              aux = value_encoder - last_value_encoder[index];
 889   2      
 890   2              // ====================== 1 TURN ======================
 891   2              // -32768                    0                    32767 -32768                   0                
             -     32767
 892   2              // |-------------------------|-------------------------|-------------------------|----------------
             ----------|
 893   2              //              |                         |      |           |      |                         |
 894   2              //           -16384                     16383    |           |   -16384                     16383
 895   2              //                                               |           |
 896   2              //                                           24575           -24576
 897   2              //                                               |___________|
 898   2              //                                                   49152
 899   2      
 900   2              // if we are in the right interval, take care of rotation
 901   2              // and update the variable only if the difference between
 902   2              // one measure and another is less than 1/4 of turn
 903   2      
 904   2              // Considering we are sampling at 1kHz, this means that our shaft needs
 905   2              // to go slower than 1/4 turn every ms -> 1 turn every 4ms
 906   2              // equal to 250 turn/s -> 15000 RPM
 907   2      
 908   2              if (aux > 49152)
 909   2                  g_meas.rot[index]--;
 910   2              else{ 
 911   3                  if (aux < -49152)
 912   3                      g_meas.rot[index]++;
 913   3                  else{
 914   4                      if (abs(aux) > 16384) { // if two measure are too far
 915   5                          error[index]++;
 916   5                      if (error[index] < 10)
 917   5                          // Discard
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 16  

 918   5                          return;
 919   5                      }
 920   4                  }
 921   3              }
 922   2      
 923   2              error[index] = 0;
 924   2      
 925   2              last_value_encoder[index] = value_encoder;
 926   2      
 927   2              value_encoder += (int32)g_meas.rot[index] << 16;
 928   2      
 929   2              if (c_mem.m_mult[index] != 1.0)
 930   2                  value_encoder *= c_mem.m_mult[index];
 931   2      
 932   2              g_meas.pos[index] = value_encoder;
 933   2          }
 934   1          // // velocity calculation
 935   1          // switch(i) {
 936   1          //     case 0: {
 937   1          //         g_meas.vel[i] = (int16)filter_vel_1((3*value_encoder + l_value[i] - ll_value[i] - 3*lll_val
             -ue[i]) / 10);
 938   1          //         break;
 939   1          //     }
 940   1          //     case 1: {
 941   1          //         g_meas.vel[i] = (int16)filter_vel_2((3*value_encoder + l_value[i] - ll_value[i] - 3*lll_val
             -ue[i]) / 10);
 942   1          //         break;
 943   1          //     }
 944   1          //     case 2: {
 945   1          //         g_meas.vel[i] = (int16)filter_vel_3((3*value_encoder + l_value[i] - ll_value[i] - 3*lll_val
             -ue[i]) / 10);
 946   1          //         break;
 947   1          //     }
 948   1          // }
 949   1      
 950   1          // // update old values
 951   1          // lll_value[i] = ll_value[i];
 952   1          // ll_value[i] = l_value[i];
 953   1          // l_value[i] = value_encoder;
 954   1      }
 955          
 956          
 957          //==============================================================================
 958          //                                                          CALIBRATION FUNCTION
 959          //==============================================================================
 960          
 961          void calibration()
 962          {
 963   1          static int32 old_k_p;
 964   1          static int32 old_k_i;
 965   1          static int32 old_k_d;
 966   1      
 967   1          static uint8 pause_counter = 0;
 968   1      
 969   1          switch(calibration_flag) {
 970   2              case START:
 971   2                  ISR_RS485_RX_Disable();
 972   2      
 973   2                  // save old PID values
 974   2                  old_k_p = c_mem.k_p;
 975   2                  old_k_i = c_mem.k_i;
 976   2                  old_k_d = c_mem.k_d;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 17  

 977   2      
 978   2                  // goto to zero position
 979   2                  g_refNew.pos[0] = 0;
 980   2                  g_refNew.pos[1] = 0;
 981   2      
 982   2                  // Activate motors
 983   2                  if (!(g_refNew.onoff & 0x03)) {
 984   3                      MOTOR_ON_OFF_Write(0x03);
 985   3                  }
 986   2      
 987   2                  // wait for motors to reach zero position
 988   2                  calibration_flag = PAUSE_1;
 989   2                  break;
 990   2      
 991   2              case PAUSE_1:
 992   2                  pause_counter++;
 993   2      
 994   2                  if (pause_counter == 10) {
 995   3                      pause_counter = 0;
 996   3      
 997   3                      // set new temp values for PID parameters
 998   3                      c_mem.k_p = 0.1 * 65536;
 999   3                      c_mem.k_i = 0;
1000   3                      c_mem.k_d = 0.3 * 65536;
1001   3      
1002   3                      calibration_flag = CONTINUE_1;
1003   3                  }
1004   2                  break;
1005   2      
1006   2              case CONTINUE_1:
1007   2                  // increment of 0.5 degree
1008   2                  g_refNew.pos[0] += 65536 / 720;
1009   2                  g_refNew.pos[1] -= 65536 / 720;
1010   2      
1011   2                  // check if one of the motors reach the threashold
1012   2                  if ((g_meas.curr[0] > CALIB_CURRENT) || (g_meas.curr[1] > CALIB_CURRENT)) {
1013   3                      // save current value as MAX_STIFFNESS
1014   3                      g_mem.max_stiffness = g_ref.pos[0];
1015   3      
1016   3                      // reset old values for PID parameters
1017   3                      c_mem.k_p = old_k_p;
1018   3                      c_mem.k_i = old_k_i;
1019   3                      c_mem.k_d = old_k_d;
1020   3      
1021   3                      // go back to zero position
1022   3                      g_refNew.pos[0] = 0;
1023   3                      g_refNew.pos[1] = 0;
1024   3      
1025   3                      // wait for motors to reach zero position
1026   3                      calibration_flag = PAUSE_2;
1027   3                  }
1028   2                  break;
1029   2      
1030   2              case PAUSE_2:
1031   2                  pause_counter++;
1032   2      
1033   2                  if (pause_counter == 10) {
1034   3                      pause_counter =0;
1035   3      
1036   3                      calibration_flag = CONTINUE_2;
1037   3                  }
1038   2                  break;
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 18  

1039   2      
1040   2              case CONTINUE_2:
1041   2                  // Deactivate motors
1042   2                  if (!(g_refNew.onoff & 0x03)) {
1043   3                      MOTOR_ON_OFF_Write(0x00);
1044   3                  }
1045   2      
1046   2                  // store memory to save MAX_STIFFNESS as default value
1047   2                  memStore(DEFAULT_EEPROM_DISPLACEMENT);
1048   2                  memStore(0);
1049   2      
1050   2                  calibration_flag = STOP;
1051   2      
1052   2                  ISR_RS485_RX_Enable();
1053   2                  break;
1054   2      
1055   2              case STOP:
1056   2              default:
1057   2                  break;
1058   2          }
1059   1      }
1060          
1061          
1062          
1063          //==============================================================================
1064          //                                                              PWM_LIMIT_SEARCH
1065          //==============================================================================
1066          
1067          void pwm_limit_search() {
1068   1          dev_pwm_limit = 100;
1069   1      }
1070          
1071          
1072          /* [] END OF FILE */
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 19  

ASSEMBLY LISTING OF GENERATED OBJECT CODE


             ; FUNCTION ISR_WATCHDOG_Handler (BEGIN)
                                           ; SOURCE LINE # 27
                                           ; SOURCE LINE # 31
0000 D200        E     SETB    watchdog_flag
                                           ; SOURCE LINE # 33
0002 32                RETI    
             ; FUNCTION ISR_WATCHDOG_Handler (END)

             ; FUNCTION ISR_RS485_RX_ExInterrupt (BEGIN)
                                           ; SOURCE LINE # 39
                                           ; SOURCE LINE # 43
0000 D200        E     SETB    interrupt_flag
                                           ; SOURCE LINE # 45
0002 32                RETI    
             ; FUNCTION ISR_RS485_RX_ExInterrupt (END)

             ; FUNCTION interrupt_manager (BEGIN)
                                           ; SOURCE LINE # 62
                                           ; SOURCE LINE # 77
0000 E4                CLR     A
0001 F500        R     MOV     package_count,A
0003         ?C0003:
                                           ; SOURCE LINE # 83
0003 120000      E     LCALL   UART_RS485_GetRxBufferSize
0006 EF                MOV     A,R7
0007 7003              JNZ     $ + 5H
0009 020000      R     LJMP    ?C0026
000C E500        R     MOV     A,package_count
000E C3                CLR     C
000F 9406              SUBB    A,#06H
0011 4003              JC      $ + 5H
0013 020000      R     LJMP    ?C0026
                                           ; SOURCE LINE # 87
0016 120000      E     LCALL   UART_RS485_GetChar
0019 8F00        R     MOV     rx_data,R7
                                           ; SOURCE LINE # 89
001B E500        R     MOV     A,state
001D 14                DEC     A
001E 6049              JZ      ?C0010
0020 14                DEC     A
0021 6060              JZ      ?C0014
0023 14                DEC     A
0024 7003              JNZ     $ + 5H
0026 020000      R     LJMP    ?C0021
0029 14                DEC     A
002A 7003              JNZ     $ + 5H
002C 020000      R     LJMP    ?C0024
002F 2404              ADD     A,#04H
0031 70D0              JNZ     ?C0003
                                           ; SOURCE LINE # 91
0033         ?C0006:
                                           ; SOURCE LINE # 93
0033 850000      R     MOV     rx_queue,rx_queue+01H
                                           ; SOURCE LINE # 94
0036 850000      R     MOV     rx_queue+01H,rx_queue+02H
                                           ; SOURCE LINE # 95
0039 850000      R     MOV     rx_queue+02H,rx_data
                                           ; SOURCE LINE # 98
003C E500        R     MOV     A,rx_queue+01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 20  

003E B43A11            CJNE    A,#03AH,?C0007
0041 E500        R     MOV     A,rx_queue+02H
0043 B43A0C            CJNE    A,#03AH,?C0007
                                           ; SOURCE LINE # 99
0046 E4                CLR     A
0047 F500        R     MOV     rx_queue,A
                                           ; SOURCE LINE # 100
0049 F500        R     MOV     rx_queue+01H,A
                                           ; SOURCE LINE # 101
004B F500        R     MOV     rx_queue+02H,A
                                           ; SOURCE LINE # 102
004D 750001      R     MOV     state,#01H
                                           ; SOURCE LINE # 103
0050 80B1              SJMP    ?C0003
0052         ?C0007:
                                           ; SOURCE LINE # 104
0052 E500        R     MOV     A,rx_queue
0054 B43FAC            CJNE    A,#03FH,?C0003
0057 E500        R     MOV     A,rx_queue+01H
0059 B40DA7            CJNE    A,#0DH,?C0003
005C E500        R     MOV     A,rx_queue+02H
005E 640A              XRL     A,#0AH
0060 70A1              JNZ     ?C0003
                                           ; SOURCE LINE # 107
0062 FF                MOV     R7,A
0063 FE                MOV     R6,A
0064 120000      E     LCALL   _infoGet
                                           ; SOURCE LINE # 108
0067 809A              SJMP    ?C0003
                                           ; SOURCE LINE # 111
0069         ?C0010:
                                           ; SOURCE LINE # 114
0069 900000      E     MOV     DPTR,#c_mem+01H
006C E0                MOVX    A,@DPTR
006D 6500        R     XRL     A,rx_data
006F 6004              JZ      ?C0012
0071 E500        R     MOV     A,rx_data
0073 7004              JNZ     ?C0011
0075         ?C0012:
                                           ; SOURCE LINE # 115
0075 C200        R     CLR     rx_data_type
0077 8002              SJMP    ?C0013
0079         ?C0011:
                                           ; SOURCE LINE # 117
0079 D200        R     SETB    rx_data_type
007B         ?C0013:
                                           ; SOURCE LINE # 119
007B E4                CLR     A
007C F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 120
007E 750002      R     MOV     state,#02H
                                           ; SOURCE LINE # 121
0081 8080              SJMP    ?C0003
                                           ; SOURCE LINE # 124
0083         ?C0014:
                                           ; SOURCE LINE # 127
0083 850000      R     MOV     data_packet_length,rx_data
                                           ; SOURCE LINE # 129
0086 E500        R     MOV     A,data_packet_length
0088 D3                SETB    C
0089 9401              SUBB    A,#01H
008B 5008              JNC     ?C0015
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 21  

                                           ; SOURCE LINE # 130
008D E4                CLR     A
008E F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 131
0090 F500        R     MOV     state,A
                                           ; SOURCE LINE # 132
0092 020000      R     LJMP    ?C0003
0095         ?C0015:
0095 E500        R     MOV     A,data_packet_length
0097 D3                SETB    C
0098 9480              SUBB    A,#080H
009A 4008              JC      ?C0017
                                           ; SOURCE LINE # 133
009C E4                CLR     A
009D F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 134
009F F500        R     MOV     state,A
                                           ; SOURCE LINE # 135
00A1 020000      R     LJMP    ?C0003
00A4         ?C0017:
                                           ; SOURCE LINE # 136
00A4 E4                CLR     A
00A5 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 138
00A7 200006            JB      rx_data_type,?C0019
                                           ; SOURCE LINE # 139
00AA 750003      R     MOV     state,#03H
00AD 020000      R     LJMP    ?C0003
00B0         ?C0019:
                                           ; SOURCE LINE # 141
00B0 750004      R     MOV     state,#04H
                                           ; SOURCE LINE # 142
                                           ; SOURCE LINE # 143
00B3 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 146
00B6         ?C0021:
                                           ; SOURCE LINE # 148
00B6 7400        R     MOV     A,#LOW data_packet_buffer
00B8 2500        R     ADD     A,data_packet_index
00BA F582              MOV     DPL,A
00BC E4                CLR     A
00BD 3400        R     ADDC    A,#HIGH data_packet_buffer
00BF F583              MOV     DPH,A
00C1 E500        R     MOV     A,rx_data
00C3 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 149
00C4 0500        R     INC     data_packet_index
                                           ; SOURCE LINE # 152
00C6 E500        R     MOV     A,data_packet_index
00C8 C3                CLR     C
00C9 9500        R     SUBB    A,data_packet_length
00CB 5003              JNC     $ + 5H
00CD 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 154
00D0 200025            JB      rx_data_type,?C0023
                                           ; SOURCE LINE # 156
00D3 AF00        R     MOV     R7,data_packet_length
00D5 7E00              MOV     R6,#00H
00D7 7800        E     MOV     R0,#LOW g_rx
00D9 7C00        E     MOV     R4,#HIGH g_rx
00DB 7D01              MOV     R5,#01H
00DD 7B01              MOV     R3,#01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 22  

00DF 7A00        R     MOV     R2,#HIGH data_packet_buffer
00E1 7900        R     MOV     R1,#LOW data_packet_buffer
00E3 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 157
00E6 900000      E     MOV     DPTR,#g_rx+080H
00E9 E4                CLR     A
00EA F0                MOVX    @DPTR,A
00EB A3                INC     DPTR
00EC E500        R     MOV     A,data_packet_length
00EE F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 158
00EF 900000      E     MOV     DPTR,#g_rx+084H
00F2 7401              MOV     A,#01H
00F4 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 159
00F5 120000      E     LCALL   commProcess
                                           ; SOURCE LINE # 160
00F8         ?C0023:
                                           ; SOURCE LINE # 162
00F8 E4                CLR     A
00F9 F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 163
00FB F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 164
00FD F500        R     MOV     state,A
                                           ; SOURCE LINE # 165
00FF 0500        R     INC     package_count
                                           ; SOURCE LINE # 167
                                           ; SOURCE LINE # 168
0101 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 171
0104         ?C0024:
                                           ; SOURCE LINE # 172
0104 1500        R     DEC     data_packet_length
0106 E500        R     MOV     A,data_packet_length
0108 6003              JZ      $ + 5H
010A 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 173
010D F500        R     MOV     data_packet_index,A
                                           ; SOURCE LINE # 174
010F F500        R     MOV     data_packet_length,A
                                           ; SOURCE LINE # 175
0111 7F01              MOV     R7,#01H
0113 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 176
0116 E4                CLR     A
0117 FF                MOV     R7,A
0118 120000      E     LCALL   _RS485_CTS_Write
                                           ; SOURCE LINE # 177
011B E4                CLR     A
011C F500        R     MOV     state,A
                                           ; SOURCE LINE # 178
011E 0500        R     INC     package_count
                                           ; SOURCE LINE # 179
                                           ; SOURCE LINE # 180
0120 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 181
                                           ; SOURCE LINE # 182
0123 020000      R     LJMP    ?C0003
                                           ; SOURCE LINE # 183
0126         ?C0026:
0126 22                RET     
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 23  

             ; FUNCTION interrupt_manager (END)

             ; FUNCTION function_scheduler (BEGIN)
                                           ; SOURCE LINE # 192
                                           ; SOURCE LINE # 196
0000 120000      E     LCALL   MY_TIMER_ReadCounter
0003 900000      E     MOV     DPTR,#timer_value0
0006 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 200
0009 7F01              MOV     R7,#01H
000B 120000      E     LCALL   _ADC_SOC_Write
                                           ; SOURCE LINE # 204
000E 300005            JNB     interrupt_flag,?C0027
                                           ; SOURCE LINE # 205
0011 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 206
0013 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 207
0016         ?C0027:
                                           ; SOURCE LINE # 211
0016 E4                CLR     A
0017 FF                MOV     R7,A
0018 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 215
001B 300005            JNB     interrupt_flag,?C0028
                                           ; SOURCE LINE # 216
001E C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 217
0020 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 218
0023         ?C0028:
                                           ; SOURCE LINE # 220
0023 7F01              MOV     R7,#01H
0025 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 224
0028 300005            JNB     interrupt_flag,?C0029
                                           ; SOURCE LINE # 225
002B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 226
002D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 227
0030         ?C0029:
                                           ; SOURCE LINE # 229
0030 7F02              MOV     R7,#02H
0032 120000      R     LCALL   _encoder_reading
                                           ; SOURCE LINE # 233
0035 300005            JNB     interrupt_flag,?C0030
                                           ; SOURCE LINE # 234
0038 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 235
003A 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 236
003D         ?C0030:
                                           ; SOURCE LINE # 240
003D E4                CLR     A
003E FF                MOV     R7,A
003F 120000      R     LCALL   _motor_control
                                           ; SOURCE LINE # 244
0042 300005            JNB     interrupt_flag,?C0031
                                           ; SOURCE LINE # 245
0045 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 246
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 24  

0047 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 247
004A         ?C0031:
                                           ; SOURCE LINE # 249
004A 7F01              MOV     R7,#01H
004C 120000      R     LCALL   _motor_control
                                           ; SOURCE LINE # 253
004F 300005            JNB     interrupt_flag,?C0032
                                           ; SOURCE LINE # 254
0052 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 255
0054 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 256
0057         ?C0032:
                                           ; SOURCE LINE # 260
0057 120000      R     LCALL   analog_read_end
                                           ; SOURCE LINE # 265
005A 900000      E     MOV     DPTR,#calibration_flag
005D E0                MOVX    A,@DPTR
005E 7003              JNZ     ?C0034
0060 D3                SETB    C
0061 8001              SJMP    ?C0035
0063         ?C0034:
0063 C3                CLR     C
0064         ?C0035:
0064 4024              JC      ?C0033
                                           ; SOURCE LINE # 266
0066 900000      R     MOV     DPTR,#counter_calibration
0069 E0                MOVX    A,@DPTR
006A 7004              JNZ     ?C0201
006C A3                INC     DPTR
006D E0                MOVX    A,@DPTR
006E 6464              XRL     A,#064H
0070         ?C0201:
0070 700A              JNZ     ?C0036
                                           ; SOURCE LINE # 267
0072 120000      R     LCALL   calibration
                                           ; SOURCE LINE # 268
0075 E4                CLR     A
0076 900000      R     MOV     DPTR,#counter_calibration
0079 F0                MOVX    @DPTR,A
007A A3                INC     DPTR
007B F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 269
007C         ?C0036:
                                           ; SOURCE LINE # 270
007C 900000      R     MOV     DPTR,#counter_calibration+01H
007F E0                MOVX    A,@DPTR
0080 04                INC     A
0081 F0                MOVX    @DPTR,A
0082 7006              JNZ     ?C0202
0084 900000      R     MOV     DPTR,#counter_calibration
0087 E0                MOVX    A,@DPTR
0088 04                INC     A
0089 F0                MOVX    @DPTR,A
008A         ?C0202:
                                           ; SOURCE LINE # 271
008A         ?C0033:
                                           ; SOURCE LINE # 274
008A 300005            JNB     interrupt_flag,?C0037
                                           ; SOURCE LINE # 275
008D C200        E     CLR     interrupt_flag
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 25  

                                           ; SOURCE LINE # 276
008F 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 277
0092         ?C0037:
                                           ; SOURCE LINE # 282
0092 7800        E     MOV     R0,#LOW g_measOld
0094 7C00        E     MOV     R4,#HIGH g_measOld
0096 7D01              MOV     R5,#01H
0098 7B01              MOV     R3,#01H
009A 7A00        E     MOV     R2,#HIGH g_meas
009C 7900        E     MOV     R1,#LOW g_meas
009E 7E00              MOV     R6,#00H
00A0 7F29              MOV     R7,#029H
00A2 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 283
00A5 7800        E     MOV     R0,#LOW g_refOld
00A7 7C00        E     MOV     R4,#HIGH g_refOld
00A9 7D01              MOV     R5,#01H
00AB 7B01              MOV     R3,#01H
00AD 7A00        E     MOV     R2,#HIGH g_ref
00AF 7900        E     MOV     R1,#LOW g_ref
00B1 7E00              MOV     R6,#00H
00B3 7F19              MOV     R7,#019H
00B5 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 286
00B8 7800        E     MOV     R0,#LOW g_ref
00BA 7C00        E     MOV     R4,#HIGH g_ref
00BC 7D01              MOV     R5,#01H
00BE 7B01              MOV     R3,#01H
00C0 7A00        E     MOV     R2,#HIGH g_refNew
00C2 7900        E     MOV     R1,#LOW g_refNew
00C4 7E00              MOV     R6,#00H
00C6 7F19              MOV     R7,#019H
00C8 120000      E     LCALL   ?C?COPYAMD
                                           ; SOURCE LINE # 288
00CB 300005            JNB     interrupt_flag,?C0038
                                           ; SOURCE LINE # 289
00CE C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 290
00D0 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 291
00D3         ?C0038:
                                           ; SOURCE LINE # 293
00D3 120000      E     LCALL   MY_TIMER_ReadCounter
00D6 900000      E     MOV     DPTR,#timer_value
00D9 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 294
00DC 7F40              MOV     R7,#040H
00DE 7E4B              MOV     R6,#04BH
00E0 7D4C              MOV     R5,#04CH
00E2 7C00              MOV     R4,#00H
00E4 120000      E     LCALL   _MY_TIMER_WriteCounter
                                           ; SOURCE LINE # 295
00E7 22                RET     
             ; FUNCTION function_scheduler (END)

             ; FUNCTION _motor_control (BEGIN)
                                           ; SOURCE LINE # 302
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 304
0000 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 308
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 26  

0002 E4                CLR     A
0003 F500        R     MOV     pwm_input+03H,A
0005 F500        R     MOV     pwm_input+02H,A
0007 F500        R     MOV     pwm_input+01H,A
0009 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 314
000B 900000      E     MOV     DPTR,#c_mem+02H
000E E0                MOVX    A,@DPTR
000F FC                MOV     R4,A
0010 A3                INC     DPTR
0011 E0                MOVX    A,@DPTR
0012 FD                MOV     R5,A
0013 A3                INC     DPTR
0014 E0                MOVX    A,@DPTR
0015 FE                MOV     R6,A
0016 A3                INC     DPTR
0017 E0                MOVX    A,@DPTR
0018 F500        R     MOV     k_p+03H,A
001A 8E00        R     MOV     k_p+02H,R6
001C 8D00        R     MOV     k_p+01H,R5
001E 8C00        R     MOV     k_p,R4
                                           ; SOURCE LINE # 315
0020 A3                INC     DPTR
0021 E0                MOVX    A,@DPTR
0022 FC                MOV     R4,A
0023 A3                INC     DPTR
0024 E0                MOVX    A,@DPTR
0025 FD                MOV     R5,A
0026 A3                INC     DPTR
0027 E0                MOVX    A,@DPTR
0028 FE                MOV     R6,A
0029 A3                INC     DPTR
002A E0                MOVX    A,@DPTR
002B F500        R     MOV     k_i+03H,A
002D 8E00        R     MOV     k_i+02H,R6
002F 8D00        R     MOV     k_i+01H,R5
0031 8C00        R     MOV     k_i,R4
                                           ; SOURCE LINE # 316
0033 A3                INC     DPTR
0034 E0                MOVX    A,@DPTR
0035 FC                MOV     R4,A
0036 A3                INC     DPTR
0037 E0                MOVX    A,@DPTR
0038 FD                MOV     R5,A
0039 A3                INC     DPTR
003A E0                MOVX    A,@DPTR
003B FE                MOV     R6,A
003C A3                INC     DPTR
003D E0                MOVX    A,@DPTR
003E F500        R     MOV     k_d+03H,A
0040 8E00        R     MOV     k_d+02H,R6
0042 8D00        R     MOV     k_d+01H,R5
0044 8C00        R     MOV     k_d,R4
                                           ; SOURCE LINE # 318
0046 A3                INC     DPTR
0047 E0                MOVX    A,@DPTR
0048 FC                MOV     R4,A
0049 A3                INC     DPTR
004A E0                MOVX    A,@DPTR
004B FD                MOV     R5,A
004C A3                INC     DPTR
004D E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 27  

004E FE                MOV     R6,A
004F A3                INC     DPTR
0050 E0                MOVX    A,@DPTR
0051 F500        R     MOV     k_p_c+03H,A
0053 8E00        R     MOV     k_p_c+02H,R6
0055 8D00        R     MOV     k_p_c+01H,R5
0057 8C00        R     MOV     k_p_c,R4
                                           ; SOURCE LINE # 319
0059 A3                INC     DPTR
005A E0                MOVX    A,@DPTR
005B FC                MOV     R4,A
005C A3                INC     DPTR
005D E0                MOVX    A,@DPTR
005E FD                MOV     R5,A
005F A3                INC     DPTR
0060 E0                MOVX    A,@DPTR
0061 FE                MOV     R6,A
0062 A3                INC     DPTR
0063 E0                MOVX    A,@DPTR
0064 F500        R     MOV     k_i_c+03H,A
0066 8E00        R     MOV     k_i_c+02H,R6
0068 8D00        R     MOV     k_i_c+01H,R5
006A 8C00        R     MOV     k_i_c,R4
                                           ; SOURCE LINE # 320
006C A3                INC     DPTR
006D E0                MOVX    A,@DPTR
006E FC                MOV     R4,A
006F A3                INC     DPTR
0070 E0                MOVX    A,@DPTR
0071 FD                MOV     R5,A
0072 A3                INC     DPTR
0073 E0                MOVX    A,@DPTR
0074 FE                MOV     R6,A
0075 A3                INC     DPTR
0076 E0                MOVX    A,@DPTR
0077 F500        R     MOV     k_d_c+03H,A
0079 8E00        R     MOV     k_d_c+02H,R6
007B 8D00        R     MOV     k_d_c+01H,R5
007D 8C00        R     MOV     k_d_c,R4
                                           ; SOURCE LINE # 322
007F A3                INC     DPTR
0080 E0                MOVX    A,@DPTR
0081 FC                MOV     R4,A
0082 A3                INC     DPTR
0083 E0                MOVX    A,@DPTR
0084 FD                MOV     R5,A
0085 A3                INC     DPTR
0086 E0                MOVX    A,@DPTR
0087 FE                MOV     R6,A
0088 A3                INC     DPTR
0089 E0                MOVX    A,@DPTR
008A F500        R     MOV     k_p_dl+03H,A
008C 8E00        R     MOV     k_p_dl+02H,R6
008E 8D00        R     MOV     k_p_dl+01H,R5
0090 8C00        R     MOV     k_p_dl,R4
                                           ; SOURCE LINE # 323
0092 A3                INC     DPTR
0093 E0                MOVX    A,@DPTR
0094 FC                MOV     R4,A
0095 A3                INC     DPTR
0096 E0                MOVX    A,@DPTR
0097 FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 28  

0098 A3                INC     DPTR
0099 E0                MOVX    A,@DPTR
009A FE                MOV     R6,A
009B A3                INC     DPTR
009C E0                MOVX    A,@DPTR
009D F500        R     MOV     k_i_dl+03H,A
009F 8E00        R     MOV     k_i_dl+02H,R6
00A1 8D00        R     MOV     k_i_dl+01H,R5
00A3 8C00        R     MOV     k_i_dl,R4
                                           ; SOURCE LINE # 324
00A5 A3                INC     DPTR
00A6 E0                MOVX    A,@DPTR
00A7 FC                MOV     R4,A
00A8 A3                INC     DPTR
00A9 E0                MOVX    A,@DPTR
00AA FD                MOV     R5,A
00AB A3                INC     DPTR
00AC E0                MOVX    A,@DPTR
00AD FE                MOV     R6,A
00AE A3                INC     DPTR
00AF E0                MOVX    A,@DPTR
00B0 F500        R     MOV     k_d_dl+03H,A
00B2 8E00        R     MOV     k_d_dl+02H,R6
00B4 8D00        R     MOV     k_d_dl+01H,R5
00B6 8C00        R     MOV     k_d_dl,R4
                                           ; SOURCE LINE # 326
00B8 A3                INC     DPTR
00B9 E0                MOVX    A,@DPTR
00BA FC                MOV     R4,A
00BB A3                INC     DPTR
00BC E0                MOVX    A,@DPTR
00BD FD                MOV     R5,A
00BE A3                INC     DPTR
00BF E0                MOVX    A,@DPTR
00C0 FE                MOV     R6,A
00C1 A3                INC     DPTR
00C2 E0                MOVX    A,@DPTR
00C3 F500        R     MOV     k_p_c_dl+03H,A
00C5 8E00        R     MOV     k_p_c_dl+02H,R6
00C7 8D00        R     MOV     k_p_c_dl+01H,R5
00C9 8C00        R     MOV     k_p_c_dl,R4
                                           ; SOURCE LINE # 327
00CB A3                INC     DPTR
00CC E0                MOVX    A,@DPTR
00CD FC                MOV     R4,A
00CE A3                INC     DPTR
00CF E0                MOVX    A,@DPTR
00D0 FD                MOV     R5,A
00D1 A3                INC     DPTR
00D2 E0                MOVX    A,@DPTR
00D3 FE                MOV     R6,A
00D4 A3                INC     DPTR
00D5 E0                MOVX    A,@DPTR
00D6 F500        R     MOV     k_i_c_dl+03H,A
00D8 8E00        R     MOV     k_i_c_dl+02H,R6
00DA 8D00        R     MOV     k_i_c_dl+01H,R5
00DC 8C00        R     MOV     k_i_c_dl,R4
                                           ; SOURCE LINE # 328
00DE A3                INC     DPTR
00DF E0                MOVX    A,@DPTR
00E0 FC                MOV     R4,A
00E1 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 29  

00E2 E0                MOVX    A,@DPTR
00E3 FD                MOV     R5,A
00E4 A3                INC     DPTR
00E5 E0                MOVX    A,@DPTR
00E6 FE                MOV     R6,A
00E7 A3                INC     DPTR
00E8 E0                MOVX    A,@DPTR
00E9 F500        R     MOV     k_d_c_dl+03H,A
00EB 8E00        R     MOV     k_d_c_dl+02H,R6
00ED 8D00        R     MOV     k_d_c_dl+01H,R5
00EF 8C00        R     MOV     k_d_c_dl,R4
                                           ; SOURCE LINE # 337
00F1 E500        R     MOV     A,index
00F3 C3                CLR     C
00F4 9402              SUBB    A,#02H
00F6 4003              JC      $ + 5H
00F8 020000      R     LJMP    ?C0041
00FB         ?C0040:
                                           ; SOURCE LINE # 340
00FB 900000      E     MOV     DPTR,#c_mem+035H
00FE E0                MOVX    A,@DPTR
00FF 6401              XRL     A,#01H
0101 6003              JZ      $ + 5H
0103 020000      R     LJMP    ?C0042
                                           ; SOURCE LINE # 342
0106 900000      E     MOV     DPTR,#g_measOld+08H
0109 E0                MOVX    A,@DPTR
010A FC                MOV     R4,A
010B A3                INC     DPTR
010C E0                MOVX    A,@DPTR
010D FD                MOV     R5,A
010E A3                INC     DPTR
010F E0                MOVX    A,@DPTR
0110 FE                MOV     R6,A
0111 A3                INC     DPTR
0112 E0                MOVX    A,@DPTR
0113 FF                MOV     R7,A
0114 E500        R     MOV     A,index
0116 25E0              ADD     A,ACC
0118 25E0              ADD     A,ACC
011A 2400        E     ADD     A,#LOW g_ref
011C F582              MOV     DPL,A
011E E4                CLR     A
011F 3400        E     ADDC    A,#HIGH g_ref
0121 F583              MOV     DPH,A
0123 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 345
0126 900000      E     MOV     DPTR,#c_mem+052H
0129 E0                MOVX    A,@DPTR
012A 7003              JNZ     $ + 5H
012C 020000      R     LJMP    ?C0042
                                           ; SOURCE LINE # 346
012F E500        R     MOV     A,index
0131 25E0              ADD     A,ACC
0133 25E0              ADD     A,ACC
0135 2400        E     ADD     A,#LOW c_mem+053H
0137 F582              MOV     DPL,A
0139 E4                CLR     A
013A 3400        E     ADDC    A,#HIGH c_mem+053H
013C F583              MOV     DPH,A
013E E0                MOVX    A,@DPTR
013F FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 30  

0140 A3                INC     DPTR
0141 E0                MOVX    A,@DPTR
0142 FD                MOV     R5,A
0143 A3                INC     DPTR
0144 E0                MOVX    A,@DPTR
0145 FE                MOV     R6,A
0146 A3                INC     DPTR
0147 E0                MOVX    A,@DPTR
0148 FF                MOV     R7,A
0149 E500        R     MOV     A,index
014B 25E0              ADD     A,ACC
014D 25E0              ADD     A,ACC
014F 2400        E     ADD     A,#LOW g_ref
0151 F582              MOV     DPL,A
0153 E4                CLR     A
0154 3400        E     ADDC    A,#HIGH g_ref
0156 F583              MOV     DPH,A
0158 E0                MOVX    A,@DPTR
0159 F8                MOV     R0,A
015A A3                INC     DPTR
015B E0                MOVX    A,@DPTR
015C F9                MOV     R1,A
015D A3                INC     DPTR
015E E0                MOVX    A,@DPTR
015F FA                MOV     R2,A
0160 A3                INC     DPTR
0161 E0                MOVX    A,@DPTR
0162 FB                MOV     R3,A
0163 C3                CLR     C
0164 120000      E     LCALL   ?C?SLCMP
0167 502C              JNC     ?C0044
                                           ; SOURCE LINE # 347
0169 E500        R     MOV     A,index
016B 25E0              ADD     A,ACC
016D 25E0              ADD     A,ACC
016F 2400        E     ADD     A,#LOW c_mem+053H
0171 F582              MOV     DPL,A
0173 E4                CLR     A
0174 3400        E     ADDC    A,#HIGH c_mem+053H
0176 F583              MOV     DPH,A
0178 E0                MOVX    A,@DPTR
0179 FC                MOV     R4,A
017A A3                INC     DPTR
017B E0                MOVX    A,@DPTR
017C FD                MOV     R5,A
017D A3                INC     DPTR
017E E0                MOVX    A,@DPTR
017F FE                MOV     R6,A
0180 A3                INC     DPTR
0181 E0                MOVX    A,@DPTR
0182 FF                MOV     R7,A
0183 E500        R     MOV     A,index
0185 25E0              ADD     A,ACC
0187 25E0              ADD     A,ACC
0189 2400        E     ADD     A,#LOW g_ref
018B F582              MOV     DPL,A
018D E4                CLR     A
018E 3400        E     ADDC    A,#HIGH g_ref
0190 F583              MOV     DPH,A
0192 120000      E     LCALL   ?C?LSTXDATA
0195         ?C0044:
                                           ; SOURCE LINE # 348
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 31  

0195 E500        R     MOV     A,index
0197 25E0              ADD     A,ACC
0199 25E0              ADD     A,ACC
019B 2400        E     ADD     A,#LOW c_mem+05BH
019D F582              MOV     DPL,A
019F E4                CLR     A
01A0 3400        E     ADDC    A,#HIGH c_mem+05BH
01A2 F583              MOV     DPH,A
01A4 E0                MOVX    A,@DPTR
01A5 FC                MOV     R4,A
01A6 A3                INC     DPTR
01A7 E0                MOVX    A,@DPTR
01A8 FD                MOV     R5,A
01A9 A3                INC     DPTR
01AA E0                MOVX    A,@DPTR
01AB FE                MOV     R6,A
01AC A3                INC     DPTR
01AD E0                MOVX    A,@DPTR
01AE FF                MOV     R7,A
01AF E500        R     MOV     A,index
01B1 25E0              ADD     A,ACC
01B3 25E0              ADD     A,ACC
01B5 2400        E     ADD     A,#LOW g_ref
01B7 F582              MOV     DPL,A
01B9 E4                CLR     A
01BA 3400        E     ADDC    A,#HIGH g_ref
01BC F583              MOV     DPH,A
01BE E0                MOVX    A,@DPTR
01BF F8                MOV     R0,A
01C0 A3                INC     DPTR
01C1 E0                MOVX    A,@DPTR
01C2 F9                MOV     R1,A
01C3 A3                INC     DPTR
01C4 E0                MOVX    A,@DPTR
01C5 FA                MOV     R2,A
01C6 A3                INC     DPTR
01C7 E0                MOVX    A,@DPTR
01C8 FB                MOV     R3,A
01C9 D3                SETB    C
01CA 120000      E     LCALL   ?C?SLCMP
01CD 402C              JC      ?C0042
                                           ; SOURCE LINE # 349
01CF E500        R     MOV     A,index
01D1 25E0              ADD     A,ACC
01D3 25E0              ADD     A,ACC
01D5 2400        E     ADD     A,#LOW c_mem+05BH
01D7 F582              MOV     DPL,A
01D9 E4                CLR     A
01DA 3400        E     ADDC    A,#HIGH c_mem+05BH
01DC F583              MOV     DPH,A
01DE E0                MOVX    A,@DPTR
01DF FC                MOV     R4,A
01E0 A3                INC     DPTR
01E1 E0                MOVX    A,@DPTR
01E2 FD                MOV     R5,A
01E3 A3                INC     DPTR
01E4 E0                MOVX    A,@DPTR
01E5 FE                MOV     R6,A
01E6 A3                INC     DPTR
01E7 E0                MOVX    A,@DPTR
01E8 FF                MOV     R7,A
01E9 E500        R     MOV     A,index
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 32  

01EB 25E0              ADD     A,ACC
01ED 25E0              ADD     A,ACC
01EF 2400        E     ADD     A,#LOW g_ref
01F1 F582              MOV     DPL,A
01F3 E4                CLR     A
01F4 3400        E     ADDC    A,#HIGH g_ref
01F6 F583              MOV     DPH,A
01F8 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 350
                                           ; SOURCE LINE # 351
01FB         ?C0042:
                                           ; SOURCE LINE # 353
01FB 900000      E     MOV     DPTR,#c_mem+036H
01FE E0                MOVX    A,@DPTR
01FF FF                MOV     R7,A
0200 14                DEC     A
0201 7003              JNZ     $ + 5H
0203 020000      R     LJMP    ?C0127
0206 14                DEC     A
0207 7003              JNZ     $ + 5H
0209 020000      R     LJMP    ?C0106
020C 14                DEC     A
020D 7003              JNZ     $ + 5H
020F 020000      R     LJMP    ?C0071
0212 14                DEC     A
0213 600D              JZ      ?C0048
0215 14                DEC     A
0216 7003              JNZ     $ + 5H
0218 020000      R     LJMP    ?C0071
021B 2405              ADD     A,#05H
021D 6003              JZ      $ + 5H
021F 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 354
                                           ; SOURCE LINE # 355
0222         ?C0048:
                                           ; SOURCE LINE # 357
0222 EF                MOV     A,R7
0223 6404              XRL     A,#04H
0225 6003              JZ      $ + 5H
0227 020000      R     LJMP    ?C0049
                                           ; SOURCE LINE # 361
022A E500        R     MOV     A,index
022C 25E0              ADD     A,ACC
022E 25E0              ADD     A,ACC
0230 2400        E     ADD     A,#LOW g_ref
0232 F582              MOV     DPL,A
0234 E4                CLR     A
0235 3400        E     ADDC    A,#HIGH g_ref
0237 F583              MOV     DPH,A
0239 E0                MOVX    A,@DPTR
023A FC                MOV     R4,A
023B A3                INC     DPTR
023C E0                MOVX    A,@DPTR
023D FD                MOV     R5,A
023E A3                INC     DPTR
023F E0                MOVX    A,@DPTR
0240 FE                MOV     R6,A
0241 A3                INC     DPTR
0242 E0                MOVX    A,@DPTR
0243 FF                MOV     R7,A
0244 900000      E     MOV     DPTR,#g_meas+08H
0247 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 33  

0248 F8                MOV     R0,A
0249 A3                INC     DPTR
024A E0                MOVX    A,@DPTR
024B F9                MOV     R1,A
024C A3                INC     DPTR
024D E0                MOVX    A,@DPTR
024E FA                MOV     R2,A
024F A3                INC     DPTR
0250 E0                MOVX    A,@DPTR
0251 FB                MOV     R3,A
0252 C3                CLR     C
0253 EF                MOV     A,R7
0254 9B                SUBB    A,R3
0255 FF                MOV     R7,A
0256 EE                MOV     A,R6
0257 9A                SUBB    A,R2
0258 FE                MOV     R6,A
0259 ED                MOV     A,R5
025A 99                SUBB    A,R1
025B FD                MOV     R5,A
025C EC                MOV     A,R4
025D 98                SUBB    A,R0
025E FC                MOV     R4,A
025F 120000      E     LCALL   ?C?LNEG
0262 E500        R     MOV     A,index
0264 25E0              ADD     A,ACC
0266 25E0              ADD     A,ACC
0268 2400        R     ADD     A,#LOW defl_input
026A F8                MOV     R0,A
026B 120000      E     LCALL   ?C?LSTIDATA
                                           ; SOURCE LINE # 362
026E E500        R     MOV     A,index
0270 25E0              ADD     A,ACC
0272 25E0              ADD     A,ACC
0274 2400        E     ADD     A,#LOW g_meas
0276 F582              MOV     DPL,A
0278 E4                CLR     A
0279 3400        E     ADDC    A,#HIGH g_meas
027B F583              MOV     DPH,A
027D E0                MOVX    A,@DPTR
027E F8                MOV     R0,A
027F A3                INC     DPTR
0280 E0                MOVX    A,@DPTR
0281 F9                MOV     R1,A
0282 A3                INC     DPTR
0283 E0                MOVX    A,@DPTR
0284 FA                MOV     R2,A
0285 A3                INC     DPTR
0286 E0                MOVX    A,@DPTR
0287 FB                MOV     R3,A
0288 C000              PUSH    AR0
028A E500        R     MOV     A,index
028C 25E0              ADD     A,ACC
028E 25E0              ADD     A,ACC
0290 2400        R     ADD     A,#LOW defl_input
0292 F8                MOV     R0,A
0293 120000      E     LCALL   ?C?LLDIDATA
0296 D000              POP     AR0
0298 C3                CLR     C
0299 EF                MOV     A,R7
029A 9B                SUBB    A,R3
029B F500        R     MOV     pos_error+03H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 34  

029D EE                MOV     A,R6
029E 9A                SUBB    A,R2
029F F500        R     MOV     pos_error+02H,A
02A1 ED                MOV     A,R5
02A2 99                SUBB    A,R1
02A3 F500        R     MOV     pos_error+01H,A
02A5 EC                MOV     A,R4
02A6 98                SUBB    A,R0
02A7 F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 363
02A9 8043              SJMP    ?C0050
02AB         ?C0049:
                                           ; SOURCE LINE # 366
02AB E500        R     MOV     A,index
02AD 25E0              ADD     A,ACC
02AF 25E0              ADD     A,ACC
02B1 2400        E     ADD     A,#LOW g_meas
02B3 F582              MOV     DPL,A
02B5 E4                CLR     A
02B6 3400        E     ADDC    A,#HIGH g_meas
02B8 F583              MOV     DPH,A
02BA E0                MOVX    A,@DPTR
02BB F8                MOV     R0,A
02BC A3                INC     DPTR
02BD E0                MOVX    A,@DPTR
02BE F9                MOV     R1,A
02BF A3                INC     DPTR
02C0 E0                MOVX    A,@DPTR
02C1 FA                MOV     R2,A
02C2 A3                INC     DPTR
02C3 E0                MOVX    A,@DPTR
02C4 FB                MOV     R3,A
02C5 E500        R     MOV     A,index
02C7 25E0              ADD     A,ACC
02C9 25E0              ADD     A,ACC
02CB 2400        E     ADD     A,#LOW g_ref
02CD F582              MOV     DPL,A
02CF E4                CLR     A
02D0 3400        E     ADDC    A,#HIGH g_ref
02D2 F583              MOV     DPH,A
02D4 E0                MOVX    A,@DPTR
02D5 FC                MOV     R4,A
02D6 A3                INC     DPTR
02D7 E0                MOVX    A,@DPTR
02D8 FD                MOV     R5,A
02D9 A3                INC     DPTR
02DA E0                MOVX    A,@DPTR
02DB FE                MOV     R6,A
02DC A3                INC     DPTR
02DD E0                MOVX    A,@DPTR
02DE C3                CLR     C
02DF 9B                SUBB    A,R3
02E0 F500        R     MOV     pos_error+03H,A
02E2 EE                MOV     A,R6
02E3 9A                SUBB    A,R2
02E4 F500        R     MOV     pos_error+02H,A
02E6 ED                MOV     A,R5
02E7 99                SUBB    A,R1
02E8 F500        R     MOV     pos_error+01H,A
02EA EC                MOV     A,R4
02EB 98                SUBB    A,R0
02EC F500        R     MOV     pos_error,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 35  

02EE         ?C0050:
                                           ; SOURCE LINE # 369
02EE E500        R     MOV     A,index
02F0 25E0              ADD     A,ACC
02F2 25E0              ADD     A,ACC
02F4 2400        R     ADD     A,#LOW pos_error_sum
02F6 F582              MOV     DPL,A
02F8 E4                CLR     A
02F9 3400        R     ADDC    A,#HIGH pos_error_sum
02FB F583              MOV     DPH,A
02FD C083              PUSH    DPH
02FF C082              PUSH    DPL
0301 E0                MOVX    A,@DPTR
0302 FC                MOV     R4,A
0303 A3                INC     DPTR
0304 E0                MOVX    A,@DPTR
0305 FD                MOV     R5,A
0306 A3                INC     DPTR
0307 E0                MOVX    A,@DPTR
0308 FE                MOV     R6,A
0309 A3                INC     DPTR
030A E0                MOVX    A,@DPTR
030B 2500        R     ADD     A,pos_error+03H
030D FF                MOV     R7,A
030E EE                MOV     A,R6
030F 3500        R     ADDC    A,pos_error+02H
0311 FE                MOV     R6,A
0312 ED                MOV     A,R5
0313 3500        R     ADDC    A,pos_error+01H
0315 FD                MOV     R5,A
0316 EC                MOV     A,R4
0317 3500        R     ADDC    A,pos_error
0319 FC                MOV     R4,A
031A D082              POP     DPL
031C D083              POP     DPH
031E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 371
0321 300005            JNB     interrupt_flag,?C0051
                                           ; SOURCE LINE # 372
0324 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 373
0326 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 374
0329         ?C0051:
                                           ; SOURCE LINE # 377
0329 E500        R     MOV     A,index
032B 25E0              ADD     A,ACC
032D 25E0              ADD     A,ACC
032F 2400        R     ADD     A,#LOW pos_error_sum
0331 F582              MOV     DPL,A
0333 E4                CLR     A
0334 3400        R     ADDC    A,#HIGH pos_error_sum
0336 F583              MOV     DPH,A
0338 E0                MOVX    A,@DPTR
0339 FC                MOV     R4,A
033A A3                INC     DPTR
033B E0                MOVX    A,@DPTR
033C FD                MOV     R5,A
033D A3                INC     DPTR
033E E0                MOVX    A,@DPTR
033F FE                MOV     R6,A
0340 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 36  

0341 E0                MOVX    A,@DPTR
0342 FF                MOV     R7,A
0343 7BA0              MOV     R3,#0A0H
0345 7A86              MOV     R2,#086H
0347 7901              MOV     R1,#01H
0349 7800              MOV     R0,#00H
034B C3                CLR     C
034C 120000      E     LCALL   ?C?SLCMP
034F 501C              JNC     ?C0052
                                           ; SOURCE LINE # 378
0351 7FA0              MOV     R7,#0A0H
0353 7E86              MOV     R6,#086H
0355 7D01              MOV     R5,#01H
0357 7C00              MOV     R4,#00H
0359 E500        R     MOV     A,index
035B 25E0              ADD     A,ACC
035D 25E0              ADD     A,ACC
035F 2400        R     ADD     A,#LOW pos_error_sum
0361 F582              MOV     DPL,A
0363 E4                CLR     A
0364 3400        R     ADDC    A,#HIGH pos_error_sum
0366 F583              MOV     DPH,A
0368 120000      E     LCALL   ?C?LSTXDATA
036B 8042              SJMP    ?C0053
036D         ?C0052:
                                           ; SOURCE LINE # 379
                                           ; SOURCE LINE # 380
036D E500        R     MOV     A,index
036F 25E0              ADD     A,ACC
0371 25E0              ADD     A,ACC
0373 2400        R     ADD     A,#LOW pos_error_sum
0375 F582              MOV     DPL,A
0377 E4                CLR     A
0378 3400        R     ADDC    A,#HIGH pos_error_sum
037A F583              MOV     DPH,A
037C E0                MOVX    A,@DPTR
037D FC                MOV     R4,A
037E A3                INC     DPTR
037F E0                MOVX    A,@DPTR
0380 FD                MOV     R5,A
0381 A3                INC     DPTR
0382 E0                MOVX    A,@DPTR
0383 FE                MOV     R6,A
0384 A3                INC     DPTR
0385 E0                MOVX    A,@DPTR
0386 FF                MOV     R7,A
0387 7B60              MOV     R3,#060H
0389 7A79              MOV     R2,#079H
038B 79FE              MOV     R1,#0FEH
038D 78FF              MOV     R0,#0FFH
038F D3                SETB    C
0390 120000      E     LCALL   ?C?SLCMP
0393 401A              JC      ?C0053
                                           ; SOURCE LINE # 381
0395 7F60              MOV     R7,#060H
0397 7E79              MOV     R6,#079H
0399 7DFE              MOV     R5,#0FEH
039B 7CFF              MOV     R4,#0FFH
039D E500        R     MOV     A,index
039F 25E0              ADD     A,ACC
03A1 25E0              ADD     A,ACC
03A3 2400        R     ADD     A,#LOW pos_error_sum
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 37  

03A5 F582              MOV     DPL,A
03A7 E4                CLR     A
03A8 3400        R     ADDC    A,#HIGH pos_error_sum
03AA F583              MOV     DPH,A
03AC 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 382
03AF         ?C0053:
                                           ; SOURCE LINE # 384
03AF 300005            JNB     interrupt_flag,?C0055
                                           ; SOURCE LINE # 385
03B2 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 386
03B4 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 387
03B7         ?C0055:
                                           ; SOURCE LINE # 389
03B7 E4                CLR     A
03B8 F500        R     MOV     pwm_input+03H,A
03BA F500        R     MOV     pwm_input+02H,A
03BC F500        R     MOV     pwm_input+01H,A
03BE F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 391
03C0 FF                MOV     R7,A
03C1 FE                MOV     R6,A
03C2 FD                MOV     R5,A
03C3 FC                MOV     R4,A
03C4 AB00        R     MOV     R3,k_p+03H
03C6 AA00        R     MOV     R2,k_p+02H
03C8 A900        R     MOV     R1,k_p+01H
03CA A800        R     MOV     R0,k_p
03CC C3                CLR     C
03CD 120000      E     LCALL   ?C?SLCMP
03D0 606A              JZ      ?C0056
                                           ; SOURCE LINE # 393
03D2 E4                CLR     A
03D3 FF                MOV     R7,A
03D4 FE                MOV     R6,A
03D5 7D02              MOV     R5,#02H
03D7 FC                MOV     R4,A
03D8 AB00        R     MOV     R3,pos_error+03H
03DA AA00        R     MOV     R2,pos_error+02H
03DC A900        R     MOV     R1,pos_error+01H
03DE A800        R     MOV     R0,pos_error
03E0 D3                SETB    C
03E1 120000      E     LCALL   ?C?SLCMP
03E4 500F              JNC     ?C0058
03E6 E4                CLR     A
03E7 FF                MOV     R7,A
03E8 FE                MOV     R6,A
03E9 7DFE              MOV     R5,#0FEH
03EB 7CFF              MOV     R4,#0FFH
03ED A800        R     MOV     R0,pos_error
03EF C3                CLR     C
03F0 120000      E     LCALL   ?C?SLCMP
03F3 5027              JNC     ?C0057
03F5         ?C0058:
                                           ; SOURCE LINE # 394
03F5 AF00        R     MOV     R7,pos_error+03H
03F7 AE00        R     MOV     R6,pos_error+02H
03F9 AD00        R     MOV     R5,pos_error+01H
03FB AC00        R     MOV     R4,pos_error
03FD 7808              MOV     R0,#08H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 38  

03FF 120000      E     LCALL   ?C?SLSHR
0402 AB00        R     MOV     R3,k_p+03H
0404 AA00        R     MOV     R2,k_p+02H
0406 A900        R     MOV     R1,k_p+01H
0408 A800        R     MOV     R0,k_p
040A 120000      E     LCALL   ?C?LMUL
040D 7808              MOV     R0,#08H
040F 120000      E     LCALL   ?C?SLSHR
0412 8F00        R     MOV     pwm_input+03H,R7
0414 8E00        R     MOV     pwm_input+02H,R6
0416 8D00        R     MOV     pwm_input+01H,R5
0418 8C00        R     MOV     pwm_input,R4
041A 8020              SJMP    ?C0056
041C         ?C0057:
                                           ; SOURCE LINE # 396
041C AF00        R     MOV     R7,pos_error+03H
041E AE00        R     MOV     R6,pos_error+02H
0420 AD00        R     MOV     R5,pos_error+01H
0422 AC00        R     MOV     R4,pos_error
0424 AB00        R     MOV     R3,k_p+03H
0426 AA00        R     MOV     R2,k_p+02H
0428 A900        R     MOV     R1,k_p+01H
042A A800        R     MOV     R0,k_p
042C 120000      E     LCALL   ?C?LMUL
042F 7810              MOV     R0,#010H
0431 120000      E     LCALL   ?C?SLSHR
0434 8F00        R     MOV     pwm_input+03H,R7
0436 8E00        R     MOV     pwm_input+02H,R6
0438 8D00        R     MOV     pwm_input+01H,R5
043A 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 397
043C         ?C0056:
                                           ; SOURCE LINE # 399
043C 300005            JNB     interrupt_flag,?C0060
                                           ; SOURCE LINE # 400
043F C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 401
0441 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 402
0444         ?C0060:
                                           ; SOURCE LINE # 405
0444 E4                CLR     A
0445 FF                MOV     R7,A
0446 FE                MOV     R6,A
0447 FD                MOV     R5,A
0448 FC                MOV     R4,A
0449 AB00        R     MOV     R3,k_i+03H
044B AA00        R     MOV     R2,k_i+02H
044D A900        R     MOV     R1,k_i+01H
044F A800        R     MOV     R0,k_i
0451 C3                CLR     C
0452 120000      E     LCALL   ?C?SLCMP
0455 6043              JZ      ?C0061
                                           ; SOURCE LINE # 406
0457 AF00        R     MOV     R7,k_i+03H
0459 AE00        R     MOV     R6,k_i+02H
045B AD00        R     MOV     R5,k_i+01H
045D AC00        R     MOV     R4,k_i
045F 7806              MOV     R0,#06H
0461 120000      E     LCALL   ?C?SLSHR
0464 E500        R     MOV     A,index
0466 25E0              ADD     A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 39  

0468 25E0              ADD     A,ACC
046A 2400        R     ADD     A,#LOW pos_error_sum
046C F582              MOV     DPL,A
046E E4                CLR     A
046F 3400        R     ADDC    A,#HIGH pos_error_sum
0471 F583              MOV     DPH,A
0473 E0                MOVX    A,@DPTR
0474 F8                MOV     R0,A
0475 A3                INC     DPTR
0476 E0                MOVX    A,@DPTR
0477 F9                MOV     R1,A
0478 A3                INC     DPTR
0479 E0                MOVX    A,@DPTR
047A FA                MOV     R2,A
047B A3                INC     DPTR
047C E0                MOVX    A,@DPTR
047D FB                MOV     R3,A
047E 120000      E     LCALL   ?C?LMUL
0481 780A              MOV     R0,#0AH
0483 120000      E     LCALL   ?C?SLSHR
0486 E500        R     MOV     A,pwm_input+03H
0488 2F                ADD     A,R7
0489 F500        R     MOV     pwm_input+03H,A
048B E500        R     MOV     A,pwm_input+02H
048D 3E                ADDC    A,R6
048E F500        R     MOV     pwm_input+02H,A
0490 E500        R     MOV     A,pwm_input+01H
0492 3D                ADDC    A,R5
0493 F500        R     MOV     pwm_input+01H,A
0495 E500        R     MOV     A,pwm_input
0497 3C                ADDC    A,R4
0498 F500        R     MOV     pwm_input,A
049A         ?C0061:
                                           ; SOURCE LINE # 409
049A E4                CLR     A
049B FF                MOV     R7,A
049C FE                MOV     R6,A
049D FD                MOV     R5,A
049E FC                MOV     R4,A
049F AB00        R     MOV     R3,k_d+03H
04A1 AA00        R     MOV     R2,k_d+02H
04A3 A900        R     MOV     R1,k_d+01H
04A5 A800        R     MOV     R0,k_d
04A7 C3                CLR     C
04A8 120000      E     LCALL   ?C?SLCMP
04AB 6063              JZ      ?C0062
                                           ; SOURCE LINE # 410
04AD E500        R     MOV     A,index
04AF 25E0              ADD     A,ACC
04B1 25E0              ADD     A,ACC
04B3 2400        E     ADD     A,#LOW g_meas
04B5 F582              MOV     DPL,A
04B7 E4                CLR     A
04B8 3400        E     ADDC    A,#HIGH g_meas
04BA F583              MOV     DPH,A
04BC E0                MOVX    A,@DPTR
04BD F8                MOV     R0,A
04BE A3                INC     DPTR
04BF E0                MOVX    A,@DPTR
04C0 F9                MOV     R1,A
04C1 A3                INC     DPTR
04C2 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 40  

04C3 FA                MOV     R2,A
04C4 A3                INC     DPTR
04C5 E0                MOVX    A,@DPTR
04C6 FB                MOV     R3,A
04C7 E500        R     MOV     A,index
04C9 25E0              ADD     A,ACC
04CB 25E0              ADD     A,ACC
04CD 2400        E     ADD     A,#LOW g_measOld
04CF F582              MOV     DPL,A
04D1 E4                CLR     A
04D2 3400        E     ADDC    A,#HIGH g_measOld
04D4 F583              MOV     DPH,A
04D6 E0                MOVX    A,@DPTR
04D7 FC                MOV     R4,A
04D8 A3                INC     DPTR
04D9 E0                MOVX    A,@DPTR
04DA FD                MOV     R5,A
04DB A3                INC     DPTR
04DC E0                MOVX    A,@DPTR
04DD FE                MOV     R6,A
04DE A3                INC     DPTR
04DF E0                MOVX    A,@DPTR
04E0 C3                CLR     C
04E1 9B                SUBB    A,R3
04E2 FF                MOV     R7,A
04E3 EE                MOV     A,R6
04E4 9A                SUBB    A,R2
04E5 FE                MOV     R6,A
04E6 ED                MOV     A,R5
04E7 99                SUBB    A,R1
04E8 FD                MOV     R5,A
04E9 EC                MOV     A,R4
04EA 98                SUBB    A,R0
04EB FC                MOV     R4,A
04EC AB00        R     MOV     R3,k_d+03H
04EE AA00        R     MOV     R2,k_d+02H
04F0 A900        R     MOV     R1,k_d+01H
04F2 A800        R     MOV     R0,k_d
04F4 120000      E     LCALL   ?C?LMUL
04F7 7810              MOV     R0,#010H
04F9 120000      E     LCALL   ?C?SLSHR
04FC E500        R     MOV     A,pwm_input+03H
04FE 2F                ADD     A,R7
04FF F500        R     MOV     pwm_input+03H,A
0501 E500        R     MOV     A,pwm_input+02H
0503 3E                ADDC    A,R6
0504 F500        R     MOV     pwm_input+02H,A
0506 E500        R     MOV     A,pwm_input+01H
0508 3D                ADDC    A,R5
0509 F500        R     MOV     pwm_input+01H,A
050B E500        R     MOV     A,pwm_input
050D 3C                ADDC    A,R4
050E F500        R     MOV     pwm_input,A
0510         ?C0062:
                                           ; SOURCE LINE # 413
0510 300005            JNB     interrupt_flag,?C0063
                                           ; SOURCE LINE # 414
0513 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 415
0515 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 416
0518         ?C0063:
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 41  

                                           ; SOURCE LINE # 418
0518 E500        R     MOV     A,index
051A 701C              JNZ     ?C0064
                                           ; SOURCE LINE # 419
051C FF                MOV     R7,A
051D FE                MOV     R6,A
051E FD                MOV     R5,A
051F FC                MOV     R4,A
0520 AB00        R     MOV     R3,pwm_input+03H
0522 AA00        R     MOV     R2,pwm_input+02H
0524 A900        R     MOV     R1,pwm_input+01H
0526 A800        R     MOV     R0,pwm_input
0528 C3                CLR     C
0529 120000      E     LCALL   ?C?SLCMP
052C 4005              JC      ?C0065
                                           ; SOURCE LINE # 420
052E D200        R     SETB    dirM0
0530 020000      R     LJMP    ?C0046
0533         ?C0065:
                                           ; SOURCE LINE # 423
0533 C200        R     CLR     dirM0
                                           ; SOURCE LINE # 425
0535 020000      R     LJMP    ?C0046
0538         ?C0064:
                                           ; SOURCE LINE # 426
0538 E4                CLR     A
0539 FF                MOV     R7,A
053A FE                MOV     R6,A
053B FD                MOV     R5,A
053C FC                MOV     R4,A
053D AB00        R     MOV     R3,pwm_input+03H
053F AA00        R     MOV     R2,pwm_input+02H
0541 A900        R     MOV     R1,pwm_input+01H
0543 A800        R     MOV     R0,pwm_input
0545 C3                CLR     C
0546 120000      E     LCALL   ?C?SLCMP
0549 4005              JC      ?C0068
                                           ; SOURCE LINE # 427
054B D200        R     SETB    dirM1
054D 020000      R     LJMP    ?C0046
0550         ?C0068:
                                           ; SOURCE LINE # 430
0550 C200        R     CLR     dirM1
                                           ; SOURCE LINE # 432
                                           ; SOURCE LINE # 434
0552 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 436
                                           ; SOURCE LINE # 437
0555         ?C0071:
                                           ; SOURCE LINE # 439
0555 900000      E     MOV     DPTR,#c_mem+036H
0558 E0                MOVX    A,@DPTR
0559 6405              XRL     A,#05H
055B 6003              JZ      $ + 5H
055D 020000      R     LJMP    ?C0072
                                           ; SOURCE LINE # 443
0560 E500        R     MOV     A,index
0562 25E0              ADD     A,ACC
0564 25E0              ADD     A,ACC
0566 2400        E     ADD     A,#LOW g_ref
0568 F582              MOV     DPL,A
056A E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 42  

056B 3400        E     ADDC    A,#HIGH g_ref
056D F583              MOV     DPH,A
056F E0                MOVX    A,@DPTR
0570 FC                MOV     R4,A
0571 A3                INC     DPTR
0572 E0                MOVX    A,@DPTR
0573 FD                MOV     R5,A
0574 A3                INC     DPTR
0575 E0                MOVX    A,@DPTR
0576 FE                MOV     R6,A
0577 A3                INC     DPTR
0578 E0                MOVX    A,@DPTR
0579 FF                MOV     R7,A
057A 900000      E     MOV     DPTR,#g_meas+08H
057D E0                MOVX    A,@DPTR
057E F8                MOV     R0,A
057F A3                INC     DPTR
0580 E0                MOVX    A,@DPTR
0581 F9                MOV     R1,A
0582 A3                INC     DPTR
0583 E0                MOVX    A,@DPTR
0584 FA                MOV     R2,A
0585 A3                INC     DPTR
0586 E0                MOVX    A,@DPTR
0587 FB                MOV     R3,A
0588 C3                CLR     C
0589 EF                MOV     A,R7
058A 9B                SUBB    A,R3
058B FF                MOV     R7,A
058C EE                MOV     A,R6
058D 9A                SUBB    A,R2
058E FE                MOV     R6,A
058F ED                MOV     A,R5
0590 99                SUBB    A,R1
0591 FD                MOV     R5,A
0592 EC                MOV     A,R4
0593 98                SUBB    A,R0
0594 FC                MOV     R4,A
0595 120000      E     LCALL   ?C?LNEG
0598 E500        R     MOV     A,index
059A 25E0              ADD     A,ACC
059C 25E0              ADD     A,ACC
059E 2400        R     ADD     A,#LOW defl_input
05A0 F8                MOV     R0,A
05A1 120000      E     LCALL   ?C?LSTIDATA
                                           ; SOURCE LINE # 444
05A4 E500        R     MOV     A,index
05A6 25E0              ADD     A,ACC
05A8 25E0              ADD     A,ACC
05AA 2400        E     ADD     A,#LOW g_meas
05AC F582              MOV     DPL,A
05AE E4                CLR     A
05AF 3400        E     ADDC    A,#HIGH g_meas
05B1 F583              MOV     DPH,A
05B3 E0                MOVX    A,@DPTR
05B4 F8                MOV     R0,A
05B5 A3                INC     DPTR
05B6 E0                MOVX    A,@DPTR
05B7 F9                MOV     R1,A
05B8 A3                INC     DPTR
05B9 E0                MOVX    A,@DPTR
05BA FA                MOV     R2,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 43  

05BB A3                INC     DPTR
05BC E0                MOVX    A,@DPTR
05BD FB                MOV     R3,A
05BE C000              PUSH    AR0
05C0 E500        R     MOV     A,index
05C2 25E0              ADD     A,ACC
05C4 25E0              ADD     A,ACC
05C6 2400        R     ADD     A,#LOW defl_input
05C8 F8                MOV     R0,A
05C9 120000      E     LCALL   ?C?LLDIDATA
05CC D000              POP     AR0
05CE C3                CLR     C
05CF EF                MOV     A,R7
05D0 9B                SUBB    A,R3
05D1 F500        R     MOV     pos_error+03H,A
05D3 EE                MOV     A,R6
05D4 9A                SUBB    A,R2
05D5 F500        R     MOV     pos_error+02H,A
05D7 ED                MOV     A,R5
05D8 99                SUBB    A,R1
05D9 F500        R     MOV     pos_error+01H,A
05DB EC                MOV     A,R4
05DC 98                SUBB    A,R0
05DD F500        R     MOV     pos_error,A
                                           ; SOURCE LINE # 445
05DF 8043              SJMP    ?C0073
05E1         ?C0072:
                                           ; SOURCE LINE # 447
05E1 E500        R     MOV     A,index
05E3 25E0              ADD     A,ACC
05E5 25E0              ADD     A,ACC
05E7 2400        E     ADD     A,#LOW g_meas
05E9 F582              MOV     DPL,A
05EB E4                CLR     A
05EC 3400        E     ADDC    A,#HIGH g_meas
05EE F583              MOV     DPH,A
05F0 E0                MOVX    A,@DPTR
05F1 F8                MOV     R0,A
05F2 A3                INC     DPTR
05F3 E0                MOVX    A,@DPTR
05F4 F9                MOV     R1,A
05F5 A3                INC     DPTR
05F6 E0                MOVX    A,@DPTR
05F7 FA                MOV     R2,A
05F8 A3                INC     DPTR
05F9 E0                MOVX    A,@DPTR
05FA FB                MOV     R3,A
05FB E500        R     MOV     A,index
05FD 25E0              ADD     A,ACC
05FF 25E0              ADD     A,ACC
0601 2400        E     ADD     A,#LOW g_ref
0603 F582              MOV     DPL,A
0605 E4                CLR     A
0606 3400        E     ADDC    A,#HIGH g_ref
0608 F583              MOV     DPH,A
060A E0                MOVX    A,@DPTR
060B FC                MOV     R4,A
060C A3                INC     DPTR
060D E0                MOVX    A,@DPTR
060E FD                MOV     R5,A
060F A3                INC     DPTR
0610 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 44  

0611 FE                MOV     R6,A
0612 A3                INC     DPTR
0613 E0                MOVX    A,@DPTR
0614 C3                CLR     C
0615 9B                SUBB    A,R3
0616 F500        R     MOV     pos_error+03H,A
0618 EE                MOV     A,R6
0619 9A                SUBB    A,R2
061A F500        R     MOV     pos_error+02H,A
061C ED                MOV     A,R5
061D 99                SUBB    A,R1
061E F500        R     MOV     pos_error+01H,A
0620 EC                MOV     A,R4
0621 98                SUBB    A,R0
0622 F500        R     MOV     pos_error,A
0624         ?C0073:
                                           ; SOURCE LINE # 449
0624 300005            JNB     interrupt_flag,?C0074
                                           ; SOURCE LINE # 450
0627 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 451
0629 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 452
062C         ?C0074:
                                           ; SOURCE LINE # 454
062C E500        R     MOV     A,index
062E 25E0              ADD     A,ACC
0630 25E0              ADD     A,ACC
0632 2400        R     ADD     A,#LOW pos_error_sum
0634 F582              MOV     DPL,A
0636 E4                CLR     A
0637 3400        R     ADDC    A,#HIGH pos_error_sum
0639 F583              MOV     DPH,A
063B C083              PUSH    DPH
063D C082              PUSH    DPL
063F E0                MOVX    A,@DPTR
0640 FC                MOV     R4,A
0641 A3                INC     DPTR
0642 E0                MOVX    A,@DPTR
0643 FD                MOV     R5,A
0644 A3                INC     DPTR
0645 E0                MOVX    A,@DPTR
0646 FE                MOV     R6,A
0647 A3                INC     DPTR
0648 E0                MOVX    A,@DPTR
0649 2500        R     ADD     A,pos_error+03H
064B FF                MOV     R7,A
064C EE                MOV     A,R6
064D 3500        R     ADDC    A,pos_error+02H
064F FE                MOV     R6,A
0650 ED                MOV     A,R5
0651 3500        R     ADDC    A,pos_error+01H
0653 FD                MOV     R5,A
0654 EC                MOV     A,R4
0655 3500        R     ADDC    A,pos_error
0657 FC                MOV     R4,A
0658 D082              POP     DPL
065A D083              POP     DPH
065C 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 456
065F E500        R     MOV     A,index
0661 25E0              ADD     A,ACC
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 45  

0663 25E0              ADD     A,ACC
0665 2400        R     ADD     A,#LOW pos_error_sum
0667 F582              MOV     DPL,A
0669 E4                CLR     A
066A 3400        R     ADDC    A,#HIGH pos_error_sum
066C F583              MOV     DPH,A
066E E0                MOVX    A,@DPTR
066F FC                MOV     R4,A
0670 A3                INC     DPTR
0671 E0                MOVX    A,@DPTR
0672 FD                MOV     R5,A
0673 A3                INC     DPTR
0674 E0                MOVX    A,@DPTR
0675 FE                MOV     R6,A
0676 A3                INC     DPTR
0677 E0                MOVX    A,@DPTR
0678 FF                MOV     R7,A
0679 7BA0              MOV     R3,#0A0H
067B 7A86              MOV     R2,#086H
067D 7901              MOV     R1,#01H
067F 7800              MOV     R0,#00H
0681 C3                CLR     C
0682 120000      E     LCALL   ?C?SLCMP
0685 501C              JNC     ?C0075
                                           ; SOURCE LINE # 457
0687 7FA0              MOV     R7,#0A0H
0689 7E86              MOV     R6,#086H
068B 7D01              MOV     R5,#01H
068D 7C00              MOV     R4,#00H
068F E500        R     MOV     A,index
0691 25E0              ADD     A,ACC
0693 25E0              ADD     A,ACC
0695 2400        R     ADD     A,#LOW pos_error_sum
0697 F582              MOV     DPL,A
0699 E4                CLR     A
069A 3400        R     ADDC    A,#HIGH pos_error_sum
069C F583              MOV     DPH,A
069E 120000      E     LCALL   ?C?LSTXDATA
06A1 8042              SJMP    ?C0076
06A3         ?C0075:
                                           ; SOURCE LINE # 458
                                           ; SOURCE LINE # 459
06A3 E500        R     MOV     A,index
06A5 25E0              ADD     A,ACC
06A7 25E0              ADD     A,ACC
06A9 2400        R     ADD     A,#LOW pos_error_sum
06AB F582              MOV     DPL,A
06AD E4                CLR     A
06AE 3400        R     ADDC    A,#HIGH pos_error_sum
06B0 F583              MOV     DPH,A
06B2 E0                MOVX    A,@DPTR
06B3 FC                MOV     R4,A
06B4 A3                INC     DPTR
06B5 E0                MOVX    A,@DPTR
06B6 FD                MOV     R5,A
06B7 A3                INC     DPTR
06B8 E0                MOVX    A,@DPTR
06B9 FE                MOV     R6,A
06BA A3                INC     DPTR
06BB E0                MOVX    A,@DPTR
06BC FF                MOV     R7,A
06BD 7B60              MOV     R3,#060H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 46  

06BF 7A79              MOV     R2,#079H
06C1 79FE              MOV     R1,#0FEH
06C3 78FF              MOV     R0,#0FFH
06C5 D3                SETB    C
06C6 120000      E     LCALL   ?C?SLCMP
06C9 401A              JC      ?C0076
                                           ; SOURCE LINE # 460
06CB 7F60              MOV     R7,#060H
06CD 7E79              MOV     R6,#079H
06CF 7DFE              MOV     R5,#0FEH
06D1 7CFF              MOV     R4,#0FFH
06D3 E500        R     MOV     A,index
06D5 25E0              ADD     A,ACC
06D7 25E0              ADD     A,ACC
06D9 2400        R     ADD     A,#LOW pos_error_sum
06DB F582              MOV     DPL,A
06DD E4                CLR     A
06DE 3400        R     ADDC    A,#HIGH pos_error_sum
06E0 F583              MOV     DPH,A
06E2 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 461
06E5         ?C0076:
                                           ; SOURCE LINE # 465
06E5 E4                CLR     A
06E6 F500        R     MOV     curr_ref+03H,A
06E8 F500        R     MOV     curr_ref+02H,A
06EA F500        R     MOV     curr_ref+01H,A
06EC F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 468
06EE FF                MOV     R7,A
06EF FE                MOV     R6,A
06F0 FD                MOV     R5,A
06F1 FC                MOV     R4,A
06F2 AB00        R     MOV     R3,k_p_dl+03H
06F4 AA00        R     MOV     R2,k_p_dl+02H
06F6 A900        R     MOV     R1,k_p_dl+01H
06F8 A800        R     MOV     R0,k_p_dl
06FA C3                CLR     C
06FB 120000      E     LCALL   ?C?SLCMP
06FE 7003              JNZ     $ + 5H
0700 020000      R     LJMP    ?C0078
                                           ; SOURCE LINE # 469
0703 E4                CLR     A
0704 FF                MOV     R7,A
0705 FE                MOV     R6,A
0706 7D02              MOV     R5,#02H
0708 FC                MOV     R4,A
0709 AB00        R     MOV     R3,pos_error+03H
070B AA00        R     MOV     R2,pos_error+02H
070D A900        R     MOV     R1,pos_error+01H
070F A800        R     MOV     R0,pos_error
0711 D3                SETB    C
0712 120000      E     LCALL   ?C?SLCMP
0715 500F              JNC     ?C0080
0717 E4                CLR     A
0718 FF                MOV     R7,A
0719 FE                MOV     R6,A
071A 7DFE              MOV     R5,#0FEH
071C 7CFF              MOV     R4,#0FFH
071E A800        R     MOV     R0,pos_error
0720 C3                CLR     C
0721 120000      E     LCALL   ?C?SLCMP
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 47  

0724 5033              JNC     ?C0079
0726         ?C0080:
                                           ; SOURCE LINE # 470
0726 AF00        R     MOV     R7,pos_error+03H
0728 AE00        R     MOV     R6,pos_error+02H
072A AD00        R     MOV     R5,pos_error+01H
072C AC00        R     MOV     R4,pos_error
072E 7808              MOV     R0,#08H
0730 120000      E     LCALL   ?C?SLSHR
0733 AB00        R     MOV     R3,k_p_dl+03H
0735 AA00        R     MOV     R2,k_p_dl+02H
0737 A900        R     MOV     R1,k_p_dl+01H
0739 A800        R     MOV     R0,k_p_dl
073B 120000      E     LCALL   ?C?LMUL
073E 7808              MOV     R0,#08H
0740 120000      E     LCALL   ?C?SLSHR
0743 E500        R     MOV     A,curr_ref+03H
0745 2F                ADD     A,R7
0746 F500        R     MOV     curr_ref+03H,A
0748 E500        R     MOV     A,curr_ref+02H
074A 3E                ADDC    A,R6
074B F500        R     MOV     curr_ref+02H,A
074D E500        R     MOV     A,curr_ref+01H
074F 3D                ADDC    A,R5
0750 F500        R     MOV     curr_ref+01H,A
0752 E500        R     MOV     A,curr_ref
0754 3C                ADDC    A,R4
0755 F500        R     MOV     curr_ref,A
0757 802C              SJMP    ?C0078
0759         ?C0079:
                                           ; SOURCE LINE # 472
0759 AF00        R     MOV     R7,pos_error+03H
075B AE00        R     MOV     R6,pos_error+02H
075D AD00        R     MOV     R5,pos_error+01H
075F AC00        R     MOV     R4,pos_error
0761 AB00        R     MOV     R3,k_p_dl+03H
0763 AA00        R     MOV     R2,k_p_dl+02H
0765 A900        R     MOV     R1,k_p_dl+01H
0767 A800        R     MOV     R0,k_p_dl
0769 120000      E     LCALL   ?C?LMUL
076C 7810              MOV     R0,#010H
076E 120000      E     LCALL   ?C?SLSHR
0771 E500        R     MOV     A,curr_ref+03H
0773 2F                ADD     A,R7
0774 F500        R     MOV     curr_ref+03H,A
0776 E500        R     MOV     A,curr_ref+02H
0778 3E                ADDC    A,R6
0779 F500        R     MOV     curr_ref+02H,A
077B E500        R     MOV     A,curr_ref+01H
077D 3D                ADDC    A,R5
077E F500        R     MOV     curr_ref+01H,A
0780 E500        R     MOV     A,curr_ref
0782 3C                ADDC    A,R4
0783 F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 473
0785         ?C0078:
                                           ; SOURCE LINE # 476
0785 E4                CLR     A
0786 FF                MOV     R7,A
0787 FE                MOV     R6,A
0788 FD                MOV     R5,A
0789 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 48  

078A AB00        R     MOV     R3,k_i_dl+03H
078C AA00        R     MOV     R2,k_i_dl+02H
078E A900        R     MOV     R1,k_i_dl+01H
0790 A800        R     MOV     R0,k_i_dl
0792 C3                CLR     C
0793 120000      E     LCALL   ?C?SLCMP
0796 6038              JZ      ?C0082
                                           ; SOURCE LINE # 477
0798 E500        R     MOV     A,index
079A 25E0              ADD     A,ACC
079C 25E0              ADD     A,ACC
079E 2400        R     ADD     A,#LOW pos_error_sum
07A0 F582              MOV     DPL,A
07A2 E4                CLR     A
07A3 3400        R     ADDC    A,#HIGH pos_error_sum
07A5 F583              MOV     DPH,A
07A7 E0                MOVX    A,@DPTR
07A8 FC                MOV     R4,A
07A9 A3                INC     DPTR
07AA E0                MOVX    A,@DPTR
07AB FD                MOV     R5,A
07AC A3                INC     DPTR
07AD E0                MOVX    A,@DPTR
07AE FE                MOV     R6,A
07AF A3                INC     DPTR
07B0 E0                MOVX    A,@DPTR
07B1 FF                MOV     R7,A
07B2 A800        R     MOV     R0,k_i_dl
07B4 120000      E     LCALL   ?C?LMUL
07B7 7810              MOV     R0,#010H
07B9 120000      E     LCALL   ?C?SLSHR
07BC E500        R     MOV     A,curr_ref+03H
07BE 2F                ADD     A,R7
07BF F500        R     MOV     curr_ref+03H,A
07C1 E500        R     MOV     A,curr_ref+02H
07C3 3E                ADDC    A,R6
07C4 F500        R     MOV     curr_ref+02H,A
07C6 E500        R     MOV     A,curr_ref+01H
07C8 3D                ADDC    A,R5
07C9 F500        R     MOV     curr_ref+01H,A
07CB E500        R     MOV     A,curr_ref
07CD 3C                ADDC    A,R4
07CE F500        R     MOV     curr_ref,A
07D0         ?C0082:
                                           ; SOURCE LINE # 480
07D0 E4                CLR     A
07D1 FF                MOV     R7,A
07D2 FE                MOV     R6,A
07D3 FD                MOV     R5,A
07D4 FC                MOV     R4,A
07D5 AB00        R     MOV     R3,k_d_dl+03H
07D7 AA00        R     MOV     R2,k_d_dl+02H
07D9 A900        R     MOV     R1,k_d_dl+01H
07DB A800        R     MOV     R0,k_d_dl
07DD C3                CLR     C
07DE 120000      E     LCALL   ?C?SLCMP
07E1 6063              JZ      ?C0083
                                           ; SOURCE LINE # 481
07E3 E500        R     MOV     A,index
07E5 25E0              ADD     A,ACC
07E7 25E0              ADD     A,ACC
07E9 2400        E     ADD     A,#LOW g_meas
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 49  

07EB F582              MOV     DPL,A
07ED E4                CLR     A
07EE 3400        E     ADDC    A,#HIGH g_meas
07F0 F583              MOV     DPH,A
07F2 E0                MOVX    A,@DPTR
07F3 F8                MOV     R0,A
07F4 A3                INC     DPTR
07F5 E0                MOVX    A,@DPTR
07F6 F9                MOV     R1,A
07F7 A3                INC     DPTR
07F8 E0                MOVX    A,@DPTR
07F9 FA                MOV     R2,A
07FA A3                INC     DPTR
07FB E0                MOVX    A,@DPTR
07FC FB                MOV     R3,A
07FD E500        R     MOV     A,index
07FF 25E0              ADD     A,ACC
0801 25E0              ADD     A,ACC
0803 2400        E     ADD     A,#LOW g_measOld
0805 F582              MOV     DPL,A
0807 E4                CLR     A
0808 3400        E     ADDC    A,#HIGH g_measOld
080A F583              MOV     DPH,A
080C E0                MOVX    A,@DPTR
080D FC                MOV     R4,A
080E A3                INC     DPTR
080F E0                MOVX    A,@DPTR
0810 FD                MOV     R5,A
0811 A3                INC     DPTR
0812 E0                MOVX    A,@DPTR
0813 FE                MOV     R6,A
0814 A3                INC     DPTR
0815 E0                MOVX    A,@DPTR
0816 C3                CLR     C
0817 9B                SUBB    A,R3
0818 FF                MOV     R7,A
0819 EE                MOV     A,R6
081A 9A                SUBB    A,R2
081B FE                MOV     R6,A
081C ED                MOV     A,R5
081D 99                SUBB    A,R1
081E FD                MOV     R5,A
081F EC                MOV     A,R4
0820 98                SUBB    A,R0
0821 FC                MOV     R4,A
0822 AB00        R     MOV     R3,k_d_dl+03H
0824 AA00        R     MOV     R2,k_d_dl+02H
0826 A900        R     MOV     R1,k_d_dl+01H
0828 A800        R     MOV     R0,k_d_dl
082A 120000      E     LCALL   ?C?LMUL
082D 7810              MOV     R0,#010H
082F 120000      E     LCALL   ?C?SLSHR
0832 E500        R     MOV     A,curr_ref+03H
0834 2F                ADD     A,R7
0835 F500        R     MOV     curr_ref+03H,A
0837 E500        R     MOV     A,curr_ref+02H
0839 3E                ADDC    A,R6
083A F500        R     MOV     curr_ref+02H,A
083C E500        R     MOV     A,curr_ref+01H
083E 3D                ADDC    A,R5
083F F500        R     MOV     curr_ref+01H,A
0841 E500        R     MOV     A,curr_ref
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 50  

0843 3C                ADDC    A,R4
0844 F500        R     MOV     curr_ref,A
0846         ?C0083:
                                           ; SOURCE LINE # 483
0846 300005            JNB     interrupt_flag,?C0084
                                           ; SOURCE LINE # 484
0849 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 485
084B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 486
084E         ?C0084:
                                           ; SOURCE LINE # 489
084E 900000      E     MOV     DPTR,#c_mem+032H
0851 E0                MOVX    A,@DPTR
0852 FE                MOV     R6,A
0853 A3                INC     DPTR
0854 E0                MOVX    A,@DPTR
0855 FF                MOV     R7,A
0856 EE                MOV     A,R6
0857 33                RLC     A
0858 95E0              SUBB    A,ACC
085A FD                MOV     R5,A
085B FC                MOV     R4,A
085C AB00        R     MOV     R3,curr_ref+03H
085E AA00        R     MOV     R2,curr_ref+02H
0860 A900        R     MOV     R1,curr_ref+01H
0862 A800        R     MOV     R0,curr_ref
0864 D3                SETB    C
0865 120000      E     LCALL   ?C?SLCMP
0868 4016              JC      ?C0085
                                           ; SOURCE LINE # 490
086A 900000      E     MOV     DPTR,#c_mem+032H
086D E0                MOVX    A,@DPTR
086E FE                MOV     R6,A
086F A3                INC     DPTR
0870 E0                MOVX    A,@DPTR
0871 FF                MOV     R7,A
0872 EE                MOV     A,R6
0873 33                RLC     A
0874 95E0              SUBB    A,ACC
0876 8F00        R     MOV     curr_ref+03H,R7
0878 8E00        R     MOV     curr_ref+02H,R6
087A F500        R     MOV     curr_ref+01H,A
087C F500        R     MOV     curr_ref,A
087E 803C              SJMP    ?C0086
0880         ?C0085:
                                           ; SOURCE LINE # 491
                                           ; SOURCE LINE # 492
0880 900000      E     MOV     DPTR,#c_mem+032H
0883 E0                MOVX    A,@DPTR
0884 FE                MOV     R6,A
0885 A3                INC     DPTR
0886 E0                MOVX    A,@DPTR
0887 FF                MOV     R7,A
0888 C3                CLR     C
0889 E4                CLR     A
088A 9F                SUBB    A,R7
088B FF                MOV     R7,A
088C E4                CLR     A
088D 9E                SUBB    A,R6
088E FE                MOV     R6,A
088F 33                RLC     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 51  

0890 95E0              SUBB    A,ACC
0892 FD                MOV     R5,A
0893 FC                MOV     R4,A
0894 AB00        R     MOV     R3,curr_ref+03H
0896 AA00        R     MOV     R2,curr_ref+02H
0898 A900        R     MOV     R1,curr_ref+01H
089A A800        R     MOV     R0,curr_ref
089C C3                CLR     C
089D 120000      E     LCALL   ?C?SLCMP
08A0 501A              JNC     ?C0086
                                           ; SOURCE LINE # 493
08A2 900000      E     MOV     DPTR,#c_mem+032H
08A5 E0                MOVX    A,@DPTR
08A6 FE                MOV     R6,A
08A7 A3                INC     DPTR
08A8 E0                MOVX    A,@DPTR
08A9 FF                MOV     R7,A
08AA C3                CLR     C
08AB E4                CLR     A
08AC 9F                SUBB    A,R7
08AD FF                MOV     R7,A
08AE E4                CLR     A
08AF 9E                SUBB    A,R6
08B0 FE                MOV     R6,A
08B1 33                RLC     A
08B2 95E0              SUBB    A,ACC
08B4 8F00        R     MOV     curr_ref+03H,R7
08B6 8E00        R     MOV     curr_ref+02H,R6
08B8 F500        R     MOV     curr_ref+01H,A
08BA F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 494
08BC         ?C0086:
                                           ; SOURCE LINE # 497
08BC E500        R     MOV     A,index
08BE 25E0              ADD     A,ACC
08C0 25E0              ADD     A,ACC
08C2 2400        E     ADD     A,#LOW g_meas+0CH
08C4 F582              MOV     DPL,A
08C6 E4                CLR     A
08C7 3400        E     ADDC    A,#HIGH g_meas+0CH
08C9 F583              MOV     DPH,A
08CB E0                MOVX    A,@DPTR
08CC F8                MOV     R0,A
08CD A3                INC     DPTR
08CE E0                MOVX    A,@DPTR
08CF F9                MOV     R1,A
08D0 A3                INC     DPTR
08D1 E0                MOVX    A,@DPTR
08D2 FA                MOV     R2,A
08D3 A3                INC     DPTR
08D4 E0                MOVX    A,@DPTR
08D5 FB                MOV     R3,A
08D6 C3                CLR     C
08D7 E500        R     MOV     A,curr_ref+03H
08D9 9B                SUBB    A,R3
08DA F500        R     MOV     curr_error+03H,A
08DC E500        R     MOV     A,curr_ref+02H
08DE 9A                SUBB    A,R2
08DF F500        R     MOV     curr_error+02H,A
08E1 E500        R     MOV     A,curr_ref+01H
08E3 99                SUBB    A,R1
08E4 F500        R     MOV     curr_error+01H,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 52  

08E6 E500        R     MOV     A,curr_ref
08E8 98                SUBB    A,R0
08E9 F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 498
08EB E500        R     MOV     A,index
08ED 25E0              ADD     A,ACC
08EF 25E0              ADD     A,ACC
08F1 2400        R     ADD     A,#LOW curr_error_sum
08F3 F582              MOV     DPL,A
08F5 E4                CLR     A
08F6 3400        R     ADDC    A,#HIGH curr_error_sum
08F8 F583              MOV     DPH,A
08FA C083              PUSH    DPH
08FC C082              PUSH    DPL
08FE E0                MOVX    A,@DPTR
08FF FC                MOV     R4,A
0900 A3                INC     DPTR
0901 E0                MOVX    A,@DPTR
0902 FD                MOV     R5,A
0903 A3                INC     DPTR
0904 E0                MOVX    A,@DPTR
0905 FE                MOV     R6,A
0906 A3                INC     DPTR
0907 E0                MOVX    A,@DPTR
0908 2500        R     ADD     A,curr_error+03H
090A FF                MOV     R7,A
090B EE                MOV     A,R6
090C 3500        R     ADDC    A,curr_error+02H
090E FE                MOV     R6,A
090F ED                MOV     A,R5
0910 3500        R     ADDC    A,curr_error+01H
0912 FD                MOV     R5,A
0913 EC                MOV     A,R4
0914 3500        R     ADDC    A,curr_error
0916 FC                MOV     R4,A
0917 D082              POP     DPL
0919 D083              POP     DPH
091B 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 500
091E E500        R     MOV     A,index
0920 25E0              ADD     A,ACC
0922 25E0              ADD     A,ACC
0924 2400        R     ADD     A,#LOW curr_error_sum
0926 F582              MOV     DPL,A
0928 E4                CLR     A
0929 3400        R     ADDC    A,#HIGH curr_error_sum
092B F583              MOV     DPH,A
092D E0                MOVX    A,@DPTR
092E FC                MOV     R4,A
092F A3                INC     DPTR
0930 E0                MOVX    A,@DPTR
0931 FD                MOV     R5,A
0932 A3                INC     DPTR
0933 E0                MOVX    A,@DPTR
0934 FE                MOV     R6,A
0935 A3                INC     DPTR
0936 E0                MOVX    A,@DPTR
0937 FF                MOV     R7,A
0938 7BA0              MOV     R3,#0A0H
093A 7A86              MOV     R2,#086H
093C 7901              MOV     R1,#01H
093E 7800              MOV     R0,#00H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 53  

0940 C3                CLR     C
0941 120000      E     LCALL   ?C?SLCMP
0944 501C              JNC     ?C0088
                                           ; SOURCE LINE # 501
0946 7FA0              MOV     R7,#0A0H
0948 7E86              MOV     R6,#086H
094A 7D01              MOV     R5,#01H
094C 7C00              MOV     R4,#00H
094E E500        R     MOV     A,index
0950 25E0              ADD     A,ACC
0952 25E0              ADD     A,ACC
0954 2400        R     ADD     A,#LOW curr_error_sum
0956 F582              MOV     DPL,A
0958 E4                CLR     A
0959 3400        R     ADDC    A,#HIGH curr_error_sum
095B F583              MOV     DPH,A
095D 120000      E     LCALL   ?C?LSTXDATA
0960 8042              SJMP    ?C0089
0962         ?C0088:
                                           ; SOURCE LINE # 502
                                           ; SOURCE LINE # 503
0962 E500        R     MOV     A,index
0964 25E0              ADD     A,ACC
0966 25E0              ADD     A,ACC
0968 2400        R     ADD     A,#LOW curr_error_sum
096A F582              MOV     DPL,A
096C E4                CLR     A
096D 3400        R     ADDC    A,#HIGH curr_error_sum
096F F583              MOV     DPH,A
0971 E0                MOVX    A,@DPTR
0972 FC                MOV     R4,A
0973 A3                INC     DPTR
0974 E0                MOVX    A,@DPTR
0975 FD                MOV     R5,A
0976 A3                INC     DPTR
0977 E0                MOVX    A,@DPTR
0978 FE                MOV     R6,A
0979 A3                INC     DPTR
097A E0                MOVX    A,@DPTR
097B FF                MOV     R7,A
097C 7B60              MOV     R3,#060H
097E 7A79              MOV     R2,#079H
0980 79FE              MOV     R1,#0FEH
0982 78FF              MOV     R0,#0FFH
0984 D3                SETB    C
0985 120000      E     LCALL   ?C?SLCMP
0988 401A              JC      ?C0089
                                           ; SOURCE LINE # 504
098A 7F60              MOV     R7,#060H
098C 7E79              MOV     R6,#079H
098E 7DFE              MOV     R5,#0FEH
0990 7CFF              MOV     R4,#0FFH
0992 E500        R     MOV     A,index
0994 25E0              ADD     A,ACC
0996 25E0              ADD     A,ACC
0998 2400        R     ADD     A,#LOW curr_error_sum
099A F582              MOV     DPL,A
099C E4                CLR     A
099D 3400        R     ADDC    A,#HIGH curr_error_sum
099F F583              MOV     DPH,A
09A1 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 505
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 54  

09A4         ?C0089:
                                           ; SOURCE LINE # 507
09A4 300005            JNB     interrupt_flag,?C0091
                                           ; SOURCE LINE # 508
09A7 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 509
09A9 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 510
09AC         ?C0091:
                                           ; SOURCE LINE # 514
09AC E4                CLR     A
09AD F500        R     MOV     pwm_input+03H,A
09AF F500        R     MOV     pwm_input+02H,A
09B1 F500        R     MOV     pwm_input+01H,A
09B3 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 517
09B5 FF                MOV     R7,A
09B6 FE                MOV     R6,A
09B7 FD                MOV     R5,A
09B8 FC                MOV     R4,A
09B9 AB00        R     MOV     R3,k_p_c_dl+03H
09BB AA00        R     MOV     R2,k_p_c_dl+02H
09BD A900        R     MOV     R1,k_p_c_dl+01H
09BF A800        R     MOV     R0,k_p_c_dl
09C1 C3                CLR     C
09C2 120000      E     LCALL   ?C?SLCMP
09C5 6026              JZ      ?C0092
                                           ; SOURCE LINE # 518
09C7 AF00        R     MOV     R7,curr_error+03H
09C9 AE00        R     MOV     R6,curr_error+02H
09CB AD00        R     MOV     R5,curr_error+01H
09CD AC00        R     MOV     R4,curr_error
09CF A800        R     MOV     R0,k_p_c_dl
09D1 120000      E     LCALL   ?C?LMUL
09D4 7810              MOV     R0,#010H
09D6 120000      E     LCALL   ?C?SLSHR
09D9 E500        R     MOV     A,pwm_input+03H
09DB 2F                ADD     A,R7
09DC F500        R     MOV     pwm_input+03H,A
09DE E500        R     MOV     A,pwm_input+02H
09E0 3E                ADDC    A,R6
09E1 F500        R     MOV     pwm_input+02H,A
09E3 E500        R     MOV     A,pwm_input+01H
09E5 3D                ADDC    A,R5
09E6 F500        R     MOV     pwm_input+01H,A
09E8 E500        R     MOV     A,pwm_input
09EA 3C                ADDC    A,R4
09EB F500        R     MOV     pwm_input,A
09ED         ?C0092:
                                           ; SOURCE LINE # 521
09ED E4                CLR     A
09EE FF                MOV     R7,A
09EF FE                MOV     R6,A
09F0 FD                MOV     R5,A
09F1 FC                MOV     R4,A
09F2 AB00        R     MOV     R3,k_i_c_dl+03H
09F4 AA00        R     MOV     R2,k_i_c_dl+02H
09F6 A900        R     MOV     R1,k_i_c_dl+01H
09F8 A800        R     MOV     R0,k_i_c_dl
09FA C3                CLR     C
09FB 120000      E     LCALL   ?C?SLCMP
09FE 6038              JZ      ?C0093
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 55  

                                           ; SOURCE LINE # 522
0A00 E500        R     MOV     A,index
0A02 25E0              ADD     A,ACC
0A04 25E0              ADD     A,ACC
0A06 2400        R     ADD     A,#LOW curr_error_sum
0A08 F582              MOV     DPL,A
0A0A E4                CLR     A
0A0B 3400        R     ADDC    A,#HIGH curr_error_sum
0A0D F583              MOV     DPH,A
0A0F E0                MOVX    A,@DPTR
0A10 FC                MOV     R4,A
0A11 A3                INC     DPTR
0A12 E0                MOVX    A,@DPTR
0A13 FD                MOV     R5,A
0A14 A3                INC     DPTR
0A15 E0                MOVX    A,@DPTR
0A16 FE                MOV     R6,A
0A17 A3                INC     DPTR
0A18 E0                MOVX    A,@DPTR
0A19 FF                MOV     R7,A
0A1A A800        R     MOV     R0,k_i_c_dl
0A1C 120000      E     LCALL   ?C?LMUL
0A1F 7810              MOV     R0,#010H
0A21 120000      E     LCALL   ?C?SLSHR
0A24 E500        R     MOV     A,pwm_input+03H
0A26 2F                ADD     A,R7
0A27 F500        R     MOV     pwm_input+03H,A
0A29 E500        R     MOV     A,pwm_input+02H
0A2B 3E                ADDC    A,R6
0A2C F500        R     MOV     pwm_input+02H,A
0A2E E500        R     MOV     A,pwm_input+01H
0A30 3D                ADDC    A,R5
0A31 F500        R     MOV     pwm_input+01H,A
0A33 E500        R     MOV     A,pwm_input
0A35 3C                ADDC    A,R4
0A36 F500        R     MOV     pwm_input,A
0A38         ?C0093:
                                           ; SOURCE LINE # 525
0A38 E4                CLR     A
0A39 FF                MOV     R7,A
0A3A FE                MOV     R6,A
0A3B FD                MOV     R5,A
0A3C FC                MOV     R4,A
0A3D AB00        R     MOV     R3,k_d_c_dl+03H
0A3F AA00        R     MOV     R2,k_d_c_dl+02H
0A41 A900        R     MOV     R1,k_d_c_dl+01H
0A43 A800        R     MOV     R0,k_d_c_dl
0A45 C3                CLR     C
0A46 120000      E     LCALL   ?C?SLCMP
0A49 6063              JZ      ?C0094
                                           ; SOURCE LINE # 526
0A4B E500        R     MOV     A,index
0A4D 25E0              ADD     A,ACC
0A4F 25E0              ADD     A,ACC
0A51 2400        E     ADD     A,#LOW g_meas+0CH
0A53 F582              MOV     DPL,A
0A55 E4                CLR     A
0A56 3400        E     ADDC    A,#HIGH g_meas+0CH
0A58 F583              MOV     DPH,A
0A5A E0                MOVX    A,@DPTR
0A5B F8                MOV     R0,A
0A5C A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 56  

0A5D E0                MOVX    A,@DPTR
0A5E F9                MOV     R1,A
0A5F A3                INC     DPTR
0A60 E0                MOVX    A,@DPTR
0A61 FA                MOV     R2,A
0A62 A3                INC     DPTR
0A63 E0                MOVX    A,@DPTR
0A64 FB                MOV     R3,A
0A65 E500        R     MOV     A,index
0A67 25E0              ADD     A,ACC
0A69 25E0              ADD     A,ACC
0A6B 2400        E     ADD     A,#LOW g_measOld+0CH
0A6D F582              MOV     DPL,A
0A6F E4                CLR     A
0A70 3400        E     ADDC    A,#HIGH g_measOld+0CH
0A72 F583              MOV     DPH,A
0A74 E0                MOVX    A,@DPTR
0A75 FC                MOV     R4,A
0A76 A3                INC     DPTR
0A77 E0                MOVX    A,@DPTR
0A78 FD                MOV     R5,A
0A79 A3                INC     DPTR
0A7A E0                MOVX    A,@DPTR
0A7B FE                MOV     R6,A
0A7C A3                INC     DPTR
0A7D E0                MOVX    A,@DPTR
0A7E C3                CLR     C
0A7F 9B                SUBB    A,R3
0A80 FF                MOV     R7,A
0A81 EE                MOV     A,R6
0A82 9A                SUBB    A,R2
0A83 FE                MOV     R6,A
0A84 ED                MOV     A,R5
0A85 99                SUBB    A,R1
0A86 FD                MOV     R5,A
0A87 EC                MOV     A,R4
0A88 98                SUBB    A,R0
0A89 FC                MOV     R4,A
0A8A AB00        R     MOV     R3,k_d_c_dl+03H
0A8C AA00        R     MOV     R2,k_d_c_dl+02H
0A8E A900        R     MOV     R1,k_d_c_dl+01H
0A90 A800        R     MOV     R0,k_d_c_dl
0A92 120000      E     LCALL   ?C?LMUL
0A95 7810              MOV     R0,#010H
0A97 120000      E     LCALL   ?C?SLSHR
0A9A E500        R     MOV     A,pwm_input+03H
0A9C 2F                ADD     A,R7
0A9D F500        R     MOV     pwm_input+03H,A
0A9F E500        R     MOV     A,pwm_input+02H
0AA1 3E                ADDC    A,R6
0AA2 F500        R     MOV     pwm_input+02H,A
0AA4 E500        R     MOV     A,pwm_input+01H
0AA6 3D                ADDC    A,R5
0AA7 F500        R     MOV     pwm_input+01H,A
0AA9 E500        R     MOV     A,pwm_input
0AAB 3C                ADDC    A,R4
0AAC F500        R     MOV     pwm_input,A
0AAE         ?C0094:
                                           ; SOURCE LINE # 528
0AAE 300005            JNB     interrupt_flag,?C0095
                                           ; SOURCE LINE # 529
0AB1 C200        E     CLR     interrupt_flag
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 57  

                                           ; SOURCE LINE # 530
0AB3 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 531
0AB6         ?C0095:
                                           ; SOURCE LINE # 534
0AB6 E500        R     MOV     A,index
0AB8 701A              JNZ     ?C0096
                                           ; SOURCE LINE # 535
0ABA FF                MOV     R7,A
0ABB FE                MOV     R6,A
0ABC FD                MOV     R5,A
0ABD FC                MOV     R4,A
0ABE AB00        R     MOV     R3,pwm_input+03H
0AC0 AA00        R     MOV     R2,pwm_input+02H
0AC2 A900        R     MOV     R1,pwm_input+01H
0AC4 A800        R     MOV     R0,pwm_input
0AC6 C3                CLR     C
0AC7 120000      E     LCALL   ?C?SLCMP
0ACA 4004              JC      ?C0097
                                           ; SOURCE LINE # 536
0ACC D200        R     SETB    dirM0
0ACE 801D              SJMP    ?C0099
0AD0         ?C0097:
                                           ; SOURCE LINE # 539
0AD0 C200        R     CLR     dirM0
                                           ; SOURCE LINE # 541
0AD2 8019              SJMP    ?C0099
0AD4         ?C0096:
                                           ; SOURCE LINE # 542
                                           ; SOURCE LINE # 543
0AD4 E4                CLR     A
0AD5 FF                MOV     R7,A
0AD6 FE                MOV     R6,A
0AD7 FD                MOV     R5,A
0AD8 FC                MOV     R4,A
0AD9 AB00        R     MOV     R3,pwm_input+03H
0ADB AA00        R     MOV     R2,pwm_input+02H
0ADD A900        R     MOV     R1,pwm_input+01H
0ADF A800        R     MOV     R0,pwm_input
0AE1 C3                CLR     C
0AE2 120000      E     LCALL   ?C?SLCMP
0AE5 4004              JC      ?C0100
                                           ; SOURCE LINE # 544
0AE7 D200        R     SETB    dirM1
0AE9 8002              SJMP    ?C0099
0AEB         ?C0100:
                                           ; SOURCE LINE # 547
0AEB C200        R     CLR     dirM1
                                           ; SOURCE LINE # 549
0AED         ?C0099:
                                           ; SOURCE LINE # 551
0AED 300005            JNB     interrupt_flag,?C0102
                                           ; SOURCE LINE # 552
0AF0 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 553
0AF2 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 554
0AF5         ?C0102:
                                           ; SOURCE LINE # 557
0AF5 74FF              MOV     A,#0FFH
0AF7 7F9C              MOV     R7,#09CH
0AF9 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 58  

0AFA FD                MOV     R5,A
0AFB FC                MOV     R4,A
0AFC AB00        R     MOV     R3,pwm_input+03H
0AFE AA00        R     MOV     R2,pwm_input+02H
0B00 A900        R     MOV     R1,pwm_input+01H
0B02 A800        R     MOV     R0,pwm_input
0B04 C3                CLR     C
0B05 120000      E     LCALL   ?C?SLCMP
0B08 500E              JNC     ?C0103
                                           ; SOURCE LINE # 558
0B0A 74FF              MOV     A,#0FFH
0B0C 75009C      R     MOV     pwm_input+03H,#09CH
0B0F F500        R     MOV     pwm_input+02H,A
0B11 F500        R     MOV     pwm_input+01H,A
0B13 F500        R     MOV     pwm_input,A
0B15 020000      R     LJMP    ?C0046
0B18         ?C0103:
                                           ; SOURCE LINE # 559
                                           ; SOURCE LINE # 560
0B18 E4                CLR     A
0B19 7F64              MOV     R7,#064H
0B1B FE                MOV     R6,A
0B1C FD                MOV     R5,A
0B1D FC                MOV     R4,A
0B1E AB00        R     MOV     R3,pwm_input+03H
0B20 AA00        R     MOV     R2,pwm_input+02H
0B22 A900        R     MOV     R1,pwm_input+01H
0B24 A800        R     MOV     R0,pwm_input
0B26 D3                SETB    C
0B27 120000      E     LCALL   ?C?SLCMP
0B2A 5003              JNC     $ + 5H
0B2C 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 561
0B2F E4                CLR     A
0B30 750064      R     MOV     pwm_input+03H,#064H
0B33 F500        R     MOV     pwm_input+02H,A
0B35 F500        R     MOV     pwm_input+01H,A
0B37 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 562
                                           ; SOURCE LINE # 564
0B39 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 566
0B3C         ?C0106:
                                           ; SOURCE LINE # 568
0B3C 900000      E     MOV     DPTR,#g_ref+018H
0B3F E0                MOVX    A,@DPTR
0B40 7003              JNZ     $ + 5H
0B42 020000      R     LJMP    ?C0046
0B45 200003      E     JB      tension_valid,$ + 6H
0B48 020000      R     LJMP    ?C0046
                                           ; SOURCE LINE # 571
0B4B E500        R     MOV     A,index
0B4D 25E0              ADD     A,ACC
0B4F 25E0              ADD     A,ACC
0B51 2400        E     ADD     A,#LOW g_ref+08H
0B53 F582              MOV     DPL,A
0B55 E4                CLR     A
0B56 3400        E     ADDC    A,#HIGH g_ref+08H
0B58 F583              MOV     DPH,A
0B5A E0                MOVX    A,@DPTR
0B5B FC                MOV     R4,A
0B5C A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 59  

0B5D E0                MOVX    A,@DPTR
0B5E FD                MOV     R5,A
0B5F A3                INC     DPTR
0B60 E0                MOVX    A,@DPTR
0B61 FE                MOV     R6,A
0B62 A3                INC     DPTR
0B63 E0                MOVX    A,@DPTR
0B64 F500        R     MOV     curr_ref+03H,A
0B66 8E00        R     MOV     curr_ref+02H,R6
0B68 8D00        R     MOV     curr_ref+01H,R5
0B6A 8C00        R     MOV     curr_ref,R4
                                           ; SOURCE LINE # 574
0B6C 900000      E     MOV     DPTR,#c_mem+032H
0B6F E0                MOVX    A,@DPTR
0B70 FE                MOV     R6,A
0B71 A3                INC     DPTR
0B72 E0                MOVX    A,@DPTR
0B73 FF                MOV     R7,A
0B74 EE                MOV     A,R6
0B75 33                RLC     A
0B76 95E0              SUBB    A,ACC
0B78 FD                MOV     R5,A
0B79 FC                MOV     R4,A
0B7A AB00        R     MOV     R3,curr_ref+03H
0B7C AA00        R     MOV     R2,curr_ref+02H
0B7E A900        R     MOV     R1,curr_ref+01H
0B80 A800        R     MOV     R0,curr_ref
0B82 D3                SETB    C
0B83 120000      E     LCALL   ?C?SLCMP
0B86 4016              JC      ?C0108
                                           ; SOURCE LINE # 575
0B88 900000      E     MOV     DPTR,#c_mem+032H
0B8B E0                MOVX    A,@DPTR
0B8C FE                MOV     R6,A
0B8D A3                INC     DPTR
0B8E E0                MOVX    A,@DPTR
0B8F FF                MOV     R7,A
0B90 EE                MOV     A,R6
0B91 33                RLC     A
0B92 95E0              SUBB    A,ACC
0B94 8F00        R     MOV     curr_ref+03H,R7
0B96 8E00        R     MOV     curr_ref+02H,R6
0B98 F500        R     MOV     curr_ref+01H,A
0B9A F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 576
0B9C 803C              SJMP    ?C0109
0B9E         ?C0108:
                                           ; SOURCE LINE # 577
                                           ; SOURCE LINE # 578
0B9E 900000      E     MOV     DPTR,#c_mem+032H
0BA1 E0                MOVX    A,@DPTR
0BA2 FE                MOV     R6,A
0BA3 A3                INC     DPTR
0BA4 E0                MOVX    A,@DPTR
0BA5 FF                MOV     R7,A
0BA6 C3                CLR     C
0BA7 E4                CLR     A
0BA8 9F                SUBB    A,R7
0BA9 FF                MOV     R7,A
0BAA E4                CLR     A
0BAB 9E                SUBB    A,R6
0BAC FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 60  

0BAD 33                RLC     A
0BAE 95E0              SUBB    A,ACC
0BB0 FD                MOV     R5,A
0BB1 FC                MOV     R4,A
0BB2 AB00        R     MOV     R3,curr_ref+03H
0BB4 AA00        R     MOV     R2,curr_ref+02H
0BB6 A900        R     MOV     R1,curr_ref+01H
0BB8 A800        R     MOV     R0,curr_ref
0BBA C3                CLR     C
0BBB 120000      E     LCALL   ?C?SLCMP
0BBE 501A              JNC     ?C0109
                                           ; SOURCE LINE # 579
0BC0 900000      E     MOV     DPTR,#c_mem+032H
0BC3 E0                MOVX    A,@DPTR
0BC4 FE                MOV     R6,A
0BC5 A3                INC     DPTR
0BC6 E0                MOVX    A,@DPTR
0BC7 FF                MOV     R7,A
0BC8 C3                CLR     C
0BC9 E4                CLR     A
0BCA 9F                SUBB    A,R7
0BCB FF                MOV     R7,A
0BCC E4                CLR     A
0BCD 9E                SUBB    A,R6
0BCE FE                MOV     R6,A
0BCF 33                RLC     A
0BD0 95E0              SUBB    A,ACC
0BD2 8F00        R     MOV     curr_ref+03H,R7
0BD4 8E00        R     MOV     curr_ref+02H,R6
0BD6 F500        R     MOV     curr_ref+01H,A
0BD8 F500        R     MOV     curr_ref,A
                                           ; SOURCE LINE # 580
0BDA         ?C0109:
                                           ; SOURCE LINE # 582
0BDA 300005            JNB     interrupt_flag,?C0111
                                           ; SOURCE LINE # 583
0BDD C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 584
0BDF 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 585
0BE2         ?C0111:
                                           ; SOURCE LINE # 588
0BE2 E500        R     MOV     A,index
0BE4 25E0              ADD     A,ACC
0BE6 25E0              ADD     A,ACC
0BE8 2400        E     ADD     A,#LOW g_meas+0CH
0BEA F582              MOV     DPL,A
0BEC E4                CLR     A
0BED 3400        E     ADDC    A,#HIGH g_meas+0CH
0BEF F583              MOV     DPH,A
0BF1 E0                MOVX    A,@DPTR
0BF2 F8                MOV     R0,A
0BF3 A3                INC     DPTR
0BF4 E0                MOVX    A,@DPTR
0BF5 F9                MOV     R1,A
0BF6 A3                INC     DPTR
0BF7 E0                MOVX    A,@DPTR
0BF8 FA                MOV     R2,A
0BF9 A3                INC     DPTR
0BFA E0                MOVX    A,@DPTR
0BFB FB                MOV     R3,A
0BFC C3                CLR     C
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 61  

0BFD E500        R     MOV     A,curr_ref+03H
0BFF 9B                SUBB    A,R3
0C00 F500        R     MOV     curr_error+03H,A
0C02 E500        R     MOV     A,curr_ref+02H
0C04 9A                SUBB    A,R2
0C05 F500        R     MOV     curr_error+02H,A
0C07 E500        R     MOV     A,curr_ref+01H
0C09 99                SUBB    A,R1
0C0A F500        R     MOV     curr_error+01H,A
0C0C E500        R     MOV     A,curr_ref
0C0E 98                SUBB    A,R0
0C0F F500        R     MOV     curr_error,A
                                           ; SOURCE LINE # 591
0C11 E500        R     MOV     A,index
0C13 25E0              ADD     A,ACC
0C15 25E0              ADD     A,ACC
0C17 2400        R     ADD     A,#LOW curr_error_sum
0C19 F582              MOV     DPL,A
0C1B E4                CLR     A
0C1C 3400        R     ADDC    A,#HIGH curr_error_sum
0C1E F583              MOV     DPH,A
0C20 C083              PUSH    DPH
0C22 C082              PUSH    DPL
0C24 E0                MOVX    A,@DPTR
0C25 FC                MOV     R4,A
0C26 A3                INC     DPTR
0C27 E0                MOVX    A,@DPTR
0C28 FD                MOV     R5,A
0C29 A3                INC     DPTR
0C2A E0                MOVX    A,@DPTR
0C2B FE                MOV     R6,A
0C2C A3                INC     DPTR
0C2D E0                MOVX    A,@DPTR
0C2E 2500        R     ADD     A,curr_error+03H
0C30 FF                MOV     R7,A
0C31 EE                MOV     A,R6
0C32 3500        R     ADDC    A,curr_error+02H
0C34 FE                MOV     R6,A
0C35 ED                MOV     A,R5
0C36 3500        R     ADDC    A,curr_error+01H
0C38 FD                MOV     R5,A
0C39 EC                MOV     A,R4
0C3A 3500        R     ADDC    A,curr_error
0C3C FC                MOV     R4,A
0C3D D082              POP     DPL
0C3F D083              POP     DPH
0C41 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 594
0C44 E500        R     MOV     A,index
0C46 25E0              ADD     A,ACC
0C48 25E0              ADD     A,ACC
0C4A 2400        R     ADD     A,#LOW curr_error_sum
0C4C F582              MOV     DPL,A
0C4E E4                CLR     A
0C4F 3400        R     ADDC    A,#HIGH curr_error_sum
0C51 F583              MOV     DPH,A
0C53 E0                MOVX    A,@DPTR
0C54 FC                MOV     R4,A
0C55 A3                INC     DPTR
0C56 E0                MOVX    A,@DPTR
0C57 FD                MOV     R5,A
0C58 A3                INC     DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 62  

0C59 E0                MOVX    A,@DPTR
0C5A FE                MOV     R6,A
0C5B A3                INC     DPTR
0C5C E0                MOVX    A,@DPTR
0C5D FF                MOV     R7,A
0C5E 7BA0              MOV     R3,#0A0H
0C60 7A86              MOV     R2,#086H
0C62 7901              MOV     R1,#01H
0C64 7800              MOV     R0,#00H
0C66 C3                CLR     C
0C67 120000      E     LCALL   ?C?SLCMP
0C6A 501C              JNC     ?C0112
                                           ; SOURCE LINE # 595
0C6C 7FA0              MOV     R7,#0A0H
0C6E 7E86              MOV     R6,#086H
0C70 7D01              MOV     R5,#01H
0C72 7C00              MOV     R4,#00H
0C74 E500        R     MOV     A,index
0C76 25E0              ADD     A,ACC
0C78 25E0              ADD     A,ACC
0C7A 2400        R     ADD     A,#LOW curr_error_sum
0C7C F582              MOV     DPL,A
0C7E E4                CLR     A
0C7F 3400        R     ADDC    A,#HIGH curr_error_sum
0C81 F583              MOV     DPH,A
0C83 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 596
0C86 8042              SJMP    ?C0113
0C88         ?C0112:
                                           ; SOURCE LINE # 597
                                           ; SOURCE LINE # 598
0C88 E500        R     MOV     A,index
0C8A 25E0              ADD     A,ACC
0C8C 25E0              ADD     A,ACC
0C8E 2400        R     ADD     A,#LOW curr_error_sum
0C90 F582              MOV     DPL,A
0C92 E4                CLR     A
0C93 3400        R     ADDC    A,#HIGH curr_error_sum
0C95 F583              MOV     DPH,A
0C97 E0                MOVX    A,@DPTR
0C98 FC                MOV     R4,A
0C99 A3                INC     DPTR
0C9A E0                MOVX    A,@DPTR
0C9B FD                MOV     R5,A
0C9C A3                INC     DPTR
0C9D E0                MOVX    A,@DPTR
0C9E FE                MOV     R6,A
0C9F A3                INC     DPTR
0CA0 E0                MOVX    A,@DPTR
0CA1 FF                MOV     R7,A
0CA2 7B60              MOV     R3,#060H
0CA4 7A79              MOV     R2,#079H
0CA6 79FE              MOV     R1,#0FEH
0CA8 78FF              MOV     R0,#0FFH
0CAA D3                SETB    C
0CAB 120000      E     LCALL   ?C?SLCMP
0CAE 401A              JC      ?C0113
                                           ; SOURCE LINE # 599
0CB0 7F60              MOV     R7,#060H
0CB2 7E79              MOV     R6,#079H
0CB4 7DFE              MOV     R5,#0FEH
0CB6 7CFF              MOV     R4,#0FFH
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 63  

0CB8 E500        R     MOV     A,index
0CBA 25E0              ADD     A,ACC
0CBC 25E0              ADD     A,ACC
0CBE 2400        R     ADD     A,#LOW curr_error_sum
0CC0 F582              MOV     DPL,A
0CC2 E4                CLR     A
0CC3 3400        R     ADDC    A,#HIGH curr_error_sum
0CC5 F583              MOV     DPH,A
0CC7 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 600
0CCA         ?C0113:
                                           ; SOURCE LINE # 602
0CCA 300005            JNB     interrupt_flag,?C0115
                                           ; SOURCE LINE # 603
0CCD C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 604
0CCF 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 605
0CD2         ?C0115:
                                           ; SOURCE LINE # 608
0CD2 E4                CLR     A
0CD3 F500        R     MOV     pwm_input+03H,A
0CD5 F500        R     MOV     pwm_input+02H,A
0CD7 F500        R     MOV     pwm_input+01H,A
0CD9 F500        R     MOV     pwm_input,A
                                           ; SOURCE LINE # 611
0CDB FF                MOV     R7,A
0CDC FE                MOV     R6,A
0CDD FD                MOV     R5,A
0CDE FC                MOV     R4,A
0CDF AB00        R     MOV     R3,k_p_c+03H
0CE1 AA00        R     MOV     R2,k_p_c+02H
0CE3 A900        R     MOV     R1,k_p_c+01H
0CE5 A800        R     MOV     R0,k_p_c
0CE7 C3                CLR     C
0CE8 120000      E     LCALL   ?C?SLCMP
0CEB 6026              JZ      ?C0116
                                           ; SOURCE LINE # 612
0CED AF00        R     MOV     R7,curr_error+03H
0CEF AE00        R     MOV     R6,curr_error+02H
0CF1 AD00        R     MOV     R5,curr_error+01H
0CF3 AC00        R     MOV     R4,curr_error
0CF5 A800        R     MOV     R0,k_p_c
0CF7 120000      E     LCALL   ?C?LMUL
0CFA 7810              MOV     R0,#010H
0CFC 120000      E     LCALL   ?C?SLSHR
0CFF E500        R     MOV     A,pwm_input+03H
0D01 2F                ADD     A,R7
0D02 F500        R     MOV     pwm_input+03H,A
0D04 E500        R     MOV     A,pwm_input+02H
0D06 3E                ADDC    A,R6
0D07 F500        R     MOV     pwm_input+02H,A
0D09 E500        R     MOV     A,pwm_input+01H
0D0B 3D                ADDC    A,R5
0D0C F500        R     MOV     pwm_input+01H,A
0D0E E500        R     MOV     A,pwm_input
0D10 3C                ADDC    A,R4
0D11 F500        R     MOV     pwm_input,A
0D13         ?C0116:
                                           ; SOURCE LINE # 615
0D13 E4                CLR     A
0D14 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 64  

0D15 FE                MOV     R6,A
0D16 FD                MOV     R5,A
0D17 FC                MOV     R4,A
0D18 AB00        R     MOV     R3,k_i_c+03H
0D1A AA00        R     MOV     R2,k_i_c+02H
0D1C A900        R     MOV     R1,k_i_c+01H
0D1E A800        R     MOV     R0,k_i_c
0D20 C3                CLR     C
0D21 120000      E     LCALL   ?C?SLCMP
0D24 603D              JZ      ?C0117
                                           ; SOURCE LINE # 616
0D26 E500        R     MOV     A,index
0D28 25E0              ADD     A,ACC
0D2A 25E0              ADD     A,ACC
0D2C 2400        R     ADD     A,#LOW curr_error_sum
0D2E F582              MOV     DPL,A
0D30 E4                CLR     A
0D31 3400        R     ADDC    A,#HIGH curr_error_sum
0D33 F583              MOV     DPH,A
0D35 E0                MOVX    A,@DPTR
0D36 FC                MOV     R4,A
0D37 A3                INC     DPTR
0D38 E0                MOVX    A,@DPTR
0D39 FD                MOV     R5,A
0D3A A3                INC     DPTR
0D3B E0                MOVX    A,@DPTR
0D3C FE                MOV     R6,A
0D3D A3                INC     DPTR
0D3E E0                MOVX    A,@DPTR
0D3F FF                MOV     R7,A
0D40 7806              MOV     R0,#06H
0D42 120000      E     LCALL   ?C?SLSHR
0D45 A800        R     MOV     R0,k_i_c
0D47 120000      E     LCALL   ?C?LMUL
0D4A 780A              MOV     R0,#0AH
0D4C 120000      E     LCALL   ?C?SLSHR
0D4F E500        R     MOV     A,pwm_input+03H
0D51 2F                ADD     A,R7
0D52 F500        R     MOV     pwm_input+03H,A
0D54 E500        R     MOV     A,pwm_input+02H
0D56 3E                ADDC    A,R6
0D57 F500        R     MOV     pwm_input+02H,A
0D59 E500        R     MOV     A,pwm_input+01H
0D5B 3D                ADDC    A,R5
0D5C F500        R     MOV     pwm_input+01H,A
0D5E E500        R     MOV     A,pwm_input
0D60 3C                ADDC    A,R4
0D61 F500        R     MOV     pwm_input,A
0D63         ?C0117:
                                           ; SOURCE LINE # 619
0D63 E4                CLR     A
0D64 FF                MOV     R7,A
0D65 FE                MOV     R6,A
0D66 FD                MOV     R5,A
0D67 FC                MOV     R4,A
0D68 AB00        R     MOV     R3,k_d_c+03H
0D6A AA00        R     MOV     R2,k_d_c+02H
0D6C A900        R     MOV     R1,k_d_c+01H
0D6E A800        R     MOV     R0,k_d_c
0D70 C3                CLR     C
0D71 120000      E     LCALL   ?C?SLCMP
0D74 604F              JZ      ?C0118
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 65  

                                           ; SOURCE LINE # 620
0D76 E500        R     MOV     A,index
0D78 25E0              ADD     A,ACC
0D7A 25E0              ADD     A,ACC
0D7C 2400        R     ADD     A,#LOW prev_curr_err
0D7E F582              MOV     DPL,A
0D80 E4                CLR     A
0D81 3400        R     ADDC    A,#HIGH prev_curr_err
0D83 F583              MOV     DPH,A
0D85 E0                MOVX    A,@DPTR
0D86 F8                MOV     R0,A
0D87 A3                INC     DPTR
0D88 E0                MOVX    A,@DPTR
0D89 F9                MOV     R1,A
0D8A A3                INC     DPTR
0D8B E0                MOVX    A,@DPTR
0D8C FA                MOV     R2,A
0D8D A3                INC     DPTR
0D8E E0                MOVX    A,@DPTR
0D8F FB                MOV     R3,A
0D90 C3                CLR     C
0D91 E500        R     MOV     A,curr_error+03H
0D93 9B                SUBB    A,R3
0D94 FF                MOV     R7,A
0D95 E500        R     MOV     A,curr_error+02H
0D97 9A                SUBB    A,R2
0D98 FE                MOV     R6,A
0D99 E500        R     MOV     A,curr_error+01H
0D9B 99                SUBB    A,R1
0D9C FD                MOV     R5,A
0D9D E500        R     MOV     A,curr_error
0D9F 98                SUBB    A,R0
0DA0 FC                MOV     R4,A
0DA1 AB00        R     MOV     R3,k_d_c+03H
0DA3 AA00        R     MOV     R2,k_d_c+02H
0DA5 A900        R     MOV     R1,k_d_c+01H
0DA7 A800        R     MOV     R0,k_d_c
0DA9 120000      E     LCALL   ?C?LMUL
0DAC 7810              MOV     R0,#010H
0DAE 120000      E     LCALL   ?C?SLSHR
0DB1 E500        R     MOV     A,pwm_input+03H
0DB3 2F                ADD     A,R7
0DB4 F500        R     MOV     pwm_input+03H,A
0DB6 E500        R     MOV     A,pwm_input+02H
0DB8 3E                ADDC    A,R6
0DB9 F500        R     MOV     pwm_input+02H,A
0DBB E500        R     MOV     A,pwm_input+01H
0DBD 3D                ADDC    A,R5
0DBE F500        R     MOV     pwm_input+01H,A
0DC0 E500        R     MOV     A,pwm_input
0DC2 3C                ADDC    A,R4
0DC3 F500        R     MOV     pwm_input,A
0DC5         ?C0118:
                                           ; SOURCE LINE # 622
0DC5 300005            JNB     interrupt_flag,?C0119
                                           ; SOURCE LINE # 623
0DC8 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 624
0DCA 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 625
0DCD         ?C0119:
                                           ; SOURCE LINE # 628
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 66  

0DCD AF00        R     MOV     R7,curr_error+03H
0DCF AE00        R     MOV     R6,curr_error+02H
0DD1 AD00        R     MOV     R5,curr_error+01H
0DD3 AC00        R     MOV     R4,curr_error
0DD5 E500        R     MOV     A,index
0DD7 25E0              ADD     A,ACC
0DD9 25E0              ADD     A,ACC
0DDB 2400        R     ADD     A,#LOW prev_curr_err
0DDD F582              MOV     DPL,A
0DDF E4                CLR     A
0DE0 3400        R     ADDC    A,#HIGH prev_curr_err
0DE2 F583              MOV     DPH,A
0DE4 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 630
0DE7 E500        R     MOV     A,index
0DE9 701A              JNZ     ?C0120
                                           ; SOURCE LINE # 631
0DEB FF                MOV     R7,A
0DEC FE                MOV     R6,A
0DED FD                MOV     R5,A
0DEE FC                MOV     R4,A
0DEF AB00        R     MOV     R3,pwm_input+03H
0DF1 AA00        R     MOV     R2,pwm_input+02H
0DF3 A900        R     MOV     R1,pwm_input+01H
0DF5 A800        R     MOV     R0,pwm_input
0DF7 C3                CLR     C
0DF8 120000      E     LCALL   ?C?SLCMP
0DFB 4004              JC      ?C0121
                                           ; SOURCE LINE # 632
0DFD D200        R     SETB    dirM0
0DFF 801D              SJMP    ?C0123
0E01         ?C0121:
                                           ; SOURCE LINE # 635
0E01 C200        R     CLR     dirM0
                                           ; SOURCE LINE # 637
0E03 8019              SJMP    ?C0123
0E05         ?C0120:
                                           ; SOURCE LINE # 638
                                           ; SOURCE LINE # 639
0E05 E4                CLR     A
0E06 FF                MOV     R7,A
0E07 FE                MOV     R6,A
0E08 FD                MOV     R5,A
0E09 FC                MOV     R4,A
0E0A AB00        R     MOV     R3,pwm_input+03H
0E0C AA00        R     MOV     R2,pwm_input+02H
0E0E A900        R     MOV     R1,pwm_input+01H
0E10 A800        R     MOV     R0,pwm_input
0E12 C3                CLR     C
0E13 120000      E     LCALL   ?C?SLCMP
0E16 4004              JC      ?C0124
                                           ; SOURCE LINE # 640
0E18 D200        R     SETB    dirM1
0E1A 8002              SJMP    ?C0123
0E1C         ?C0124:
                                           ; SOURCE LINE # 643
0E1C C200        R     CLR     dirM1
                                           ; SOURCE LINE # 645
0E1E         ?C0123:
                                           ; SOURCE LINE # 647
0E1E 30005F            JNB     interrupt_flag,?C0046
                                           ; SOURCE LINE # 648
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 67  

0E21 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 649
0E23 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 650
                                           ; SOURCE LINE # 651
                                           ; SOURCE LINE # 653
0E26 8058              SJMP    ?C0046
                                           ; SOURCE LINE # 655
0E28         ?C0127:
                                           ; SOURCE LINE # 657
0E28 E500        R     MOV     A,index
0E2A 25E0              ADD     A,ACC
0E2C 25E0              ADD     A,ACC
0E2E 2400        E     ADD     A,#LOW g_ref+010H
0E30 F582              MOV     DPL,A
0E32 E4                CLR     A
0E33 3400        E     ADDC    A,#HIGH g_ref+010H
0E35 F583              MOV     DPH,A
0E37 E0                MOVX    A,@DPTR
0E38 FC                MOV     R4,A
0E39 A3                INC     DPTR
0E3A E0                MOVX    A,@DPTR
0E3B FD                MOV     R5,A
0E3C A3                INC     DPTR
0E3D E0                MOVX    A,@DPTR
0E3E FE                MOV     R6,A
0E3F A3                INC     DPTR
0E40 E0                MOVX    A,@DPTR
0E41 F500        R     MOV     pwm_input+03H,A
0E43 8E00        R     MOV     pwm_input+02H,R6
0E45 8D00        R     MOV     pwm_input+01H,R5
0E47 8C00        R     MOV     pwm_input,R4
                                           ; SOURCE LINE # 660
0E49 E500        R     MOV     A,index
0E4B 701A              JNZ     ?C0128
                                           ; SOURCE LINE # 661
0E4D FF                MOV     R7,A
0E4E FE                MOV     R6,A
0E4F FD                MOV     R5,A
0E50 FC                MOV     R4,A
0E51 AB00        R     MOV     R3,pwm_input+03H
0E53 AA00        R     MOV     R2,pwm_input+02H
0E55 A900        R     MOV     R1,pwm_input+01H
0E57 A800        R     MOV     R0,pwm_input
0E59 C3                CLR     C
0E5A 120000      E     LCALL   ?C?SLCMP
0E5D 4004              JC      ?C0129
                                           ; SOURCE LINE # 662
0E5F D200        R     SETB    dirM0
0E61 801D              SJMP    ?C0046
0E63         ?C0129:
                                           ; SOURCE LINE # 665
0E63 C200        R     CLR     dirM0
                                           ; SOURCE LINE # 667
0E65 8019              SJMP    ?C0046
0E67         ?C0128:
                                           ; SOURCE LINE # 668
                                           ; SOURCE LINE # 669
0E67 E4                CLR     A
0E68 FF                MOV     R7,A
0E69 FE                MOV     R6,A
0E6A FD                MOV     R5,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 68  

0E6B FC                MOV     R4,A
0E6C AB00        R     MOV     R3,pwm_input+03H
0E6E AA00        R     MOV     R2,pwm_input+02H
0E70 A900        R     MOV     R1,pwm_input+01H
0E72 A800        R     MOV     R0,pwm_input
0E74 C3                CLR     C
0E75 120000      E     LCALL   ?C?SLCMP
0E78 4004              JC      ?C0132
                                           ; SOURCE LINE # 670
0E7A D200        R     SETB    dirM1
0E7C 8002              SJMP    ?C0046
0E7E         ?C0132:
                                           ; SOURCE LINE # 673
0E7E C200        R     CLR     dirM1
                                           ; SOURCE LINE # 675
                                           ; SOURCE LINE # 677
                                           ; SOURCE LINE # 678
                                           ; SOURCE LINE # 679
                                           ; SOURCE LINE # 680
0E80         ?C0046:
                                           ; SOURCE LINE # 682
0E80 300005            JNB     interrupt_flag,?C0135
                                           ; SOURCE LINE # 683
0E83 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 684
0E85 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 685
0E88         ?C0135:
                                           ; SOURCE LINE # 688
0E88 E4                CLR     A
0E89 7F64              MOV     R7,#064H
0E8B FE                MOV     R6,A
0E8C FD                MOV     R5,A
0E8D FC                MOV     R4,A
0E8E AB00        R     MOV     R3,pwm_input+03H
0E90 AA00        R     MOV     R2,pwm_input+02H
0E92 A900        R     MOV     R1,pwm_input+01H
0E94 A800        R     MOV     R0,pwm_input
0E96 D3                SETB    C
0E97 120000      E     LCALL   ?C?SLCMP
0E9A 400A              JC      ?C0136
                                           ; SOURCE LINE # 689
0E9C E4                CLR     A
0E9D 750064      R     MOV     pwm_input+03H,#064H
0EA0 F500        R     MOV     pwm_input+02H,A
0EA2 F500        R     MOV     pwm_input+01H,A
0EA4 F500        R     MOV     pwm_input,A
0EA6         ?C0136:
                                           ; SOURCE LINE # 690
0EA6 74FF              MOV     A,#0FFH
0EA8 7F9C              MOV     R7,#09CH
0EAA FE                MOV     R6,A
0EAB FD                MOV     R5,A
0EAC FC                MOV     R4,A
0EAD AB00        R     MOV     R3,pwm_input+03H
0EAF AA00        R     MOV     R2,pwm_input+02H
0EB1 A900        R     MOV     R1,pwm_input+01H
0EB3 A800        R     MOV     R0,pwm_input
0EB5 C3                CLR     C
0EB6 120000      E     LCALL   ?C?SLCMP
0EB9 500B              JNC     ?C0137
                                           ; SOURCE LINE # 691
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 69  

0EBB 74FF              MOV     A,#0FFH
0EBD 75009C      R     MOV     pwm_input+03H,#09CH
0EC0 F500        R     MOV     pwm_input+02H,A
0EC2 F500        R     MOV     pwm_input+01H,A
0EC4 F500        R     MOV     pwm_input,A
0EC6         ?C0137:
                                           ; SOURCE LINE # 693
0EC6 300005            JNB     interrupt_flag,?C0138
                                           ; SOURCE LINE # 694
0EC9 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 695
0ECB 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 696
0ECE         ?C0138:
                                           ; SOURCE LINE # 699
0ECE 900000      E     MOV     DPTR,#c_mem+036H
0ED1 E0                MOVX    A,@DPTR
0ED2 6401              XRL     A,#01H
0ED4 6037              JZ      ?C0139
                                           ; SOURCE LINE # 700
0ED6 AF00        R     MOV     R7,pwm_input+03H
0ED8 AE00        R     MOV     R6,pwm_input+02H
0EDA AD00        R     MOV     R5,pwm_input+01H
0EDC AC00        R     MOV     R4,pwm_input
0EDE 780A              MOV     R0,#0AH
0EE0 120000      E     LCALL   ?C?LSHL
0EE3 E4                CLR     A
0EE4 7B64              MOV     R3,#064H
0EE6 FA                MOV     R2,A
0EE7 F9                MOV     R1,A
0EE8 F8                MOV     R0,A
0EE9 120000      E     LCALL   ?C?SLDIV
0EEC A804              MOV     R0,AR4
0EEE A905              MOV     R1,AR5
0EF0 AA06              MOV     R2,AR6
0EF2 AB07              MOV     R3,AR7
0EF4 900000      E     MOV     DPTR,#dev_pwm_limit
0EF7 E0                MOVX    A,@DPTR
0EF8 FF                MOV     R7,A
0EF9 E4                CLR     A
0EFA FC                MOV     R4,A
0EFB FD                MOV     R5,A
0EFC FE                MOV     R6,A
0EFD 120000      E     LCALL   ?C?LMUL
0F00 780A              MOV     R0,#0AH
0F02 120000      E     LCALL   ?C?SLSHR
0F05 8F00        R     MOV     pwm_input+03H,R7
0F07 8E00        R     MOV     pwm_input+02H,R6
0F09 8D00        R     MOV     pwm_input+01H,R5
0F0B 8C00        R     MOV     pwm_input,R4
0F0D         ?C0139:
                                           ; SOURCE LINE # 704
0F0D 300011            JNB     dirM0,?C0140
                                           ; SOURCE LINE # 705
0F10 300007            JNB     dirM1,?C0141
                                           ; SOURCE LINE # 706
0F13 7F03              MOV     R7,#03H
0F15 120000      E     LCALL   _MOTOR_DIR_Write
0F18 8016              SJMP    ?C0143
0F1A         ?C0141:
                                           ; SOURCE LINE # 708
0F1A 7F01              MOV     R7,#01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 70  

0F1C 120000      E     LCALL   _MOTOR_DIR_Write
                                           ; SOURCE LINE # 709
0F1F 800F              SJMP    ?C0143
0F21         ?C0140:
                                           ; SOURCE LINE # 710
                                           ; SOURCE LINE # 711
0F21 300007            JNB     dirM1,?C0144
                                           ; SOURCE LINE # 712
0F24 7F02              MOV     R7,#02H
0F26 120000      E     LCALL   _MOTOR_DIR_Write
0F29 8005              SJMP    ?C0143
0F2B         ?C0144:
                                           ; SOURCE LINE # 714
0F2B E4                CLR     A
0F2C FF                MOV     R7,A
0F2D 120000      E     LCALL   _MOTOR_DIR_Write
                                           ; SOURCE LINE # 715
0F30         ?C0143:
                                           ; SOURCE LINE # 717
0F30 300005            JNB     interrupt_flag,?C0146
                                           ; SOURCE LINE # 718
0F33 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 719
0F35 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 720
0F38         ?C0146:
                                           ; SOURCE LINE # 722
0F38 E500        R     MOV     A,index
0F3A 7029              JNZ     ?C0147
                                           ; SOURCE LINE # 723
0F3C FF                MOV     R7,A
0F3D FE                MOV     R6,A
0F3E FD                MOV     R5,A
0F3F FC                MOV     R4,A
0F40 AB00        R     MOV     R3,pwm_input+03H
0F42 AA00        R     MOV     R2,pwm_input+02H
0F44 A900        R     MOV     R1,pwm_input+01H
0F46 A800        R     MOV     R0,pwm_input
0F48 C3                CLR     C
0F49 120000      E     LCALL   ?C?SLCMP
0F4C 4004              JC      ?C0148
0F4E 7F01              MOV     R7,#01H
0F50 8002              SJMP    ?C0149
0F52         ?C0148:
0F52 7FFF              MOV     R7,#0FFH
0F54         ?C0149:
0F54 900000      E     MOV     DPTR,#pwm_sign
0F57 EF                MOV     A,R7
0F58 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 724
0F59 AE00        R     MOV     R6,pwm_input+02H
0F5B AF00        R     MOV     R7,pwm_input+03H
0F5D 120000      E     LCALL   _abs
0F60 120000      E     LCALL   _PWM_MOTORS_WriteCompare1
                                           ; SOURCE LINE # 725
0F63 8028              SJMP    ?C0150
0F65         ?C0147:
                                           ; SOURCE LINE # 726
                                           ; SOURCE LINE # 727
0F65 E4                CLR     A
0F66 FF                MOV     R7,A
0F67 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 71  

0F68 FD                MOV     R5,A
0F69 FC                MOV     R4,A
0F6A AB00        R     MOV     R3,pwm_input+03H
0F6C AA00        R     MOV     R2,pwm_input+02H
0F6E A900        R     MOV     R1,pwm_input+01H
0F70 A800        R     MOV     R0,pwm_input
0F72 C3                CLR     C
0F73 120000      E     LCALL   ?C?SLCMP
0F76 4004              JC      ?C0151
0F78 7F01              MOV     R7,#01H
0F7A 8002              SJMP    ?C0152
0F7C         ?C0151:
0F7C 7FFF              MOV     R7,#0FFH
0F7E         ?C0152:
0F7E 900000      E     MOV     DPTR,#pwm_sign+01H
0F81 EF                MOV     A,R7
0F82 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 728
0F83 AE00        R     MOV     R6,pwm_input+02H
0F85 AF00        R     MOV     R7,pwm_input+03H
0F87 120000      E     LCALL   _abs
0F8A 120000      E     LCALL   _PWM_MOTORS_WriteCompare2
                                           ; SOURCE LINE # 729
0F8D         ?C0150:
                                           ; SOURCE LINE # 731
0F8D 300005            JNB     interrupt_flag,?C0041
                                           ; SOURCE LINE # 732
0F90 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 733
0F92 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 734
                                           ; SOURCE LINE # 735
0F95         ?C0041:
0F95 22                RET     
             ; FUNCTION _motor_control (END)

             ; FUNCTION analog_read_end (BEGIN)
                                           ; SOURCE LINE # 741
0000         ?C0154:
                                           ; SOURCE LINE # 762
0000 120000      E     LCALL   ADC_STATUS_Read
0003 EF                MOV     A,R7
0004 700A              JNZ     ?C0155
                                           ; SOURCE LINE # 763
0006 3000F7            JNB     interrupt_flag,?C0154
                                           ; SOURCE LINE # 764
0009 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 765
000B 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 766
                                           ; SOURCE LINE # 767
000E 80F0              SJMP    ?C0154
0010         ?C0155:
                                           ; SOURCE LINE # 770
0010 900000      E     MOV     DPTR,#ADC_buf+01H
0013 E0                MOVX    A,@DPTR
0014 249A              ADD     A,#09AH
0016 FF                MOV     R7,A
0017 900000      E     MOV     DPTR,#ADC_buf
001A E0                MOVX    A,@DPTR
001B 34F9              ADDC    A,#0F9H
001D FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 72  

001E 33                RLC     A
001F 95E0              SUBB    A,ACC
0021 FD                MOV     R5,A
0022 FC                MOV     R4,A
0023 E4                CLR     A
0024 7BA0              MOV     R3,#0A0H
0026 7A07              MOV     R2,#07H
0028 F9                MOV     R1,A
0029 F8                MOV     R0,A
002A 120000      E     LCALL   ?C?LMUL
002D 7807              MOV     R0,#07H
002F 120000      E     LCALL   ?C?SLSHR
0032 900000      E     MOV     DPTR,#dev_tension
0035 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 772
0038 300005            JNB     interrupt_flag,?C0157
                                           ; SOURCE LINE # 773
003B C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 774
003D 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 775
0040         ?C0157:
                                           ; SOURCE LINE # 779
0040 E4                CLR     A
0041 FF                MOV     R7,A
0042 FE                MOV     R6,A
0043 FD                MOV     R5,A
0044 FC                MOV     R4,A
0045 900000      E     MOV     DPTR,#dev_tension
0048 E0                MOVX    A,@DPTR
0049 F8                MOV     R0,A
004A A3                INC     DPTR
004B E0                MOVX    A,@DPTR
004C F9                MOV     R1,A
004D A3                INC     DPTR
004E E0                MOVX    A,@DPTR
004F FA                MOV     R2,A
0050 A3                INC     DPTR
0051 E0                MOVX    A,@DPTR
0052 FB                MOV     R3,A
0053 D3                SETB    C
0054 120000      E     LCALL   ?C?SLCMP
0057 5003              JNC     $ + 5H
0059 020000      R     LJMP    ?C0158
                                           ; SOURCE LINE # 781
005C 7F01              MOV     R7,#01H
005E 120000      E     LCALL   _POWER_ON_LED_REG_Write
                                           ; SOURCE LINE # 784
0061 120000      R     LCALL   pwm_limit_search
                                           ; SOURCE LINE # 788
0064 300005            JNB     interrupt_flag,?C0159
                                           ; SOURCE LINE # 789
0067 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 790
0069 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 791
006C         ?C0159:
                                           ; SOURCE LINE # 794
006C 900000      E     MOV     DPTR,#ADC_buf+03H
006F E0                MOVX    A,@DPTR
0070 249A              ADD     A,#09AH
0072 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 73  

0073 900000      E     MOV     DPTR,#ADC_buf+02H
0076 E0                MOVX    A,@DPTR
0077 34F9              ADDC    A,#0F9H
0079 FE                MOV     R6,A
007A 33                RLC     A
007B 95E0              SUBB    A,ACC
007D FD                MOV     R5,A
007E FC                MOV     R4,A
007F E4                CLR     A
0080 7BAB              MOV     R3,#0ABH
0082 7A64              MOV     R2,#064H
0084 F9                MOV     R1,A
0085 F8                MOV     R0,A
0086 120000      E     LCALL   ?C?LMUL
0089 780D              MOV     R0,#0DH
008B 120000      E     LCALL   ?C?SLSHR
008E A804              MOV     R0,AR4
0090 A905              MOV     R1,AR5
0092 AA06              MOV     R2,AR6
0094 AB07              MOV     R3,AR7
0096 900000      E     MOV     DPTR,#pwm_sign
0099 E0                MOVX    A,@DPTR
009A FF                MOV     R7,A
009B 33                RLC     A
009C 95E0              SUBB    A,ACC
009E FE                MOV     R6,A
009F FD                MOV     R5,A
00A0 FC                MOV     R4,A
00A1 120000      E     LCALL   ?C?LMUL
00A4 120000      E     LCALL   _filter_i1
00A7 900000      E     MOV     DPTR,#g_meas+0CH
00AA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 798
00AD 300005            JNB     interrupt_flag,?C0160
                                           ; SOURCE LINE # 799
00B0 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 800
00B2 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 801
00B5         ?C0160:
                                           ; SOURCE LINE # 802
00B5 900000      E     MOV     DPTR,#ADC_buf+05H
00B8 E0                MOVX    A,@DPTR
00B9 249A              ADD     A,#09AH
00BB FF                MOV     R7,A
00BC 900000      E     MOV     DPTR,#ADC_buf+04H
00BF E0                MOVX    A,@DPTR
00C0 34F9              ADDC    A,#0F9H
00C2 FE                MOV     R6,A
00C3 33                RLC     A
00C4 95E0              SUBB    A,ACC
00C6 FD                MOV     R5,A
00C7 FC                MOV     R4,A
00C8 E4                CLR     A
00C9 7BAB              MOV     R3,#0ABH
00CB 7A64              MOV     R2,#064H
00CD F9                MOV     R1,A
00CE F8                MOV     R0,A
00CF 120000      E     LCALL   ?C?LMUL
00D2 780D              MOV     R0,#0DH
00D4 120000      E     LCALL   ?C?SLSHR
00D7 A804              MOV     R0,AR4
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 74  

00D9 A905              MOV     R1,AR5
00DB AA06              MOV     R2,AR6
00DD AB07              MOV     R3,AR7
00DF 900000      E     MOV     DPTR,#pwm_sign+01H
00E2 E0                MOVX    A,@DPTR
00E3 FF                MOV     R7,A
00E4 33                RLC     A
00E5 95E0              SUBB    A,ACC
00E7 FE                MOV     R6,A
00E8 FD                MOV     R5,A
00E9 FC                MOV     R4,A
00EA 120000      E     LCALL   ?C?LMUL
00ED 120000      E     LCALL   _filter_i2
00F0 900000      E     MOV     DPTR,#g_meas+010H
00F3 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 806
00F6 300005            JNB     interrupt_flag,?C0161
                                           ; SOURCE LINE # 807
00F9 C200        E     CLR     interrupt_flag
                                           ; SOURCE LINE # 808
00FB 120000      R     LCALL   interrupt_manager
                                           ; SOURCE LINE # 809
00FE         ?C0161:
                                           ; SOURCE LINE # 810
00FE D200        E     SETB    tension_valid
                                           ; SOURCE LINE # 811
0100 22                RET     
0101         ?C0158:
                                           ; SOURCE LINE # 812
                                           ; SOURCE LINE # 814
0101 E4                CLR     A
0102 FF                MOV     R7,A
0103 120000      E     LCALL   _POWER_ON_LED_REG_Write
                                           ; SOURCE LINE # 816
0106 E4                CLR     A
0107 FF                MOV     R7,A
0108 FE                MOV     R6,A
0109 FD                MOV     R5,A
010A FC                MOV     R4,A
010B 900000      E     MOV     DPTR,#g_meas+0CH
010E 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 817
0111 E4                CLR     A
0112 FF                MOV     R7,A
0113 FE                MOV     R6,A
0114 FD                MOV     R5,A
0115 FC                MOV     R4,A
0116 900000      E     MOV     DPTR,#g_meas+010H
0119 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 818
                                           ; SOURCE LINE # 819
011C         ?C0163:
011C 22                RET     
             ; FUNCTION analog_read_end (END)

             ; FUNCTION _encoder_reading (BEGIN)
                                           ; SOURCE LINE # 826
;---- Variable 'idx' assigned to Register 'R7' ----
                                           ; SOURCE LINE # 827
                                           ; SOURCE LINE # 828
0000 8F00        R     MOV     index,R7
                                           ; SOURCE LINE # 846
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 75  

0002 E500        R     MOV     A,index
0004 C3                CLR     C
0005 9403              SUBB    A,#03H
0007 4003              JC      $ + 5H
0009 020000      R     LJMP    ?C0165
000C         ?C0164:
                                           ; SOURCE LINE # 849
000C 300022            JNB     reset_last_value_flag,?C0166
                                           ; SOURCE LINE # 850
;---- Variable 'jj' assigned to Register 'R3' ----
000F 7B03              MOV     R3,#03H
0011         ?C0167:
0011 AF03              MOV     R7,AR3
0013 1B                DEC     R3
0014 EF                MOV     A,R7
0015 6018              JZ      ?C0168
                                           ; SOURCE LINE # 851
0017 E4                CLR     A
0018 FF                MOV     R7,A
0019 FE                MOV     R6,A
001A FD                MOV     R5,A
001B FC                MOV     R4,A
001C EB                MOV     A,R3
001D 25E0              ADD     A,ACC
001F 25E0              ADD     A,ACC
0021 2400        R     ADD     A,#LOW last_value_encoder
0023 F582              MOV     DPL,A
0025 E4                CLR     A
0026 3400        R     ADDC    A,#HIGH last_value_encoder
0028 F583              MOV     DPH,A
002A 120000      E     LCALL   ?C?LSTXDATA
002D 80E2              SJMP    ?C0167
002F         ?C0168:
                                           ; SOURCE LINE # 852
002F C200        E     CLR     reset_last_value_flag
                                           ; SOURCE LINE # 853
0031         ?C0166:
                                           ; SOURCE LINE # 858
0031 E500        R     MOV     A,index
0033 7018              JNZ     ?C0169
                                           ; SOURCE LINE # 859
0035 120000      E     LCALL   SHIFTREG_ENC_1_ReadData
0038 7801              MOV     R0,#01H
003A 120000      E     LCALL   ?C?ULSHR
003D EF                MOV     A,R7
003E EE                MOV     A,R6
003F ED                MOV     A,R5
0040 5403              ANL     A,#03H
0042 FD                MOV     R5,A
0043 E4                CLR     A
0044 FC                MOV     R4,A
0045 900000      R     MOV     DPTR,#data_encoder
0048 120000      E     LCALL   ?C?LSTXDATA
004B 8033              SJMP    ?C0170
004D         ?C0169:
                                           ; SOURCE LINE # 860
                                           ; SOURCE LINE # 861
004D E500        R     MOV     A,index
004F B40218            CJNE    A,#02H,?C0171
                                           ; SOURCE LINE # 862
0052 120000      E     LCALL   SHIFTREG_ENC_2_ReadData
0055 7801              MOV     R0,#01H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 76  

0057 120000      E     LCALL   ?C?ULSHR
005A EF                MOV     A,R7
005B EE                MOV     A,R6
005C ED                MOV     A,R5
005D 5403              ANL     A,#03H
005F FD                MOV     R5,A
0060 E4                CLR     A
0061 FC                MOV     R4,A
0062 900000      R     MOV     DPTR,#data_encoder
0065 120000      E     LCALL   ?C?LSTXDATA
0068 8016              SJMP    ?C0170
006A         ?C0171:
                                           ; SOURCE LINE # 864
006A 120000      E     LCALL   SHIFTREG_ENC_3_ReadData
006D 7801              MOV     R0,#01H
006F 120000      E     LCALL   ?C?ULSHR
0072 EF                MOV     A,R7
0073 EE                MOV     A,R6
0074 ED                MOV     A,R5
0075 5403              ANL     A,#03H
0077 FD                MOV     R5,A
0078 E4                CLR     A
0079 FC                MOV     R4,A
007A 900000      R     MOV     DPTR,#data_encoder
007D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 865
0080         ?C0170:
                                           ; SOURCE LINE # 869
0080 7B01              MOV     R3,#01H
0082 7A00        R     MOV     R2,#HIGH data_encoder
0084 7900        R     MOV     R1,#LOW data_encoder
0086 120000      E     LCALL   _check_enc_data
0089 4003              JC      $ + 5H
008B 020000      R     LJMP    ?C0165
                                           ; SOURCE LINE # 871
008E 900000      R     MOV     DPTR,#data_encoder
0091 E0                MOVX    A,@DPTR
0092 FC                MOV     R4,A
0093 A3                INC     DPTR
0094 E0                MOVX    A,@DPTR
0095 FD                MOV     R5,A
0096 A3                INC     DPTR
0097 E0                MOVX    A,@DPTR
0098 FE                MOV     R6,A
0099 A3                INC     DPTR
009A E0                MOVX    A,@DPTR
009B 54C0              ANL     A,#0C0H
009D FF                MOV     R7,A
009E EE                MOV     A,R6
009F ED                MOV     A,R5
00A0 5403              ANL     A,#03H
00A2 FD                MOV     R5,A
00A3 E4                CLR     A
00A4 2F                ADD     A,R7
00A5 FF                MOV     R7,A
00A6 E4                CLR     A
00A7 3E                ADDC    A,R6
00A8 FE                MOV     R6,A
00A9 ED                MOV     A,R5
00AA 34FE              ADDC    A,#0FEH
00AC FD                MOV     R5,A
00AD E4                CLR     A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 77  

00AE 34FF              ADDC    A,#0FFH
00B0 FC                MOV     R4,A
00B1 7802              MOV     R0,#02H
00B3 120000      E     LCALL   ?C?ULSHR
00B6 A3                INC     DPTR
00B7 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 874
00BA E500        R     MOV     A,index
00BC 6402              XRL     A,#02H
00BE 6037              JZ      ?C0174
                                           ; SOURCE LINE # 875
00C0 E500        R     MOV     A,index
00C2 25E0              ADD     A,ACC
00C4 25E0              ADD     A,ACC
00C6 2400        E     ADD     A,#LOW g_mem+03AH
00C8 F582              MOV     DPL,A
00CA E4                CLR     A
00CB 3400        E     ADDC    A,#HIGH g_mem+03AH
00CD F583              MOV     DPH,A
00CF E0                MOVX    A,@DPTR
00D0 A3                INC     DPTR
00D1 E0                MOVX    A,@DPTR
00D2 A3                INC     DPTR
00D3 E0                MOVX    A,@DPTR
00D4 FE                MOV     R6,A
00D5 A3                INC     DPTR
00D6 E0                MOVX    A,@DPTR
00D7 FB                MOV     R3,A
00D8 AA06              MOV     R2,AR6
00DA 900000      R     MOV     DPTR,#value_encoder
00DD E0                MOVX    A,@DPTR
00DE A3                INC     DPTR
00DF E0                MOVX    A,@DPTR
00E0 A3                INC     DPTR
00E1 E0                MOVX    A,@DPTR
00E2 FE                MOV     R6,A
00E3 A3                INC     DPTR
00E4 E0                MOVX    A,@DPTR
00E5 2B                ADD     A,R3
00E6 FF                MOV     R7,A
00E7 EE                MOV     A,R6
00E8 3A                ADDC    A,R2
00E9 FE                MOV     R6,A
00EA 33                RLC     A
00EB 95E0              SUBB    A,ACC
00ED FD                MOV     R5,A
00EE FC                MOV     R4,A
00EF 900000      R     MOV     DPTR,#value_encoder
00F2 120000      E     LCALL   ?C?LSTXDATA
00F5 8041              SJMP    ?C0175
00F7         ?C0174:
                                           ; SOURCE LINE # 877
00F7 E500        R     MOV     A,index
00F9 25E0              ADD     A,ACC
00FB 25E0              ADD     A,ACC
00FD 2400        E     ADD     A,#LOW g_mem+03AH
00FF F582              MOV     DPL,A
0101 E4                CLR     A
0102 3400        E     ADDC    A,#HIGH g_mem+03AH
0104 F583              MOV     DPH,A
0106 E0                MOVX    A,@DPTR
0107 FC                MOV     R4,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 78  

0108 A3                INC     DPTR
0109 E0                MOVX    A,@DPTR
010A FD                MOV     R5,A
010B A3                INC     DPTR
010C E0                MOVX    A,@DPTR
010D FE                MOV     R6,A
010E A3                INC     DPTR
010F E0                MOVX    A,@DPTR
0110 FF                MOV     R7,A
0111 900000      R     MOV     DPTR,#value_encoder
0114 E0                MOVX    A,@DPTR
0115 F8                MOV     R0,A
0116 A3                INC     DPTR
0117 E0                MOVX    A,@DPTR
0118 F9                MOV     R1,A
0119 A3                INC     DPTR
011A E0                MOVX    A,@DPTR
011B FA                MOV     R2,A
011C A3                INC     DPTR
011D E0                MOVX    A,@DPTR
011E 2F                ADD     A,R7
011F FF                MOV     R7,A
0120 EA                MOV     A,R2
0121 3E                ADDC    A,R6
0122 FE                MOV     R6,A
0123 E9                MOV     A,R1
0124 3D                ADDC    A,R5
0125 FD                MOV     R5,A
0126 E8                MOV     A,R0
0127 3C                ADDC    A,R4
0128 FC                MOV     R4,A
0129 120000      E     LCALL   ?C?LNEG
012C EE                MOV     A,R6
012D 33                RLC     A
012E 95E0              SUBB    A,ACC
0130 FD                MOV     R5,A
0131 FC                MOV     R4,A
0132 900000      R     MOV     DPTR,#value_encoder
0135 120000      E     LCALL   ?C?LSTXDATA
0138         ?C0175:
                                           ; SOURCE LINE # 880
0138 300027            JNB     only_first_time,?C0176
                                           ; SOURCE LINE # 881
013B 900000      R     MOV     DPTR,#value_encoder
013E E0                MOVX    A,@DPTR
013F FC                MOV     R4,A
0140 A3                INC     DPTR
0141 E0                MOVX    A,@DPTR
0142 FD                MOV     R5,A
0143 A3                INC     DPTR
0144 E0                MOVX    A,@DPTR
0145 FE                MOV     R6,A
0146 A3                INC     DPTR
0147 E0                MOVX    A,@DPTR
0148 FF                MOV     R7,A
0149 E500        R     MOV     A,index
014B 25E0              ADD     A,ACC
014D 25E0              ADD     A,ACC
014F 2400        R     ADD     A,#LOW last_value_encoder
0151 F582              MOV     DPL,A
0153 E4                CLR     A
0154 3400        R     ADDC    A,#HIGH last_value_encoder
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 79  

0156 F583              MOV     DPH,A
0158 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 883
015B E500        R     MOV     A,index
015D B40202            CJNE    A,#02H,?C0176
                                           ; SOURCE LINE # 884
0160 C200        R     CLR     only_first_time
                                           ; SOURCE LINE # 885
0162         ?C0176:
                                           ; SOURCE LINE # 888
0162 E500        R     MOV     A,index
0164 25E0              ADD     A,ACC
0166 25E0              ADD     A,ACC
0168 2400        R     ADD     A,#LOW last_value_encoder
016A F582              MOV     DPL,A
016C E4                CLR     A
016D 3400        R     ADDC    A,#HIGH last_value_encoder
016F F583              MOV     DPH,A
0171 E0                MOVX    A,@DPTR
0172 F8                MOV     R0,A
0173 A3                INC     DPTR
0174 E0                MOVX    A,@DPTR
0175 F9                MOV     R1,A
0176 A3                INC     DPTR
0177 E0                MOVX    A,@DPTR
0178 FA                MOV     R2,A
0179 A3                INC     DPTR
017A E0                MOVX    A,@DPTR
017B FB                MOV     R3,A
017C 900000      R     MOV     DPTR,#value_encoder
017F E0                MOVX    A,@DPTR
0180 FC                MOV     R4,A
0181 A3                INC     DPTR
0182 E0                MOVX    A,@DPTR
0183 FD                MOV     R5,A
0184 A3                INC     DPTR
0185 E0                MOVX    A,@DPTR
0186 FE                MOV     R6,A
0187 A3                INC     DPTR
0188 E0                MOVX    A,@DPTR
0189 C3                CLR     C
018A 9B                SUBB    A,R3
018B FF                MOV     R7,A
018C EE                MOV     A,R6
018D 9A                SUBB    A,R2
018E FE                MOV     R6,A
018F ED                MOV     A,R5
0190 99                SUBB    A,R1
0191 FD                MOV     R5,A
0192 EC                MOV     A,R4
0193 98                SUBB    A,R0
0194 FC                MOV     R4,A
0195 A3                INC     DPTR
0196 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 908
0199 E4                CLR     A
019A FF                MOV     R7,A
019B 7EC0              MOV     R6,#0C0H
019D FD                MOV     R5,A
019E FC                MOV     R4,A
019F 900000      R     MOV     DPTR,#aux
01A2 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 80  

01A3 F8                MOV     R0,A
01A4 A3                INC     DPTR
01A5 E0                MOVX    A,@DPTR
01A6 F9                MOV     R1,A
01A7 A3                INC     DPTR
01A8 E0                MOVX    A,@DPTR
01A9 FA                MOV     R2,A
01AA A3                INC     DPTR
01AB E0                MOVX    A,@DPTR
01AC FB                MOV     R3,A
01AD D3                SETB    C
01AE 120000      E     LCALL   ?C?SLCMP
01B1 4010              JC      ?C0178
                                           ; SOURCE LINE # 909
01B3 7400        E     MOV     A,#LOW g_meas+014H
01B5 2500        R     ADD     A,index
01B7 F582              MOV     DPL,A
01B9 E4                CLR     A
01BA 3400        E     ADDC    A,#HIGH g_meas+014H
01BC F583              MOV     DPH,A
01BE E0                MOVX    A,@DPTR
01BF 14                DEC     A
01C0 F0                MOVX    @DPTR,A
01C1 8068              SJMP    ?C0179
01C3         ?C0178:
                                           ; SOURCE LINE # 910
                                           ; SOURCE LINE # 911
01C3 7F00              MOV     R7,#00H
01C5 7E40              MOV     R6,#040H
01C7 7DFF              MOV     R5,#0FFH
01C9 7CFF              MOV     R4,#0FFH
01CB 900000      R     MOV     DPTR,#aux
01CE E0                MOVX    A,@DPTR
01CF F8                MOV     R0,A
01D0 A3                INC     DPTR
01D1 E0                MOVX    A,@DPTR
01D2 F9                MOV     R1,A
01D3 A3                INC     DPTR
01D4 E0                MOVX    A,@DPTR
01D5 FA                MOV     R2,A
01D6 A3                INC     DPTR
01D7 E0                MOVX    A,@DPTR
01D8 FB                MOV     R3,A
01D9 C3                CLR     C
01DA 120000      E     LCALL   ?C?SLCMP
01DD 5010              JNC     ?C0180
                                           ; SOURCE LINE # 912
01DF 7400        E     MOV     A,#LOW g_meas+014H
01E1 2500        R     ADD     A,index
01E3 F582              MOV     DPL,A
01E5 E4                CLR     A
01E6 3400        E     ADDC    A,#HIGH g_meas+014H
01E8 F583              MOV     DPH,A
01EA E0                MOVX    A,@DPTR
01EB 04                INC     A
01EC F0                MOVX    @DPTR,A
01ED 803C              SJMP    ?C0179
01EF         ?C0180:
                                           ; SOURCE LINE # 913
                                           ; SOURCE LINE # 914
01EF 900000      R     MOV     DPTR,#aux
01F2 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 81  

01F3 A3                INC     DPTR
01F4 E0                MOVX    A,@DPTR
01F5 A3                INC     DPTR
01F6 E0                MOVX    A,@DPTR
01F7 FE                MOV     R6,A
01F8 A3                INC     DPTR
01F9 E0                MOVX    A,@DPTR
01FA FF                MOV     R7,A
01FB 120000      E     LCALL   _abs
01FE D3                SETB    C
01FF EF                MOV     A,R7
0200 9400              SUBB    A,#00H
0202 EE                MOV     A,R6
0203 6480              XRL     A,#080H
0205 94C0              SUBB    A,#0C0H
0207 4022              JC      ?C0179
                                           ; SOURCE LINE # 915
0209 7400        R     MOV     A,#LOW error
020B 2500        R     ADD     A,index
020D F582              MOV     DPL,A
020F E4                CLR     A
0210 3400        R     ADDC    A,#HIGH error
0212 F583              MOV     DPH,A
0214 E0                MOVX    A,@DPTR
0215 04                INC     A
0216 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 916
0217 7400        R     MOV     A,#LOW error
0219 2500        R     ADD     A,index
021B F582              MOV     DPL,A
021D E4                CLR     A
021E 3400        R     ADDC    A,#HIGH error
0220 F583              MOV     DPH,A
0222 E0                MOVX    A,@DPTR
0223 C3                CLR     C
0224 940A              SUBB    A,#0AH
0226 5003              JNC     $ + 5H
0228 020000      R     LJMP    ?C0165
022B         ?C0183:
                                           ; SOURCE LINE # 919
                                           ; SOURCE LINE # 920
                                           ; SOURCE LINE # 921
022B         ?C0179:
                                           ; SOURCE LINE # 923
022B 7400        R     MOV     A,#LOW error
022D 2500        R     ADD     A,index
022F F582              MOV     DPL,A
0231 E4                CLR     A
0232 3400        R     ADDC    A,#HIGH error
0234 F583              MOV     DPH,A
0236 E4                CLR     A
0237 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 925
0238 900000      R     MOV     DPTR,#value_encoder
023B E0                MOVX    A,@DPTR
023C FC                MOV     R4,A
023D A3                INC     DPTR
023E E0                MOVX    A,@DPTR
023F FD                MOV     R5,A
0240 A3                INC     DPTR
0241 E0                MOVX    A,@DPTR
0242 FE                MOV     R6,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 82  

0243 A3                INC     DPTR
0244 E0                MOVX    A,@DPTR
0245 FF                MOV     R7,A
0246 E500        R     MOV     A,index
0248 25E0              ADD     A,ACC
024A 25E0              ADD     A,ACC
024C 2400        R     ADD     A,#LOW last_value_encoder
024E F582              MOV     DPL,A
0250 E4                CLR     A
0251 3400        R     ADDC    A,#HIGH last_value_encoder
0253 F583              MOV     DPH,A
0255 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 927
0258 900000      R     MOV     DPTR,#value_encoder
025B E0                MOVX    A,@DPTR
025C F8                MOV     R0,A
025D A3                INC     DPTR
025E E0                MOVX    A,@DPTR
025F F9                MOV     R1,A
0260 A3                INC     DPTR
0261 E0                MOVX    A,@DPTR
0262 FA                MOV     R2,A
0263 A3                INC     DPTR
0264 E0                MOVX    A,@DPTR
0265 FB                MOV     R3,A
0266 C000              PUSH    AR0
0268 7400        E     MOV     A,#LOW g_meas+014H
026A 2500        R     ADD     A,index
026C F582              MOV     DPL,A
026E E4                CLR     A
026F 3400        E     ADDC    A,#HIGH g_meas+014H
0271 F583              MOV     DPH,A
0273 E0                MOVX    A,@DPTR
0274 FF                MOV     R7,A
0275 33                RLC     A
0276 95E0              SUBB    A,ACC
0278 FE                MOV     R6,A
0279 FD                MOV     R5,A
027A FC                MOV     R4,A
027B 7810              MOV     R0,#010H
027D 120000      E     LCALL   ?C?LSHL
0280 D000              POP     AR0
0282 EB                MOV     A,R3
0283 2F                ADD     A,R7
0284 FF                MOV     R7,A
0285 EA                MOV     A,R2
0286 3E                ADDC    A,R6
0287 FE                MOV     R6,A
0288 E9                MOV     A,R1
0289 3D                ADDC    A,R5
028A FD                MOV     R5,A
028B E8                MOV     A,R0
028C 3C                ADDC    A,R4
028D FC                MOV     R4,A
028E 900000      R     MOV     DPTR,#value_encoder
0291 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 929
0294 E500        R     MOV     A,index
0296 25E0              ADD     A,ACC
0298 25E0              ADD     A,ACC
029A 2400        E     ADD     A,#LOW c_mem+046H
029C F582              MOV     DPL,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 83  

029E E4                CLR     A
029F 3400        E     ADDC    A,#HIGH c_mem+046H
02A1 F583              MOV     DPH,A
02A3 E0                MOVX    A,@DPTR
02A4 FC                MOV     R4,A
02A5 A3                INC     DPTR
02A6 E0                MOVX    A,@DPTR
02A7 FD                MOV     R5,A
02A8 A3                INC     DPTR
02A9 E0                MOVX    A,@DPTR
02AA FE                MOV     R6,A
02AB A3                INC     DPTR
02AC E0                MOVX    A,@DPTR
02AD FF                MOV     R7,A
02AE E4                CLR     A
02AF FB                MOV     R3,A
02B0 FA                MOV     R2,A
02B1 7980              MOV     R1,#080H
02B3 783F              MOV     R0,#03FH
02B5 120000      E     LCALL   ?C?FPCMP3
02B8 6038              JZ      ?C0184
                                           ; SOURCE LINE # 930
02BA 900000      R     MOV     DPTR,#value_encoder
02BD E0                MOVX    A,@DPTR
02BE FC                MOV     R4,A
02BF A3                INC     DPTR
02C0 E0                MOVX    A,@DPTR
02C1 FD                MOV     R5,A
02C2 A3                INC     DPTR
02C3 E0                MOVX    A,@DPTR
02C4 FE                MOV     R6,A
02C5 A3                INC     DPTR
02C6 E0                MOVX    A,@DPTR
02C7 FF                MOV     R7,A
02C8 EC                MOV     A,R4
02C9 120000      E     LCALL   ?C?FCASTL
02CC E500        R     MOV     A,index
02CE 25E0              ADD     A,ACC
02D0 25E0              ADD     A,ACC
02D2 2400        E     ADD     A,#LOW c_mem+046H
02D4 F582              MOV     DPL,A
02D6 E4                CLR     A
02D7 3400        E     ADDC    A,#HIGH c_mem+046H
02D9 F583              MOV     DPH,A
02DB E0                MOVX    A,@DPTR
02DC F8                MOV     R0,A
02DD A3                INC     DPTR
02DE E0                MOVX    A,@DPTR
02DF F9                MOV     R1,A
02E0 A3                INC     DPTR
02E1 E0                MOVX    A,@DPTR
02E2 FA                MOV     R2,A
02E3 A3                INC     DPTR
02E4 E0                MOVX    A,@DPTR
02E5 FB                MOV     R3,A
02E6 120000      E     LCALL   ?C?FPMUL
02E9 120000      E     LCALL   ?C?CASTF
02EC 900000      R     MOV     DPTR,#value_encoder
02EF 120000      E     LCALL   ?C?LSTXDATA
02F2         ?C0184:
                                           ; SOURCE LINE # 932
02F2 900000      R     MOV     DPTR,#value_encoder
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 84  

02F5 E0                MOVX    A,@DPTR
02F6 FC                MOV     R4,A
02F7 A3                INC     DPTR
02F8 E0                MOVX    A,@DPTR
02F9 FD                MOV     R5,A
02FA A3                INC     DPTR
02FB E0                MOVX    A,@DPTR
02FC FE                MOV     R6,A
02FD A3                INC     DPTR
02FE E0                MOVX    A,@DPTR
02FF FF                MOV     R7,A
0300 E500        R     MOV     A,index
0302 25E0              ADD     A,ACC
0304 25E0              ADD     A,ACC
0306 2400        E     ADD     A,#LOW g_meas
0308 F582              MOV     DPL,A
030A E4                CLR     A
030B 3400        E     ADDC    A,#HIGH g_meas
030D F583              MOV     DPH,A
030F 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 933
                                           ; SOURCE LINE # 954
0312         ?C0165:
0312 22                RET     
             ; FUNCTION _encoder_reading (END)

             ; FUNCTION calibration (BEGIN)
                                           ; SOURCE LINE # 961
                                           ; SOURCE LINE # 962
                                           ; SOURCE LINE # 969
0000 900000      E     MOV     DPTR,#calibration_flag
0003 E0                MOVX    A,@DPTR
0004 24FE              ADD     A,#0FEH
0006 7003              JNZ     $ + 5H
0008 020000      R     LJMP    ?C0190
000B 14                DEC     A
000C 7003              JNZ     $ + 5H
000E 020000      R     LJMP    ?C0195
0011 14                DEC     A
0012 6076              JZ      ?C0188
0014 14                DEC     A
0015 7003              JNZ     $ + 5H
0017 020000      R     LJMP    ?C0193
001A 2404              ADD     A,#04H
001C 6003              JZ      $ + 5H
001E 020000      R     LJMP    ?C0199
                                           ; SOURCE LINE # 970
0021         ?C0186:
                                           ; SOURCE LINE # 971
0021 120000      E     LCALL   ISR_RS485_RX_Disable
                                           ; SOURCE LINE # 974
0024 900000      E     MOV     DPTR,#c_mem+02H
0027 E0                MOVX    A,@DPTR
0028 FC                MOV     R4,A
0029 A3                INC     DPTR
002A E0                MOVX    A,@DPTR
002B FD                MOV     R5,A
002C A3                INC     DPTR
002D E0                MOVX    A,@DPTR
002E FE                MOV     R6,A
002F A3                INC     DPTR
0030 E0                MOVX    A,@DPTR
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 85  

0031 FF                MOV     R7,A
0032 900000      R     MOV     DPTR,#old_k_p
0035 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 975
0038 900000      E     MOV     DPTR,#c_mem+06H
003B E0                MOVX    A,@DPTR
003C FC                MOV     R4,A
003D A3                INC     DPTR
003E E0                MOVX    A,@DPTR
003F FD                MOV     R5,A
0040 A3                INC     DPTR
0041 E0                MOVX    A,@DPTR
0042 FE                MOV     R6,A
0043 A3                INC     DPTR
0044 E0                MOVX    A,@DPTR
0045 FF                MOV     R7,A
0046 900000      R     MOV     DPTR,#old_k_i
0049 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 976
004C 900000      E     MOV     DPTR,#c_mem+0AH
004F E0                MOVX    A,@DPTR
0050 FC                MOV     R4,A
0051 A3                INC     DPTR
0052 E0                MOVX    A,@DPTR
0053 FD                MOV     R5,A
0054 A3                INC     DPTR
0055 E0                MOVX    A,@DPTR
0056 FE                MOV     R6,A
0057 A3                INC     DPTR
0058 E0                MOVX    A,@DPTR
0059 FF                MOV     R7,A
005A 900000      R     MOV     DPTR,#old_k_d
005D 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 979
0060 E4                CLR     A
0061 FF                MOV     R7,A
0062 FE                MOV     R6,A
0063 FD                MOV     R5,A
0064 FC                MOV     R4,A
0065 900000      E     MOV     DPTR,#g_refNew
0068 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 980
006B E4                CLR     A
006C FF                MOV     R7,A
006D FE                MOV     R6,A
006E FD                MOV     R5,A
006F FC                MOV     R4,A
0070 900000      E     MOV     DPTR,#g_refNew+04H
0073 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 983
0076 900000      E     MOV     DPTR,#g_refNew+018H
0079 E0                MOVX    A,@DPTR
007A 5403              ANL     A,#03H
007C 7005              JNZ     ?C0187
                                           ; SOURCE LINE # 984
007E 7F03              MOV     R7,#03H
0080 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 985
0083         ?C0187:
                                           ; SOURCE LINE # 988
0083 900000      E     MOV     DPTR,#calibration_flag
0086 7404              MOV     A,#04H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 86  

0088 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 989
0089 22                RET     
                                           ; SOURCE LINE # 991
008A         ?C0188:
                                           ; SOURCE LINE # 992
008A 900000      R     MOV     DPTR,#pause_counter
008D E0                MOVX    A,@DPTR
008E 04                INC     A
008F F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 994
0090 E0                MOVX    A,@DPTR
0091 640A              XRL     A,#0AH
0093 6003              JZ      $ + 5H
0095 020000      R     LJMP    ?C0199
                                           ; SOURCE LINE # 995
0098 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 998
0099 7F99              MOV     R7,#099H
009B 7E19              MOV     R6,#019H
009D FD                MOV     R5,A
009E FC                MOV     R4,A
009F 900000      E     MOV     DPTR,#c_mem+02H
00A2 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 999
00A5 E4                CLR     A
00A6 FF                MOV     R7,A
00A7 FE                MOV     R6,A
00A8 FD                MOV     R5,A
00A9 FC                MOV     R4,A
00AA 900000      E     MOV     DPTR,#c_mem+06H
00AD 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1000
00B0 E4                CLR     A
00B1 7FCC              MOV     R7,#0CCH
00B3 7E4C              MOV     R6,#04CH
00B5 FD                MOV     R5,A
00B6 FC                MOV     R4,A
00B7 900000      E     MOV     DPTR,#c_mem+0AH
00BA 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1002
00BD 900000      E     MOV     DPTR,#calibration_flag
00C0 7402              MOV     A,#02H
00C2 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1003
                                           ; SOURCE LINE # 1004
00C3 22                RET     
                                           ; SOURCE LINE # 1006
00C4         ?C0190:
                                           ; SOURCE LINE # 1008
00C4 900000      E     MOV     DPTR,#g_refNew
00C7 E0                MOVX    A,@DPTR
00C8 FC                MOV     R4,A
00C9 A3                INC     DPTR
00CA E0                MOVX    A,@DPTR
00CB FD                MOV     R5,A
00CC A3                INC     DPTR
00CD E0                MOVX    A,@DPTR
00CE FE                MOV     R6,A
00CF A3                INC     DPTR
00D0 E0                MOVX    A,@DPTR
00D1 245B              ADD     A,#05BH
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 87  

00D3 FF                MOV     R7,A
00D4 E4                CLR     A
00D5 3E                ADDC    A,R6
00D6 FE                MOV     R6,A
00D7 E4                CLR     A
00D8 3D                ADDC    A,R5
00D9 FD                MOV     R5,A
00DA E4                CLR     A
00DB 3C                ADDC    A,R4
00DC FC                MOV     R4,A
00DD 900000      E     MOV     DPTR,#g_refNew
00E0 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1009
00E3 900000      E     MOV     DPTR,#g_refNew+04H
00E6 E0                MOVX    A,@DPTR
00E7 FC                MOV     R4,A
00E8 A3                INC     DPTR
00E9 E0                MOVX    A,@DPTR
00EA FD                MOV     R5,A
00EB A3                INC     DPTR
00EC E0                MOVX    A,@DPTR
00ED FE                MOV     R6,A
00EE A3                INC     DPTR
00EF E0                MOVX    A,@DPTR
00F0 C3                CLR     C
00F1 945B              SUBB    A,#05BH
00F3 FF                MOV     R7,A
00F4 EE                MOV     A,R6
00F5 9400              SUBB    A,#00H
00F7 FE                MOV     R6,A
00F8 ED                MOV     A,R5
00F9 9400              SUBB    A,#00H
00FB FD                MOV     R5,A
00FC EC                MOV     A,R4
00FD 9400              SUBB    A,#00H
00FF FC                MOV     R4,A
0100 900000      E     MOV     DPTR,#g_refNew+04H
0103 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1012
0106 E4                CLR     A
0107 7FE8              MOV     R7,#0E8H
0109 7E03              MOV     R6,#03H
010B FD                MOV     R5,A
010C FC                MOV     R4,A
010D 900000      E     MOV     DPTR,#g_meas+0CH
0110 E0                MOVX    A,@DPTR
0111 F8                MOV     R0,A
0112 A3                INC     DPTR
0113 E0                MOVX    A,@DPTR
0114 F9                MOV     R1,A
0115 A3                INC     DPTR
0116 E0                MOVX    A,@DPTR
0117 FA                MOV     R2,A
0118 A3                INC     DPTR
0119 E0                MOVX    A,@DPTR
011A FB                MOV     R3,A
011B D3                SETB    C
011C 120000      E     LCALL   ?C?SLCMP
011F 501D              JNC     ?C0192
0121 E4                CLR     A
0122 7FE8              MOV     R7,#0E8H
0124 7E03              MOV     R6,#03H
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 88  

0126 FD                MOV     R5,A
0127 FC                MOV     R4,A
0128 900000      E     MOV     DPTR,#g_meas+010H
012B E0                MOVX    A,@DPTR
012C F8                MOV     R0,A
012D A3                INC     DPTR
012E E0                MOVX    A,@DPTR
012F F9                MOV     R1,A
0130 A3                INC     DPTR
0131 E0                MOVX    A,@DPTR
0132 FA                MOV     R2,A
0133 A3                INC     DPTR
0134 E0                MOVX    A,@DPTR
0135 FB                MOV     R3,A
0136 120000      E     LCALL   ?C?SLCMP
0139 5003              JNC     $ + 5H
013B 020000      R     LJMP    ?C0199
013E         ?C0192:
                                           ; SOURCE LINE # 1014
013E 900000      E     MOV     DPTR,#g_ref
0141 E0                MOVX    A,@DPTR
0142 A3                INC     DPTR
0143 E0                MOVX    A,@DPTR
0144 A3                INC     DPTR
0145 E0                MOVX    A,@DPTR
0146 FF                MOV     R7,A
0147 A3                INC     DPTR
0148 E0                MOVX    A,@DPTR
0149 900000      E     MOV     DPTR,#g_mem+063H
014C CF                XCH     A,R7
014D F0                MOVX    @DPTR,A
014E A3                INC     DPTR
014F EF                MOV     A,R7
0150 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1017
0151 900000      R     MOV     DPTR,#old_k_p
0154 E0                MOVX    A,@DPTR
0155 FC                MOV     R4,A
0156 A3                INC     DPTR
0157 E0                MOVX    A,@DPTR
0158 FD                MOV     R5,A
0159 A3                INC     DPTR
015A E0                MOVX    A,@DPTR
015B FE                MOV     R6,A
015C A3                INC     DPTR
015D E0                MOVX    A,@DPTR
015E FF                MOV     R7,A
015F 900000      E     MOV     DPTR,#c_mem+02H
0162 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1018
0165 900000      R     MOV     DPTR,#old_k_i
0168 E0                MOVX    A,@DPTR
0169 FC                MOV     R4,A
016A A3                INC     DPTR
016B E0                MOVX    A,@DPTR
016C FD                MOV     R5,A
016D A3                INC     DPTR
016E E0                MOVX    A,@DPTR
016F FE                MOV     R6,A
0170 A3                INC     DPTR
0171 E0                MOVX    A,@DPTR
0172 FF                MOV     R7,A
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 89  

0173 900000      E     MOV     DPTR,#c_mem+06H
0176 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1019
0179 900000      R     MOV     DPTR,#old_k_d
017C E0                MOVX    A,@DPTR
017D FC                MOV     R4,A
017E A3                INC     DPTR
017F E0                MOVX    A,@DPTR
0180 FD                MOV     R5,A
0181 A3                INC     DPTR
0182 E0                MOVX    A,@DPTR
0183 FE                MOV     R6,A
0184 A3                INC     DPTR
0185 E0                MOVX    A,@DPTR
0186 FF                MOV     R7,A
0187 900000      E     MOV     DPTR,#c_mem+0AH
018A 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1022
018D E4                CLR     A
018E FF                MOV     R7,A
018F FE                MOV     R6,A
0190 FD                MOV     R5,A
0191 FC                MOV     R4,A
0192 900000      E     MOV     DPTR,#g_refNew
0195 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1023
0198 E4                CLR     A
0199 FF                MOV     R7,A
019A FE                MOV     R6,A
019B FD                MOV     R5,A
019C FC                MOV     R4,A
019D 900000      E     MOV     DPTR,#g_refNew+04H
01A0 120000      E     LCALL   ?C?LSTXDATA
                                           ; SOURCE LINE # 1026
01A3 900000      E     MOV     DPTR,#calibration_flag
01A6 7405              MOV     A,#05H
01A8 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1027
                                           ; SOURCE LINE # 1028
01A9 22                RET     
                                           ; SOURCE LINE # 1030
01AA         ?C0193:
                                           ; SOURCE LINE # 1031
01AA 900000      R     MOV     DPTR,#pause_counter
01AD E0                MOVX    A,@DPTR
01AE 04                INC     A
01AF F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1033
01B0 E0                MOVX    A,@DPTR
01B1 640A              XRL     A,#0AH
01B3 7029              JNZ     ?C0199
                                           ; SOURCE LINE # 1034
01B5 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1036
01B6 900000      E     MOV     DPTR,#calibration_flag
01B9 7403              MOV     A,#03H
01BB F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1037
                                           ; SOURCE LINE # 1038
01BC 22                RET     
                                           ; SOURCE LINE # 1040
01BD         ?C0195:
C51 COMPILER V9.51   INTERRUPTIONS                                                         02/14/2017 15:09:52 PAGE 90  

                                           ; SOURCE LINE # 1042
01BD 900000      E     MOV     DPTR,#g_refNew+018H
01C0 E0                MOVX    A,@DPTR
01C1 5403              ANL     A,#03H
01C3 7004              JNZ     ?C0196
                                           ; SOURCE LINE # 1043
01C5 FF                MOV     R7,A
01C6 120000      E     LCALL   _MOTOR_ON_OFF_Write
                                           ; SOURCE LINE # 1044
01C9         ?C0196:
                                           ; SOURCE LINE # 1047
01C9 7F08              MOV     R7,#08H
01CB 7E00              MOV     R6,#00H
01CD 120000      E     LCALL   _memStore
                                           ; SOURCE LINE # 1048
01D0 E4                CLR     A
01D1 FF                MOV     R7,A
01D2 FE                MOV     R6,A
01D3 120000      E     LCALL   _memStore
                                           ; SOURCE LINE # 1050
01D6 E4                CLR     A
01D7 900000      E     MOV     DPTR,#calibration_flag
01DA F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1052
01DB 120000      E     LCALL   ISR_RS485_RX_Enable
                                           ; SOURCE LINE # 1053
                                           ; SOURCE LINE # 1055
                                           ; SOURCE LINE # 1056
                                           ; SOURCE LINE # 1057
                                           ; SOURCE LINE # 1058
                                           ; SOURCE LINE # 1059
01DE         ?C0199:
01DE 22                RET     
             ; FUNCTION calibration (END)

             ; FUNCTION pwm_limit_search (BEGIN)
                                           ; SOURCE LINE # 1067
                                           ; SOURCE LINE # 1068
0000 900000      E     MOV     DPTR,#dev_pwm_limit
0003 7464              MOV     A,#064H
0005 F0                MOVX    @DPTR,A
                                           ; SOURCE LINE # 1069
0006 22                RET     
             ; FUNCTION pwm_limit_search (END)



MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   6081    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =    182      12
   PDATA SIZE       =   ----    ----
   DATA SIZE        =      6      76
   IDATA SIZE       =   ----    ----
   BIT SIZE         =      3       1
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
